<!doctype html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:100,300,400,500,700,900"/><script src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"></script><meta name="robots" content="noindex"/><title>Panda Video - Hospedagem de video</title></head><body id="body"><script>/*! For license information please see main.1420.bundle.js.LICENSE.txt */
(()=>{var e={518:(e,t,n)=>{"use strict";function i(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}function r(){return"npm"}n.d(t,{S:()=>r,n:()=>i})},422:(e,t,n)=>{"use strict";n.d(t,{KV:()=>r,l$:()=>s});var i=n(518);function r(){return!(0,i.n)()&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function s(e,t){return e.require(t)}e=n.hmd(e)},170:(e,t,n)=>{"use strict";n.d(t,{Z1:()=>h,ph:()=>d,yW:()=>c});var i=n(422),r=n(235);e=n.hmd(e);const s=(0,r.Rf)(),a={nowSeconds:()=>Date.now()/1e3},o=(0,i.KV)()?function(){try{return(0,i.l$)(e,"perf_hooks").performance}catch(e){return}}():function(){const{performance:e}=s;if(e&&e.now)return{now:()=>e.now(),timeOrigin:Date.now()-e.now()}}(),l=void 0===o?a:{nowSeconds:()=>(o.timeOrigin+o.now())/1e3},c=a.nowSeconds.bind(a),d=l.nowSeconds.bind(l);let u;const h=(()=>{const{performance:e}=s;if(!e||!e.now)return void(u="none");const t=36e5,n=e.now(),i=Date.now(),r=e.timeOrigin?Math.abs(e.timeOrigin+n-i):t,a=r<t,o=e.timing&&e.timing.navigationStart,l="number"==typeof o?Math.abs(o+n-i):t;return a||l<t?r<=l?(u="timeOrigin",e.timeOrigin):(u="navigationStart",o):(u="dateNow",i)})()},235:(e,t,n)=>{"use strict";function i(e){return e&&e.Math==Math?e:void 0}n.d(t,{Rf:()=>s,YO:()=>a,n2:()=>r});const r="object"==typeof globalThis&&i(globalThis)||"object"==typeof window&&i(window)||"object"==typeof self&&i(self)||"object"==typeof n.g&&i(n.g)||function(){return this}()||{};function s(){return r}function a(e,t,n){const i=n||r,s=i.__SENTRY__=i.__SENTRY__||{};return s[e]||(s[e]=t())}},251:()=>{function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}!function(n){function i(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"!=(n=t(e=r))&&"string"!==n||isNaN(e-parseFloat(e)))return i(null,s,a);var o,l=function(e){return"0".concat(e).slice(-2)},c=(o=r,Math.trunc(o/60/60%60,10)),d=function(e){return Math.trunc(e/60%60,10)}(r),u=function(e){return Math.trunc(e%60,10)}(r);return c=s||c>0?"".concat(c,":"):"","".concat(a&&r>0?"-":"").concat(c).concat(l(d),":").concat(l(u))}var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.player=e,this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}var r,s;return r=t,s=[{key:"enabled",get:function(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.thumbnail.enabled}},{key:"config",get:function(){return this.player.config.thumbnail}},{key:"load",value:function(){this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.loaded=!0,this.listeners())}},{key:"startMove",value:function(e){if(this.loaded&&!(!e instanceof Event)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t=this.player.elements.progress.getBoundingClientRect(),n=100/t.width*(e.pageX-t.left);this.seekTime=this.player.media.duration*(n/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=i(this.seekTime)}this.showImageAtCurrentTime()}}},{key:"endMove",value:function(){this.toggleThumbContainer(!1,!0)}},{key:"startScrubbing",value:function(e){!1!==e.button&&0!==e.button||(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))}},{key:"endScrubbing",value:function(){var e=this;this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):this.player.media.addEventListener("timeupdate",(function(){e.mouseDown||e.toggleScrubbingContainer(!1)}),{once:!0})}},{key:"listeners",value:function(){var e=this,t=this.player;t.on("play",(function(){e.toggleThumbContainer(!1,!0)})),t.on("seeked",(function(){e.toggleThumbContainer(!1)})),t.on("timeupdate",(function(){e.lastTime=e.player.media.currentTime}));var n=this.player.elements;["mousemove","touchmove","mouseleave","click","mousedown","touchstart","mouseup","touchend"].forEach((function(e){null!=n.progress.addEventListener&&n.progress.addEventListener(e,(function(n){var i=t.thumbnails;if(i&&i.loaded)switch(e){case"mousemove":case"touchmove":case"mousedown":case"touchstart":i.startMove(n);break;case"mouseleave":case"click":i.endMove(!1,!0);break;case"mouseup":case"touchend":i.endScrubbing(n)}}))}))}},{key:"render",value:function(){this.elements.thumb.container=n.createElement("div"),this.elements.thumb.container.classList.add(this.player.config.classNames.previewThumbnails.thumbContainer),this.elements.thumb.imageContainer=n.createElement("div"),this.elements.thumb.imageContainer.className=this.player.config.classNames.previewThumbnails.imageContainer,this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);var e=n.createElement("div");e.className=this.player.config.classNames.previewThumbnails.timeContainer,this.elements.thumb.time=n.createElement("span"),this.elements.thumb.time.textContent="00:00",e.appendChild(this.elements.thumb.time),this.elements.thumb.container.appendChild(e),this.player.elements.progress instanceof Element&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=n.createElement("div"),this.elements.scrubbing.container.className=this.player.config.classNames.previewThumbnails.scrubbingContainer,this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)}},{key:"showImageAtCurrentTime",value:function(){this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();var e=this.config,t=this.player.duration/e.pic_num,n=Math.floor(this.seekTime/t),i=Math.ceil((n+1)/(e.col*e.row))-1,r=n>=0;this.mouseDown||this.toggleThumbContainer(r),r&&n!==this.showingThumb&&(this.showingThumb=n,this.loadImage(i))}},{key:"loadImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.showingThumb,i=this.config.urls[t];if(this.currentImageElement&&this.currentImageElement.src===i)this.showImage(this.currentImageElement,t,n,i,!1),this.currentImageElement.dataset.index=n,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&(this.loadingImage.onload=null);var r=new Image;r.src=i,r.dataset.index=n,this.player.debug.log("Loading image: ".concat(i)),r.onload=function(){return e.showImage(r,t,n,i,!0)},this.loadingImage=r,this.removeOldImages(r)}}},{key:"showImage",value:function(e,t,n,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.player.debug.log("Showing thumb: ".concat(i,". num: ").concat(n,". qual: ").concat(t,". newimg: ").concat(r)),this.setImageSizeAndOffset(e,n),r&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(i)||this.loadedImages.push(i))}},{key:"removeOldImages",value:function(e){var t=this;Array.from(this.currentImageContainer.children).forEach((function(n){if("img"===n.tagName.toLowerCase()&&n.dataset.index!==e.dataset.index&&!n.dataset.deleting){n.dataset.deleting=!0;var i=t.currentImageContainer;setTimeout((function(){i.removeChild(n),t.player.debug.log("Removing thumb: ".concat(n.dataset.filename))}),500)}}))}},{key:"currentImageContainer",get:function(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}},{key:"thumbAspectRatio",get:function(){return this.config.width/this.config.height}},{key:"thumbContainerHeight",get:function(){return this.mouseDown?Math.floor(this.player.media.clientWidth/this.thumbAspectRatio):Math.min(135,Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4))}},{key:"currentImageElement",get:function(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement},set:function(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}},{key:"toggleThumbContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(n,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)}},{key:"toggleScrubbingContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)}},{key:"determineContainerAutoSizing",value:function(){this.elements.thumb.imageContainer.clientHeight>20&&(this.sizeSpecifiedInCSS=!0)}},{key:"setThumbContainerSizeAndPos",value:function(){if(!this.sizeSpecifiedInCSS){var e=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);this.elements.thumb.imageContainer.style.height="".concat(this.thumbContainerHeight,"px"),this.elements.thumb.imageContainer.style.width="".concat(e,"px")}this.setThumbContainerPos()}},{key:"setThumbContainerPos",value:function(){var e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),n=this.elements.thumb.container,i=t.left-e.left+10,r=t.right-e.left-n.clientWidth-10,s=this.mousePosX-e.left-n.clientWidth/2;s<i&&(s=i),s>r&&(s=r),n.style.left="".concat(s,"px")}},{key:"setScrubbingContainerSize",value:function(){this.elements.scrubbing.container.style.width="".concat(this.player.media.clientWidth,"px"),this.elements.scrubbing.container.style.height=this.player.media.clientWidth/this.thumbAspectRatio+"px"}},{key:"setImageSizeAndOffset",value:function(e,t){var n=this.config,i=t+1-n.col*n.row*(Math.ceil((t+1)/(n.col*n.row))-1),r=Math.ceil(i/n.row)-1,s=i-r*n.row-1,a=this.thumbContainerHeight/n.height;e.style.height="".concat(Math.floor(e.naturalHeight*a),"px"),e.style.width="".concat(Math.floor(e.naturalWidth*a),"px"),e.style.left="-".concat(s*n.width*a,"px"),e.style.top="-".concat(r*n.height*a,"px")}}],s&&e(r.prototype,s),Object.defineProperty(r,"prototype",{writable:!1}),t}();n.addEventListener("ready",(function(e){var t=e.detail.plyr;t.thumbnails=new r(t)}))}(document)},615:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(81),r=n.n(i),s=n(645),a=n.n(s)()(r());a.push([e.id,'.plyr__progress input {\n  border-radius: 0px !important;\n  -webkit-appearance: none;\n  background: transparent;\n}\n.plyr__progress input[value]::-webkit-progress-bar {\n  border-radius: 0px !important;\n}\n.plyr__progress input[value]::-webkit-progress-value {\n  border-radius: 0px !important;\n}\n.plyr__progress__container {\n  position: absolute;\n  top: 14px;\n  left: 10px;\n  width: calc(100% - 24px);\n}\n@media (max-width: 480px) {\n  .plyr__progress__container {\n    top: -5px;\n  }\n}\n.plyr__pb {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  z-index: 3;\n  margin-left: calc(var(--plyr-range-thumb-height, 13px) * -0.5);\n  margin-right: -6.5px;\n  margin-right: calc(var(--plyr-range-thumb-height, 13px) * -0.5);\n  width: calc(100% + 13px);\n  width: calc(100% + var(--plyr-range-thumb-height, 13px));\n}\n.plyr__preview-thumb {\n  bottom: 22px;\n  transition: bottom ease 0.1s;\n}\n.plyr__controls {\n  padding-top: 70px;\n}\n\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-webkit-slider-runnable-track {\n  background-color: transparent !important;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-moz-range-track {\n  background-color: transparent !important;\n}\n.plyr--full-ui.plyr--video .plyr__progress input[type="range"]::-ms-track {\n  background-color: transparent !important;\n}\n\n.plyr__progress input {\n  background-color: transparent !important;\n  color: transparent !important;\n  top: -6px !important;\n  z-index: 7 !important;\n  cursor: pointer;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-webkit-slider-thumb {\n  opacity: 0;\n  transition: opacity ease 0.1s;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]::-moz-range-thumb {\n  opacity: 0;\n  transition: opacity ease 0.1s;\n}\n.plyr--full-ui.plyr--video .plyr__progress input[type="range"]::-ms-thumb {\n  opacity: 0;\n  transition: opacity ease 0.1s;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]:active::-webkit-slider-thumb {\n  opacity: 1;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]:active::-moz-range-thumb {\n  opacity: 1;\n}\n.plyr--full-ui.plyr--video\n  .plyr__progress\n  input[type="range"]:active::-ms-thumb {\n  opacity: 1;\n}\n\n.sp__base {\n  width: 100%;\n  padding: 0;\n  margin: 0;\n  font-size: 0;\n  text-align: left;\n  box-sizing: border-box;\n  position: relative;\n  user-select: none; /* supported by Chrome and Opera */\n  -webkit-user-select: none; /* Safari */\n  -khtml-user-select: none; /* Konqueror HTML */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* Internet Explorer/Edge */\n}\n\n.pb__shadow {\n  width: 100%;\n  height: 50px;\n  position: absolute;\n  top: -44px;\n  left: 0px;\n  background: linear-gradient(transparent, rgba(0, 0, 0, 0.4));\n  background: var(\n    --plyr-video-controls-background,\n    linear-gradient(transparent, rgba(0, 0, 0, 0.4))\n  );\n}\n\n.sp__progressbar {\n  width: 100%;\n  height: 9px;\n  box-sizing: border-box;\n  font-size: 0;\n  margin: 0;\n  padding: 0;\n  position: relative;\n  transition: all ease 0.12s;\n  text-align: left;\n  overflow-x: hidden;\n  white-space: nowrap;\n}\n.sp__progressbar li {\n  display: inline-block;\n  list-style: none;\n  height: 9px;\n  margin: 0;\n  padding: 3px 0;\n  position: relative;\n  top: 0;\n  transition: all ease 0.12s;\n  box-sizing: border-box;\n  position: relative;\n  background-color: transparent;\n  cursor: pointer;\n  overflow-x: hidden;\n}\n\n.sp__progressbar.hover {\n  transform: scaleY(1.8);\n  margin-top: 0px;\n}\n.sp__progressbar li.active {\n  padding: 2px 0;\n}\n\n.sp__progressbar li .sp__container {\n  width: calc(100% - 2px);\n  left: 1px;\n  height: 100%;\n  position: relative;\n  box-shadow: #00000050 0 0 1px;\n  overflow-x: hidden;\n}\n\n.sp__progressbar li .sp__bg {\n  background-color: rgba(255, 255, 255, 0.2);\n  height: 100%;\n  width: 100%;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 0;\n}\n\n.sp__progressbar li .sp__section {\n  height: 100%;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 1;\n}\n\n.sp__progressbar:hover li {\n  opacity: 0.75;\n}\n.sp__progressbar:hover li:hover {\n  opacity: 1;\n}\n\n.sp__title {\n  position: absolute;\n  bottom: 18px;\n  left: 0px;\n  color: white;\n  font-size: 14px !important;\n  font-weight: 700;\n  text-align: center;\n  text-shadow: 0 0 4px black;\n  opacity: 0;\n  transition: opacity ease 0.12s;\n  line-height: 17px;\n}\n.sp__title.animated {\n  transition: left ease 0.08s;\n}\n.sp__title.active {\n  opacity: 1;\n}\n\n.sp__moment {\n  border: 2px solid #ffffff77;\n  border-radius: 50%;\n  width: 12px;\n  height: 12px;\n  z-index: 5;\n  display: block;\n  position: absolute;\n  top: -1.5px;\n  left: 0px;\n  box-sizing: border-box;\n  background-color: #ffffff77;\n  box-shadow: 0 0 3px #00000055;\n  pointer-events: all;\n}\n.sp__moment.hover {\n  cursor: pointer;\n  border: 2px solid #fff;\n  background-color: #ffffff99;\n}\n',""]);const o=a},376:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(81),r=n.n(i),s=n(645),a=n.n(s)()(r());a.push([e.id,"@keyframes plyr-progress{to{background-position:25px 0;background-position:var(--plyr-progress-loading-size,25px) 0}}@keyframes plyr-popup{0%{opacity:.5;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes plyr-fade-in{from{opacity:0}to{opacity:1}}.plyr{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;align-items:center;direction:ltr;display:flex;flex-direction:column;font-family:inherit;font-family:var(--plyr-font-family,inherit);font-variant-numeric:tabular-nums;font-weight:400;font-weight:var(--plyr-font-weight-regular,400);line-height:1.7;line-height:var(--plyr-line-height,1.7);max-width:100%;min-width:200px;position:relative;text-shadow:none;transition:box-shadow .3s ease;z-index:0}.plyr audio,.plyr iframe,.plyr video{display:block;height:100%;width:100%}.plyr button{font:inherit;line-height:inherit;width:auto}.plyr:focus{outline:0}.plyr--full-ui{box-sizing:border-box}.plyr--full-ui *,.plyr--full-ui ::after,.plyr--full-ui ::before{box-sizing:inherit}.plyr--full-ui a,.plyr--full-ui button,.plyr--full-ui input,.plyr--full-ui label{touch-action:manipulation}.plyr__badge{background:#4a5464;background:var(--plyr-badge-background,#4a5464);border-radius:2px;border-radius:var(--plyr-badge-border-radius,2px);color:#fff;color:var(--plyr-badge-text-color,#fff);font-size:9px;font-size:var(--plyr-font-size-badge,9px);line-height:1;padding:3px 4px}.plyr--full-ui ::-webkit-media-text-track-container{display:none}.plyr__captions{animation:plyr-fade-in .3s ease;bottom:0;display:none;font-size:13px;font-size:var(--plyr-font-size-small,13px);left:0;padding:10px;padding:var(--plyr-control-spacing,10px);position:absolute;text-align:center;transition:transform .4s ease-in-out;width:100%}.plyr__captions span:empty{display:none}@media (min-width:480px){.plyr__captions{font-size:15px;font-size:var(--plyr-font-size-base,15px);padding:calc(10px * 2);padding:calc(var(--plyr-control-spacing,10px) * 2)}}@media (min-width:768px){.plyr__captions{font-size:18px;font-size:var(--plyr-font-size-large,18px)}}.plyr--captions-active .plyr__captions{display:block}.plyr:not(.plyr--hide-controls) .plyr__controls:not(:empty)~.plyr__captions{transform:translateY(calc(10px * -4));transform:translateY(calc(var(--plyr-control-spacing,10px) * -4))}.plyr__caption{background:rgba(0,0,0,.8);background:var(--plyr-captions-background,rgba(0,0,0,.8));border-radius:2px;-webkit-box-decoration-break:clone;box-decoration-break:clone;color:#fff;color:var(--plyr-captions-text-color,#fff);line-height:185%;padding:.2em .5em;white-space:pre-wrap}.plyr__caption div{display:inline}.plyr__control{background:0 0;border:0;border-radius:3px;border-radius:var(--plyr-control-radius,3px);color:inherit;cursor:pointer;flex-shrink:0;overflow:visible;padding:calc(10px * .7);padding:calc(var(--plyr-control-spacing,10px) * .7);position:relative;transition:all .3s ease}.plyr__control svg{display:block;fill:currentColor;height:18px;height:var(--plyr-control-icon-size,18px);pointer-events:none;width:18px;width:var(--plyr-control-icon-size,18px)}.plyr__control:focus{outline:0}.plyr__control.plyr__tab-focus{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}a.plyr__control{text-decoration:none}a.plyr__control::after,a.plyr__control::before{display:none}.plyr__control.plyr__control--pressed .icon--not-pressed,.plyr__control.plyr__control--pressed .label--not-pressed,.plyr__control:not(.plyr__control--pressed) .icon--pressed,.plyr__control:not(.plyr__control--pressed) .label--pressed{display:none}.plyr--full-ui ::-webkit-media-controls{display:none}.plyr__controls{align-items:center;display:flex;justify-content:flex-end;text-align:center}.plyr__controls .plyr__progress__container{flex:1;min-width:0}.plyr__controls .plyr__controls__item{margin-left:calc(10px / 4);margin-left:calc(var(--plyr-control-spacing,10px)/ 4)}.plyr__controls .plyr__controls__item:first-child{margin-left:0;margin-right:auto}.plyr__controls .plyr__controls__item.plyr__progress__container{padding-left:calc(10px / 4);padding-left:calc(var(--plyr-control-spacing,10px)/ 4)}.plyr__controls .plyr__controls__item.plyr__time{padding:0 calc(10px / 2);padding:0 calc(var(--plyr-control-spacing,10px)/ 2)}.plyr__controls .plyr__controls__item.plyr__progress__container:first-child,.plyr__controls .plyr__controls__item.plyr__time+.plyr__time,.plyr__controls .plyr__controls__item.plyr__time:first-child{padding-left:0}.plyr__controls:empty{display:none}.plyr [data-plyr=airplay],.plyr [data-plyr=captions],.plyr [data-plyr=fullscreen],.plyr [data-plyr=pip]{display:none}.plyr--airplay-supported [data-plyr=airplay],.plyr--captions-enabled [data-plyr=captions],.plyr--fullscreen-enabled [data-plyr=fullscreen],.plyr--pip-supported [data-plyr=pip]{display:inline-block}.plyr__menu{display:flex;position:relative}.plyr__menu .plyr__control svg{transition:transform .3s ease}.plyr__menu .plyr__control[aria-expanded=true] svg{transform:rotate(90deg)}.plyr__menu .plyr__control[aria-expanded=true] .plyr__tooltip{display:none}.plyr__menu__container{animation:plyr-popup .2s ease;background:rgba(255,255,255,.9);background:var(--plyr-menu-background,rgba(255,255,255,.9));border-radius:4px;bottom:100%;box-shadow:0 1px 2px rgba(0,0,0,.15);box-shadow:var(--plyr-menu-shadow,0 1px 2px rgba(0,0,0,.15));color:#4a5464;color:var(--plyr-menu-color,#4a5464);font-size:15px;font-size:var(--plyr-font-size-base,15px);margin-bottom:10px;position:absolute;right:-3px;text-align:left;white-space:nowrap;z-index:3}.plyr__menu__container>div{overflow:hidden;transition:height .35s cubic-bezier(.4,0,.2,1),width .35s cubic-bezier(.4,0,.2,1)}.plyr__menu__container::after{border:4px solid transparent;border:var(--plyr-menu-arrow-size,4px) solid transparent;border-top-color:rgba(255,255,255,.9);border-top-color:var(--plyr-menu-background,rgba(255,255,255,.9));content:'';height:0;position:absolute;right:calc(((18px / 2) + calc(10px * .7)) - (4px / 2));right:calc(((var(--plyr-control-icon-size,18px)/ 2) + calc(var(--plyr-control-spacing,10px) * .7)) - (var(--plyr-menu-arrow-size,4px)/ 2));top:100%;width:0}.plyr__menu__container [role=menu]{padding:calc(10px * .7);padding:calc(var(--plyr-control-spacing,10px) * .7)}.plyr__menu__container [role=menuitem],.plyr__menu__container [role=menuitemradio]{margin-top:2px}.plyr__menu__container [role=menuitem]:first-child,.plyr__menu__container [role=menuitemradio]:first-child{margin-top:0}.plyr__menu__container .plyr__control{align-items:center;color:#4a5464;color:var(--plyr-menu-color,#4a5464);display:flex;font-size:13px;font-size:var(--plyr-font-size-menu,var(--plyr-font-size-small,13px));padding-bottom:calc(calc(10px * .7)/ 1.5);padding-bottom:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 1.5);padding-left:calc(calc(10px * .7) * 1.5);padding-left:calc(calc(var(--plyr-control-spacing,10px) * .7) * 1.5);padding-right:calc(calc(10px * .7) * 1.5);padding-right:calc(calc(var(--plyr-control-spacing,10px) * .7) * 1.5);padding-top:calc(calc(10px * .7)/ 1.5);padding-top:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 1.5);-webkit-user-select:none;-ms-user-select:none;user-select:none;width:100%}.plyr__menu__container .plyr__control>span{align-items:inherit;display:flex;width:100%}.plyr__menu__container .plyr__control::after{border:4px solid transparent;border:var(--plyr-menu-item-arrow-size,4px) solid transparent;content:'';position:absolute;top:50%;transform:translateY(-50%)}.plyr__menu__container .plyr__control--forward{padding-right:calc(calc(10px * .7) * 4);padding-right:calc(calc(var(--plyr-control-spacing,10px) * .7) * 4)}.plyr__menu__container .plyr__control--forward::after{border-left-color:#728197;border-left-color:var(--plyr-menu-arrow-color,#728197);right:calc((calc(10px * .7) * 1.5) - 4px);right:calc((calc(var(--plyr-control-spacing,10px) * .7) * 1.5) - var(--plyr-menu-item-arrow-size,4px))}.plyr__menu__container .plyr__control--forward.plyr__tab-focus::after,.plyr__menu__container .plyr__control--forward:hover::after{border-left-color:currentColor}.plyr__menu__container .plyr__control--back{font-weight:400;font-weight:var(--plyr-font-weight-regular,400);margin:calc(10px * .7);margin:calc(var(--plyr-control-spacing,10px) * .7);margin-bottom:calc(calc(10px * .7)/ 2);margin-bottom:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 2);padding-left:calc(calc(10px * .7) * 4);padding-left:calc(calc(var(--plyr-control-spacing,10px) * .7) * 4);position:relative;width:calc(100% - (calc(10px * .7) * 2));width:calc(100% - (calc(var(--plyr-control-spacing,10px) * .7) * 2))}.plyr__menu__container .plyr__control--back::after{border-right-color:#728197;border-right-color:var(--plyr-menu-arrow-color,#728197);left:calc((calc(10px * .7) * 1.5) - 4px);left:calc((calc(var(--plyr-control-spacing,10px) * .7) * 1.5) - var(--plyr-menu-item-arrow-size,4px))}.plyr__menu__container .plyr__control--back::before{background:#dcdfe5;background:var(--plyr-menu-back-border-color,#dcdfe5);box-shadow:0 1px 0 #fff;box-shadow:0 1px 0 var(--plyr-menu-back-border-shadow-color,#fff);content:'';height:1px;left:0;margin-top:calc(calc(10px * .7)/ 2);margin-top:calc(calc(var(--plyr-control-spacing,10px) * .7)/ 2);overflow:hidden;position:absolute;right:0;top:100%}.plyr__menu__container .plyr__control--back.plyr__tab-focus::after,.plyr__menu__container .plyr__control--back:hover::after{border-right-color:currentColor}.plyr__menu__container .plyr__control[role=menuitemradio]{padding-left:calc(10px * .7);padding-left:calc(var(--plyr-control-spacing,10px) * .7)}.plyr__menu__container .plyr__control[role=menuitemradio]::after,.plyr__menu__container .plyr__control[role=menuitemradio]::before{border-radius:100%}.plyr__menu__container .plyr__control[role=menuitemradio]::before{background:rgba(0,0,0,.1);content:'';display:block;flex-shrink:0;height:16px;margin-right:10px;margin-right:var(--plyr-control-spacing,10px);transition:all .3s ease;width:16px}.plyr__menu__container .plyr__control[role=menuitemradio]::after{background:#fff;border:0;height:6px;left:12px;opacity:0;top:50%;transform:translateY(-50%) scale(0);transition:transform .3s ease,opacity .3s ease;width:6px}.plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]::before{background:#00b3ff;background:var(--plyr-control-toggle-checked-background,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)))}.plyr__menu__container .plyr__control[role=menuitemradio][aria-checked=true]::after{opacity:1;transform:translateY(-50%) scale(1)}.plyr__menu__container .plyr__control[role=menuitemradio].plyr__tab-focus::before,.plyr__menu__container .plyr__control[role=menuitemradio]:hover::before{background:rgba(35,40,47,.1)}.plyr__menu__container .plyr__menu__value{align-items:center;display:flex;margin-left:auto;margin-right:calc((calc(10px * .7) - 2) * -1);margin-right:calc((calc(var(--plyr-control-spacing,10px) * .7) - 2) * -1);overflow:hidden;padding-left:calc(calc(10px * .7) * 3.5);padding-left:calc(calc(var(--plyr-control-spacing,10px) * .7) * 3.5);pointer-events:none}.plyr--full-ui input[type=range]{-webkit-appearance:none;background:0 0;border:0;border-radius:calc(13px * 2);border-radius:calc(var(--plyr-range-thumb-height,13px) * 2);color:#00b3ff;color:var(--plyr-range-fill-background,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));display:block;height:calc((3px * 2) + 13px);height:calc((var(--plyr-range-thumb-active-shadow-width,3px) * 2) + var(--plyr-range-thumb-height,13px));margin:0;min-width:0;padding:0;transition:box-shadow .3s ease;width:100%}.plyr--full-ui input[type=range]::-webkit-slider-runnable-track{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-webkit-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-webkit-user-select:none;user-select:none;background-image:linear-gradient(to right,currentColor 0,transparent 0);background-image:linear-gradient(to right,currentColor var(--value,0),transparent var(--value,0))}.plyr--full-ui input[type=range]::-webkit-slider-thumb{background:#fff;background:var(--plyr-range-thumb-background,#fff);border:0;border-radius:100%;box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2));height:13px;height:var(--plyr-range-thumb-height,13px);position:relative;-webkit-transition:all .2s ease;transition:all .2s ease;width:13px;width:var(--plyr-range-thumb-height,13px);-webkit-appearance:none;margin-top:calc(((13px - 5px)/ 2) * -1);margin-top:calc(((var(--plyr-range-thumb-height,13px) - var(--plyr-range-track-height,5px))/ 2) * -1)}.plyr--full-ui input[type=range]::-moz-range-track{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-moz-transition:box-shadow .3s ease;transition:box-shadow .3s ease;user-select:none}.plyr--full-ui input[type=range]::-moz-range-thumb{background:#fff;background:var(--plyr-range-thumb-background,#fff);border:0;border-radius:100%;box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2));height:13px;height:var(--plyr-range-thumb-height,13px);position:relative;-moz-transition:all .2s ease;transition:all .2s ease;width:13px;width:var(--plyr-range-thumb-height,13px)}.plyr--full-ui input[type=range]::-moz-range-progress{background:currentColor;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px)}.plyr--full-ui input[type=range]::-ms-track{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-ms-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-ms-user-select:none;user-select:none;color:transparent}.plyr--full-ui input[type=range]::-ms-fill-upper{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-ms-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-ms-user-select:none;user-select:none}.plyr--full-ui input[type=range]::-ms-fill-lower{background:0 0;border:0;border-radius:calc(5px / 2);border-radius:calc(var(--plyr-range-track-height,5px)/ 2);height:5px;height:var(--plyr-range-track-height,5px);-ms-transition:box-shadow .3s ease;transition:box-shadow .3s ease;-ms-user-select:none;user-select:none;background:currentColor}.plyr--full-ui input[type=range]::-ms-thumb{background:#fff;background:var(--plyr-range-thumb-background,#fff);border:0;border-radius:100%;box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2));height:13px;height:var(--plyr-range-thumb-height,13px);position:relative;-ms-transition:all .2s ease;transition:all .2s ease;width:13px;width:var(--plyr-range-thumb-height,13px);margin-top:0}.plyr--full-ui input[type=range]::-ms-tooltip{display:none}.plyr--full-ui input[type=range]:focus{outline:0}.plyr--full-ui input[type=range]::-moz-focus-outer{border:0}.plyr--full-ui input[type=range].plyr__tab-focus::-webkit-slider-runnable-track{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}.plyr--full-ui input[type=range].plyr__tab-focus::-moz-range-track{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}.plyr--full-ui input[type=range].plyr__tab-focus::-ms-track{outline-color:#00b3ff;outline-color:var(--plyr-tab-focus-color,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));outline-offset:2px;outline-style:dotted;outline-width:3px}.plyr__poster{background-color:#000;background-position:50% 50%;background-repeat:no-repeat;background-size:contain;height:100%;left:0;opacity:0;position:absolute;top:0;transition:opacity .2s ease;width:100%;z-index:1}.plyr--stopped.plyr__poster-enabled .plyr__poster{opacity:1}.plyr__time{font-size:13px;font-size:var(--plyr-font-size-time,var(--plyr-font-size-small,13px))}.plyr__time+.plyr__time::before{content:'\\2044';margin-right:10px;margin-right:var(--plyr-control-spacing,10px)}@media (max-width:calc(768px - 1px)){.plyr__time+.plyr__time{display:none}}.plyr__tooltip{background:rgba(255,255,255,.9);background:var(--plyr-tooltip-background,rgba(255,255,255,.9));border-radius:3px;border-radius:var(--plyr-tooltip-radius,3px);bottom:100%;box-shadow:0 1px 2px rgba(0,0,0,.15);box-shadow:var(--plyr-tooltip-shadow,0 1px 2px rgba(0,0,0,.15));color:#4a5464;color:var(--plyr-tooltip-color,#4a5464);font-size:13px;font-size:var(--plyr-font-size-small,13px);font-weight:400;font-weight:var(--plyr-font-weight-regular,400);left:50%;line-height:1.3;margin-bottom:calc(calc(10px / 2) * 2);margin-bottom:calc(calc(var(--plyr-control-spacing,10px)/ 2) * 2);opacity:0;padding:calc(10px / 2) calc(calc(10px / 2) * 1.5);padding:calc(var(--plyr-control-spacing,10px)/ 2) calc(calc(var(--plyr-control-spacing,10px)/ 2) * 1.5);pointer-events:none;position:absolute;transform:translate(-50%,10px) scale(.8);transform-origin:50% 100%;transition:transform .2s .1s ease,opacity .2s .1s ease;white-space:nowrap;z-index:2}.plyr__tooltip::before{border-left:4px solid transparent;border-left:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-right:4px solid transparent;border-right:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-top:4px solid rgba(255,255,255,.9);border-top:var(--plyr-tooltip-arrow-size,4px) solid var(--plyr-tooltip-background,rgba(255,255,255,.9));bottom:calc(4px * -1);bottom:calc(var(--plyr-tooltip-arrow-size,4px) * -1);content:'';height:0;left:50%;position:absolute;transform:translateX(-50%);width:0;z-index:2}.plyr .plyr__control.plyr__tab-focus .plyr__tooltip,.plyr .plyr__control:hover .plyr__tooltip,.plyr__tooltip--visible{opacity:1;transform:translate(-50%,0) scale(1)}.plyr .plyr__control:hover .plyr__tooltip{z-index:3}.plyr__controls>.plyr__control:first-child .plyr__tooltip,.plyr__controls>.plyr__control:first-child+.plyr__control .plyr__tooltip{left:0;transform:translate(0,10px) scale(.8);transform-origin:0 100%}.plyr__controls>.plyr__control:first-child .plyr__tooltip::before,.plyr__controls>.plyr__control:first-child+.plyr__control .plyr__tooltip::before{left:calc((18px / 2) + calc(10px * .7));left:calc((var(--plyr-control-icon-size,18px)/ 2) + calc(var(--plyr-control-spacing,10px) * .7))}.plyr__controls>.plyr__control:last-child .plyr__tooltip{left:auto;right:0;transform:translate(0,10px) scale(.8);transform-origin:100% 100%}.plyr__controls>.plyr__control:last-child .plyr__tooltip::before{left:auto;right:calc((18px / 2) + calc(10px * .7));right:calc((var(--plyr-control-icon-size,18px)/ 2) + calc(var(--plyr-control-spacing,10px) * .7));transform:translateX(50%)}.plyr__controls>.plyr__control:first-child .plyr__tooltip--visible,.plyr__controls>.plyr__control:first-child+.plyr__control .plyr__tooltip--visible,.plyr__controls>.plyr__control:first-child+.plyr__control.plyr__tab-focus .plyr__tooltip,.plyr__controls>.plyr__control:first-child+.plyr__control:hover .plyr__tooltip,.plyr__controls>.plyr__control:first-child.plyr__tab-focus .plyr__tooltip,.plyr__controls>.plyr__control:first-child:hover .plyr__tooltip,.plyr__controls>.plyr__control:last-child .plyr__tooltip--visible,.plyr__controls>.plyr__control:last-child.plyr__tab-focus .plyr__tooltip,.plyr__controls>.plyr__control:last-child:hover .plyr__tooltip{transform:translate(0,0) scale(1)}.plyr__progress{left:calc(13px * .5);left:calc(var(--plyr-range-thumb-height,13px) * .5);margin-right:13px;margin-right:var(--plyr-range-thumb-height,13px);position:relative}.plyr__progress input[type=range],.plyr__progress__buffer{margin-left:calc(13px * -.5);margin-left:calc(var(--plyr-range-thumb-height,13px) * -.5);margin-right:calc(13px * -.5);margin-right:calc(var(--plyr-range-thumb-height,13px) * -.5);width:calc(100% + 13px);width:calc(100% + var(--plyr-range-thumb-height,13px))}.plyr__progress input[type=range]{position:relative;z-index:2}.plyr__progress .plyr__tooltip{font-size:13px;font-size:var(--plyr-font-size-time,var(--plyr-font-size-small,13px));left:0}.plyr__progress__buffer{-webkit-appearance:none;background:0 0;border:0;border-radius:100px;height:5px;height:var(--plyr-range-track-height,5px);left:0;margin-top:calc((5px / 2) * -1);margin-top:calc((var(--plyr-range-track-height,5px)/ 2) * -1);padding:0;position:absolute;top:50%}.plyr__progress__buffer::-webkit-progress-bar{background:0 0}.plyr__progress__buffer::-webkit-progress-value{background:currentColor;border-radius:100px;min-width:5px;min-width:var(--plyr-range-track-height,5px);-webkit-transition:width .2s ease;transition:width .2s ease}.plyr__progress__buffer::-moz-progress-bar{background:currentColor;border-radius:100px;min-width:5px;min-width:var(--plyr-range-track-height,5px);-moz-transition:width .2s ease;transition:width .2s ease}.plyr__progress__buffer::-ms-fill{border-radius:100px;-ms-transition:width .2s ease;transition:width .2s ease}.plyr--loading .plyr__progress__buffer{animation:plyr-progress 1s linear infinite;background-image:linear-gradient(-45deg,rgba(35,40,47,.6) 25%,transparent 25%,transparent 50%,rgba(35,40,47,.6) 50%,rgba(35,40,47,.6) 75%,transparent 75%,transparent);background-image:linear-gradient(-45deg,var(--plyr-progress-loading-background,rgba(35,40,47,.6)) 25%,transparent 25%,transparent 50%,var(--plyr-progress-loading-background,rgba(35,40,47,.6)) 50%,var(--plyr-progress-loading-background,rgba(35,40,47,.6)) 75%,transparent 75%,transparent);background-repeat:repeat-x;background-size:25px 25px;background-size:var(--plyr-progress-loading-size,25px) var(--plyr-progress-loading-size,25px);color:transparent}.plyr--video.plyr--loading .plyr__progress__buffer{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25))}.plyr--audio.plyr--loading .plyr__progress__buffer{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6))}.plyr__volume{align-items:center;display:flex;max-width:110px;min-width:80px;position:relative;width:20%}.plyr__volume input[type=range]{margin-left:calc(10px / 2);margin-left:calc(var(--plyr-control-spacing,10px)/ 2);margin-right:calc(10px / 2);margin-right:calc(var(--plyr-control-spacing,10px)/ 2);position:relative;z-index:2}.plyr--is-ios .plyr__volume{min-width:0;width:auto}.plyr--audio{display:block}.plyr--audio .plyr__controls{background:#fff;background:var(--plyr-audio-controls-background,#fff);border-radius:inherit;color:#4a5464;color:var(--plyr-audio-control-color,#4a5464);padding:10px;padding:var(--plyr-control-spacing,10px)}.plyr--audio .plyr__control.plyr__tab-focus,.plyr--audio .plyr__control:hover,.plyr--audio .plyr__control[aria-expanded=true]{background:#00b3ff;background:var(--plyr-audio-control-background-hover,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));color:#fff;color:var(--plyr-audio-control-color-hover,#fff)}.plyr--full-ui.plyr--audio input[type=range]::-webkit-slider-runnable-track{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-range-track-background,var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6)))}.plyr--full-ui.plyr--audio input[type=range]::-moz-range-track{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-range-track-background,var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6)))}.plyr--full-ui.plyr--audio input[type=range]::-ms-track{background-color:rgba(193,200,209,.6);background-color:var(--plyr-audio-range-track-background,var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6)))}.plyr--full-ui.plyr--audio input[type=range]:active::-webkit-slider-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(35,40,47,.1);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(35,40,47,.1))}.plyr--full-ui.plyr--audio input[type=range]:active::-moz-range-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(35,40,47,.1);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(35,40,47,.1))}.plyr--full-ui.plyr--audio input[type=range]:active::-ms-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(35,40,47,.1);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(35,40,47,.1))}.plyr--audio .plyr__progress__buffer{color:rgba(193,200,209,.6);color:var(--plyr-audio-progress-buffered-background,rgba(193,200,209,.6))}.plyr--video{background:#000;overflow:hidden}.plyr--video.plyr--menu-open{overflow:visible}.plyr__video-wrapper{background:#000;height:100%;margin:auto;overflow:hidden;position:relative;width:100%}.plyr__video-embed,.plyr__video-wrapper--fixed-ratio{height:0;padding-bottom:56.25%}.plyr__video-embed iframe,.plyr__video-wrapper--fixed-ratio video{border:0;left:0;position:absolute;top:0}.plyr--full-ui .plyr__video-embed>.plyr__video-embed__container{padding-bottom:240%;position:relative;transform:translateY(-38.28125%)}.plyr--video .plyr__controls{background:linear-gradient(rgba(0,0,0,0),rgba(0,0,0,.75));background:var(--plyr-video-controls-background,linear-gradient(rgba(0,0,0,0),rgba(0,0,0,.75)));border-bottom-left-radius:inherit;border-bottom-right-radius:inherit;bottom:0;color:#fff;color:var(--plyr-video-control-color,#fff);left:0;padding:calc(10px / 2);padding:calc(var(--plyr-control-spacing,10px)/ 2);padding-top:calc(10px * 2);padding-top:calc(var(--plyr-control-spacing,10px) * 2);position:absolute;right:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out;z-index:3}@media (min-width:480px){.plyr--video .plyr__controls{padding:10px;padding:var(--plyr-control-spacing,10px);padding-top:calc(10px * 3.5);padding-top:calc(var(--plyr-control-spacing,10px) * 3.5)}}.plyr--video.plyr--hide-controls .plyr__controls{opacity:0;pointer-events:none;transform:translateY(100%)}.plyr--video .plyr__control.plyr__tab-focus,.plyr--video .plyr__control:hover,.plyr--video .plyr__control[aria-expanded=true]{background:#00b3ff;background:var(--plyr-video-control-background-hover,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));color:#fff;color:var(--plyr-video-control-color-hover,#fff)}.plyr__control--overlaid{background:#00b3ff;background:var(--plyr-video-control-background-hover,var(--plyr-color-main,var(--plyr-color-main,#00b3ff)));border:0;border-radius:100%;color:#fff;color:var(--plyr-video-control-color,#fff);display:none;left:50%;opacity:.9;padding:calc(10px * 1.5);padding:calc(var(--plyr-control-spacing,10px) * 1.5);position:absolute;top:50%;transform:translate(-50%,-50%);transition:.3s;z-index:2}.plyr__control--overlaid svg{left:2px;position:relative}.plyr__control--overlaid:focus,.plyr__control--overlaid:hover{opacity:1}.plyr--playing .plyr__control--overlaid{opacity:0;visibility:hidden}.plyr--full-ui.plyr--video .plyr__control--overlaid{display:block}.plyr--full-ui.plyr--video input[type=range]::-webkit-slider-runnable-track{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-range-track-background,var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25)))}.plyr--full-ui.plyr--video input[type=range]::-moz-range-track{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-range-track-background,var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25)))}.plyr--full-ui.plyr--video input[type=range]::-ms-track{background-color:rgba(255,255,255,.25);background-color:var(--plyr-video-range-track-background,var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25)))}.plyr--full-ui.plyr--video input[type=range]:active::-webkit-slider-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(255,255,255,.5);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(255,255,255,.5))}.plyr--full-ui.plyr--video input[type=range]:active::-moz-range-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(255,255,255,.5);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(255,255,255,.5))}.plyr--full-ui.plyr--video input[type=range]:active::-ms-thumb{box-shadow:0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2),0 0 0 3px rgba(255,255,255,.5);box-shadow:var(--plyr-range-thumb-shadow,0 1px 1px rgba(35,40,47,.15),0 0 0 1px rgba(35,40,47,.2)),0 0 0 var(--plyr-range-thumb-active-shadow-width,3px) var(--plyr-audio-range-thumb-active-shadow-color,rgba(255,255,255,.5))}.plyr--video .plyr__progress__buffer{color:rgba(255,255,255,.25);color:var(--plyr-video-progress-buffered-background,rgba(255,255,255,.25))}.plyr:-webkit-full-screen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-ms-fullscreen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:fullscreen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-webkit-full-screen video{height:100%}.plyr:-ms-fullscreen video{height:100%}.plyr:fullscreen video{height:100%}.plyr:-webkit-full-screen .plyr__video-wrapper{height:100%;position:static}.plyr:-ms-fullscreen .plyr__video-wrapper{height:100%;position:static}.plyr:fullscreen .plyr__video-wrapper{height:100%;position:static}.plyr:-webkit-full-screen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-ms-fullscreen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:fullscreen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen{display:block}.plyr:fullscreen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:fullscreen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-webkit-full-screen.plyr--hide-controls{cursor:none}.plyr:-ms-fullscreen.plyr--hide-controls{cursor:none}.plyr:fullscreen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-webkit-full-screen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}.plyr:-ms-fullscreen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}.plyr:fullscreen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr:-webkit-full-screen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-webkit-full-screen video{height:100%}.plyr:-webkit-full-screen .plyr__video-wrapper{height:100%;position:static}.plyr:-webkit-full-screen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-webkit-full-screen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-webkit-full-screen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-webkit-full-screen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr:-moz-full-screen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-moz-full-screen video{height:100%}.plyr:-moz-full-screen .plyr__video-wrapper{height:100%;position:static}.plyr:-moz-full-screen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-moz-full-screen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-moz-full-screen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-moz-full-screen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-moz-full-screen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr:-ms-fullscreen{background:#000;border-radius:0!important;height:100%;margin:0;width:100%}.plyr:-ms-fullscreen video{height:100%}.plyr:-ms-fullscreen .plyr__video-wrapper{height:100%;position:static}.plyr:-ms-fullscreen.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen{display:block}.plyr:-ms-fullscreen .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr:-ms-fullscreen.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr:-ms-fullscreen .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr--fullscreen-fallback{background:#000;border-radius:0!important;height:100%;margin:0;width:100%;bottom:0;display:block;left:0;position:fixed;right:0;top:0;z-index:10000000}.plyr--fullscreen-fallback video{height:100%}.plyr--fullscreen-fallback .plyr__video-wrapper{height:100%;position:static}.plyr--fullscreen-fallback.plyr--vimeo .plyr__video-wrapper{height:0;position:relative}.plyr--fullscreen-fallback .plyr__control .icon--exit-fullscreen{display:block}.plyr--fullscreen-fallback .plyr__control .icon--exit-fullscreen+svg{display:none}.plyr--fullscreen-fallback.plyr--hide-controls{cursor:none}@media (min-width:1024px){.plyr--fullscreen-fallback .plyr__captions{font-size:21px;font-size:var(--plyr-font-size-xlarge,21px)}}.plyr__ads{border-radius:inherit;bottom:0;cursor:pointer;left:0;overflow:hidden;position:absolute;right:0;top:0;z-index:-1}.plyr__ads>div,.plyr__ads>div iframe{height:100%;position:absolute;width:100%}.plyr__ads::after{background:#23282f;border-radius:2px;bottom:10px;bottom:var(--plyr-control-spacing,10px);color:#fff;content:attr(data-badge-text);font-size:11px;padding:2px 6px;pointer-events:none;position:absolute;right:10px;right:var(--plyr-control-spacing,10px);z-index:3}.plyr__ads::after:empty{display:none}.plyr__cues{background:currentColor;display:block;height:5px;height:var(--plyr-range-track-height,5px);left:0;margin:-var(--plyr-range-track-height,5px)/2 0 0;opacity:.8;position:absolute;top:50%;width:3px;z-index:3}.plyr__preview-thumb{background-color:rgba(255,255,255,.9);background-color:var(--plyr-tooltip-background,rgba(255,255,255,.9));border-radius:3px;bottom:100%;box-shadow:0 1px 2px rgba(0,0,0,.15);box-shadow:var(--plyr-tooltip-shadow,0 1px 2px rgba(0,0,0,.15));margin-bottom:calc(calc(10px / 2) * 2);margin-bottom:calc(calc(var(--plyr-control-spacing,10px)/ 2) * 2);opacity:0;padding:3px;padding:var(--plyr-tooltip-radius,3px);pointer-events:none;position:absolute;transform:translate(0,10px) scale(.8);transform-origin:50% 100%;transition:transform .2s .1s ease,opacity .2s .1s ease;z-index:2}.plyr__preview-thumb--is-shown{opacity:1;transform:translate(0,0) scale(1)}.plyr__preview-thumb::before{border-left:4px solid transparent;border-left:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-right:4px solid transparent;border-right:var(--plyr-tooltip-arrow-size,4px) solid transparent;border-top:4px solid rgba(255,255,255,.9);border-top:var(--plyr-tooltip-arrow-size,4px) solid var(--plyr-tooltip-background,rgba(255,255,255,.9));bottom:calc(4px * -1);bottom:calc(var(--plyr-tooltip-arrow-size,4px) * -1);content:'';height:0;left:50%;position:absolute;transform:translateX(-50%);width:0;z-index:2}.plyr__preview-thumb__image-container{background:#c1c8d1;border-radius:calc(3px - 1px);border-radius:calc(var(--plyr-tooltip-radius,3px) - 1px);overflow:hidden;position:relative;z-index:0}.plyr__preview-thumb__image-container img{height:100%;left:0;max-height:none;max-width:none;position:absolute;top:0;width:100%}.plyr__preview-thumb__time-container{bottom:6px;left:0;position:absolute;right:0;white-space:nowrap;z-index:3}.plyr__preview-thumb__time-container span{background-color:rgba(0,0,0,.55);border-radius:calc(3px - 1px);border-radius:calc(var(--plyr-tooltip-radius,3px) - 1px);color:#fff;font-size:13px;font-size:var(--plyr-font-size-time,var(--plyr-font-size-small,13px));padding:3px 6px}.plyr__preview-scrubbing{bottom:0;filter:blur(1px);height:100%;left:0;margin:auto;opacity:0;overflow:hidden;pointer-events:none;position:absolute;right:0;top:0;transition:opacity .3s ease;width:100%;z-index:1}.plyr__preview-scrubbing--is-shown{opacity:1}.plyr__preview-scrubbing img{height:100%;left:0;max-height:none;max-width:none;object-fit:contain;position:absolute;top:0;width:100%}.plyr--no-transition{transition:none!important}.plyr__sr-only{clip:rect(1px,1px,1px,1px);overflow:hidden;border:0!important;height:1px!important;padding:0!important;position:absolute!important;width:1px!important}.plyr [hidden]{display:none!important}",""]);const o=a},485:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(81),r=n.n(i),s=n(645),a=n.n(s)()(r());a.push([e.id,"html,\nbody {\n    margin: 0;\n    padding: 0;\n    overflow: hidden;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    background: transparent;\n    align-items: center;\n    justify-content: center;\n    font-family: 'Rubik', sans-serif;\n\n}\nhtml {\n    scrollbar-width: thin;\n    scrollbar-color: #888 #f1f1f1;\n}\n::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n}\n\n::-webkit-scrollbar-track {\n    background: #f1f1f1;\n}\n\n::-webkit-scrollbar-thumb {\n    background: #888;\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: #555;\n}\n\n.in-page-container{\n    height: auto !important;\n    margin: 0 !important;\n}\n:root{\n    --max-height: 100vh;\n    --muted-indicator-border-size: 2px;\n}\n\n.container {\n    width: 100%;\n    height: 100%;\n    display: table;\n}\n\nvideo {\n    width: 100%;\n    height: 100%;\n    visibility: hidden;\n}\n.plyr__poster {\n    background-size: cover;\n    opacity: 1;\n}\n.panda-forward-wrapper{\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: space-between;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.panda-forward-wrapper div{\n    width: 50%;\n    height: 100%;\n}\n\n.plyr__captions {\n    font-size: 20px;\n    z-index: 4;\n}\n\n.plyr--video .plyr__controls {\n    z-index: 5;\n}\n\n@media (min-width: 480px) {\n    .plyr__captions {\n        font-size: 18px;\n    }\n}\n.play-cta{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n}\n\n@media (max-width: 350px) {\n    .plyr__volume>input[type=range] {\n        display: none;\n    }\n\n    .plyr__volume {\n        min-width: 30px;\n        width: 30px;\n    }\n}\n@media (max-width: 480px) {\n    .plyr__captions {\n        font-size: 14px;\n    }\n}\n\n@media (min-width: 768px) {\n    .plyr__captions {\n        font-size: 23px;\n    }\n}\n\n@media (min-width: 1024px) {\n    .plyr__captions {\n        font-size: 26px;\n    }\n}\n\n#live-time-indicator{\n    background: none;\n    outline: 0;\n    border: 0;\n    color: var(--live-indicator-color);\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n}\n#live-time-indicator div{\n    width: 8px;\n    height: 8px;\n    border-radius: 5px;\n    background: var(--live-indicator-color);\n    margin-right: 4px;\n}\n.not-realtime{\n    opacity: 0.5;\n}\n.hide-slyder-badge::-webkit-slider-thumb {\n    opacity: 0;\n}\n\n.plyr audio,\n.plyr iframe,\n.plyr video {\n    max-height: 100vh;\n}\n.end-cta{\n    width: 100%;\n    height: 100%;\n}\n.panda-branding-link {\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0 4px;\n    padding-bottom: 2px;\n    border-radius: 3px;\n    transition: background .3s;\n}\n\n.panda-branding-link:hover {\n    background: var(--plyr-color-main)\n}\n\n.plyr--video {\n    height: 100%\n}\n\n.container-drm {\n    height: 100%;\n    width: 100%;\n    display: table-cell;\n    text-align: center;\n    vertical-align: middle;\n}\n\n#drm-question {\n    color: white;\n    font-size: 1.8rem;\n    margin: 0;\n    margin-bottom: 20px;\n    text-shadow: 0px 0 1px black;\n}\n\n#drm-answer {\n    height: 33px;\n    font-size: 1rem;\n    margin-bottom: 15px;\n    width: 50%;\n    padding: 10px 15px;\n    display: inline-block;\n    border: .5px solid #ccc !important;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\n#drm-answer:focus {\n    outline: none;\n}\n\n#drm-button {\n    position: absolute;\n    height: 33px;\n    width: 33px;\n    border: none;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n    margin-left: -32px;\n}\n\n.drm-search-icon svg {\n    width: 30px;\n    height: 30px;\n    margin-left: -3px;\n}\n\n.drm-loading-icon svg {\n    height: 40px;\n    width: 40px;\n    position: absolute;\n    left: -2px;\n    top: -3px;\n}\n\n.disabled {\n    display: none  !important;\n}\n\n.panda-live-indicator {\n    position: absolute;\n    right: 20px;\n    top: 5px;\n    padding: 2px 16px;\n    border-radius: 4px;\n    font-weight: bold;\n    background-color: var(--live-indicator-color);\n    color: #fff;\n    opacity: 0.85;\n}\n\n#error-indicator{\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1000;\n    padding: 30px;\n    line-height: 2em;\n    background: rgba(0,0,0,0.6);\n}\n\n.panda-title-wrapper {\n    position: absolute;\n    top: calc(-100vh + 75px);\n    left: 0;\n    width: 100%;\n    transition: transform .01s;\n    height: 80px;\n    background: var(--plyr-video-controls-background, linear-gradient(rgba(0, 0, 0, .85), rgba(0, 0, 0, 0)));\n}\n\n.plyr-controls-fix-index {\n    z-index: 12 !important;\n}\n@media (max-width: 550px) {\n    .panda-title-wrapper {\n        position: absolute;\n        top: calc(-100vh + 55px);\n        left: 0;\n        width: 100%;\n        transition: transform .01s;\n        height: 80px;\n        background: var(--plyr-video-controls-background, linear-gradient(rgba(0, 0, 0, .85), rgba(0, 0, 0, 0)));\n    }\n}\n\n.plyr--video.plyr--hide-controls .plyr__controls {\n    transform: translateY(0) !important;\n}\n\n.panda-title-wrapper p {\n    color: var(--plyr-video-control-color);\n    padding: 10px 20px;\n    margin: 0;\n    font-size: 18px;\n    font-weight: bold;\n    text-align: start;\n}\n\n.loading-icon svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translateX(-50%) translateY(-50%);\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    -o-transform: translateX(-50%) translateY(-50%);\n    width: 30%;\n    height: 30%;\n}\n.live-offline-badge{\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background: #040814;\n    color: #fff;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n}\n@keyframes pulsateLogo {\n    0% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.1);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n.live-offline-badge img{\n    width: 40%;\n    max-width: 500px;\n    animation: pulsateLogo 3s ease-in-out infinite;\n}\n\n.live-offline-badge p{\n    font-size: 1rem;\n    margin-top: 10px;\n    font-weight: bold;\n}\n\n.live-thumb{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n}\n.live-thumb img{\n    width: 100%;\n    height: 100%;\n}\n.alternative-progress-wrapper{\n    width: 100%;\n    height: 20px;\n    position: absolute;\n    display: flex;\n    align-items: flex-end;\n    bottom: 0;\n    left: 0;\n    transition: width .1s;\n}\n.alternative-progress{\n    --value-progress: 0%;\n    background: var(--plyr-color-main);\n    height: 100%;\n    width: var(--value-progress);\n    transition: width 0.7s;\n    z-index: 100000;\n}\n@media (max-width: 550px) {\n    .alternative-progress-wrapper{\n        height: 20px;\n    }\n}\nbutton[data-plyr=\"play\"].plyr__control--overlaid{\n    z-index: 5;\n}\n@media (max-width: 450px) {\n    .alternative-progress-wrapper{\n        height: 14px;\n    }\n}\n@media (max-width: 380px) {\n    .alternative-progress-wrapper{\n        height: 10px;\n    }\n}\n@media (max-width: 490px){\n    button[data-plyr=\"rewind\"]{\n        display: none;\n    }\n    button[data-plyr=\"fast-forward\"]{\n        display: none;\n    }\n    button[data-plyr=\"play\"]{\n        margin-right: auto;\n    }\n    .no-progress button[data-plyr=\"play\"].plyr__controls__item, .no-progress div.plyr__time--current,.no-progress  div.plyr__time{\n        position: static !important;\n    }\n    .panda-bookmarks-div{\n        position: relative;\n    }\n}\n.panda-bookmarks-list-title{\n    width: calc(100% - 20px);\n    text-align: start;\n    padding: 5px 10px;\n    border-bottom: 1px solid #ccc;\n    margin: 3px 10px;\n    font-size: 13px;\n}\n.panda-bookmarks-list-wrapper{\n    animation: plyr-popup .2s ease;\n    position: absolute;\n    bottom: 50px;\n    right: 0px;\n    color: var(--plyr-menu-color,#4a5464);\n    background: var(--plyr-menu-background,rgba(255,255,255,.9));\n    border-radius: 4px;\n    opacity: 0.9;\n}\n\n.panda-bookmarks-list{ \n    list-style-type: none;\n    padding: 5px 10px;\n    padding-top: 0;\n    max-height: calc(var(--max-height) - 110px);\n    overflow-y: auto;\n    margin-top: 0;\n}\n.panda-bookmarks-list::-webkit-scrollbar {\n    width: 5px;\n}\n.panda-bookmarks-list::-webkit-scrollbar-track {\n    background: var(--plyr-menu-background,rgba(255,255,255,.9));\n    border-radius: 5px;\n}\n.panda-bookmarks-list::-webkit-scrollbar-thumb {\n    background: #ccc; \n    border-radius: 5px;\n}\n.panda-bookmarks-list li {\n    display: flex;\n    padding: 3px 10px;\n    min-width: 130px;\n    max-width: 220px;\n    text-align: start;\n    cursor: pointer;\n    border-radius: 2px;\n}\n.panda-bookmarks-list li:hover{\n    background: var(--plyr-color-main);\n    color: var(--plyr-video-control-color);\n}\n.panda-bookmarks-list  li span{\n    font-size: 13px;\n    font-weight: normal;\n    line-height: 18px;\n}\n.panda-bookmarks-button{\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 3px;\n    margin-left: 2px;\n    transition: background .3s;\n    border: 0;\n    background: none;\n}\n.active-bookmark {\n    background: var(--plyr-color-main);\n}\n.panda-bookmarks-button:hover {\n    background: var(--plyr-color-main)\n}\n.panda-bookmark-progress-dot{\n    width: 5px;\n    height: 5px;\n    border-radius: 50%;\n    background: var(--plyr-video-control-color);\n    position: absolute;\n    top: 7px;\n    left: calc(var(--dot-percent) - 6px);\n    z-index: 20;\n}\n.plyr__menu__container > div > div{\n    max-height: calc(var(--max-height) - 50px);\n    overflow-y: auto;\n}\n.plyr__menu__container > div > div::-webkit-scrollbar {\n    width: 5px;\n}\n.plyr__menu__container > div > div::-webkit-scrollbar-track {\n    background: var(--plyr-menu-background,rgba(255,255,255,.9));\n    border-radius: 5px;\n}\n.plyr__menu__container > div > div::-webkit-scrollbar-thumb {\n    background: #ccc; \n    border-radius: 5px;\n}\n\n.cta-overlay{\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n    outline: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.cta-overlay iframe{\n    outline: 0;\n    border: 0;\n} \n.cta-skip-button{\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    padding: 10px;\n    cursor: pointer;\n    background: rgba(255,255,255,0.4);\n    border: 0;\n    outline: 0;\n}\n.cta-container{\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    z-index: 1000;\n}\n.panda-resume-screen-wrapper{\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    background: var(--plyr-color-main);\n    z-index: 15;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    font-size: 1rem;\n}\n.panda-resume-screen-wrapper p{\n    color: var(--plyr-video-control-color);\n    font-size: 1.4em;\n    font-weight: bold;\n}\n.panda-resume-screen-buttons{\n    display: flex;\n    flex-direction: row;\n}\n.panda-resume-screen-buttons button{\n    background: none;\n    border: 0;\n    outline: 0;\n    display: flex;\n    align-items: center;\n    padding: 10px 20px;\n    cursor: pointer;\n    color: var(--plyr-video-control-color);\n    font-size: 1.1em;\n}\n.panda-resume-screen-buttons button svg{\n    width: 1.9em;\n    height: 1.9em;\n}\n.panda-resume-screen-buttons button span{\n    padding-left: 4px;\n}\n@media (max-width: 450px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.8rem;\n    }\n}\n@media (max-width: 350px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.7rem;\n    }\n}\n@media (max-width: 275px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.6rem;\n    }\n}\n@media (max-width: 230px) {\n    .panda-resume-screen-wrapper{\n        font-size: 0.5rem;\n    }\n}\n.plyr--full-ui.fullscreen ::-webkit-media-text-track-container {\n    display:block !important;\n}\n@keyframes plyr-popup{\n    0%{\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    100%{\n        opacity: 1;\n        transform: translateY(0px);\n    }\n}\n#context-menu-ai {\n    position: absolute;\n    min-height: 45px;\n    min-width: 170px;\n    display: none;\n    background: rgba(255,255,255,0.8);\n    bottom: 32px;\n    right: 0;\n}\n#context-menu-ai.active {\n    display: block;\n}\n#context-menu{\n    position: absolute;\n    display: flex;\n    width: 170px;\n    background: rgba(255,255,255,0.8);\n    border-radius: 3px;\n    z-index: 100;\n}\n#context-menu ul{\n    display: flex;\n    flex-direction: column;\n    align-items: start;\n    justify-content: space-around;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n}\n#context-menu ul li{\n    list-style: none;\n    display: flex;\n    width: 100%;\n}\n#context-menu ul li:hover{\n    opacity: 0.8;\n    background: var(--plyr-color-main);\n}\n#context-menu ul li *:hover{\n    color: var(--plyr-video-control-color);\n}\n#context-menu ul li a{\n    text-decoration: none;\n    color: #333;\n    font-size: 0.8rem;\n    padding: 10px;\n    cursor: pointer;\n    width: 100%;\n}\n#context-menu ul li button{\n    color: #333;\n    background: 0;\n    outline: 0;\n    border: 0;\n    font-size: 0.8rem;\n    cursor: pointer;\n    width: 100%;\n    text-align: start;\n    padding: 10px;\n}\n#content-ai {\n    height: 83%;\n    position: relative;\n    overflow: auto;\n}\n#content-ai-dialog,\n#report-problem-dialog {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n#modal-ai,\n#copy-paste{\n    display: flex;\n    flex-direction: column;\n    width: 520px;\n    height: 300px;\n    z-index: 100;\n    background-color: #1b1b4b;\n    border-radius: 5px;\n}\n#modal-ai {\n    position: relative;\n}\n\n#modal-ai .close-ai-button {\n    cursor: pointer;\n    top: 2px;\n    position: absolute;\n    right: 10px;\n    border: none;\n    background: none;\n    color: white;\n    font-size: 18px;\n    padding: 10px;\n}\n\n#modal-ai.smart-search  .close-ai-button {\n    top: 8px;\n}\n\n#search-content ul {\n    padding: 0 15px 0 15px;\n}\n\n#search-content ul li {\n    list-style: none;\n    color: white;\n    padding: 0 0 0 10px;\n    border: 1px solid #ccc;\n    font-size: 13px;\n    height: auto;\n    border-radius: 2px;\n    display: flex;\n    justify-content: space-between;\n    margin: 10px 0 0 0;\n    cursor: pointer;\n}\n\n#search-content ul li:hover {\n    background-color: #eee3;\n}\n\n#search-content ul li span {\n    margin: auto 10px;\n    background-color: #444;\n    padding: 8px 5px 8px 5px;\n    border-radius: 5px;\n}\n\n#modal-ai #input-smart-search {\n    margin: 15px 0 0px 15px;\n    padding: 0 0 0 10px;\n    width: 260px;\n    height: 30px;\n    border: none;\n    border-radius: 5px;\n}\n\n#modal-ai #input-smart-search:focus {\n    outline: none;\n}\n\n#mindmap-zoom-controls {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    display: flex;\n    padding: 15px;\n    flex-direction: column;\n    align-items: center;\n}\n#mindmap-zoom-controls button {\n    margin: 2px;\n    height: 20px;\n    font-size: 13px;\n    border: none;\n    padding: 3px;\n    cursor: pointer;\n}\n#mindmap-container {\n    transition: transform 0.3s ease;\n    transform-origin: top left;\n    height: 98%;\n    position: relative;\n    margin: 0px;\n    padding: 0px;\n}\n#mindmap-container svg{ \n    height: 100%;\n}\n#mindmap-container svg .mindmap-node {\n    cursor: pointer;\n}\n#question-enunciate {\n    color: #fff;\n    font-size: 14px;\n    margin: 2px 0 0 15px;\n}\n#answer-options {\n    margin: 15px 0 0 15px;\n    padding: 0;\n}\n#answer-options li {\n    display: block;\n    color: white;\n    padding: 10px;\n    margin-bottom: 10px;\n    width: 93%;\n    border: 1px solid #ccc;\n    font-size: 13px;\n    cursor: pointer;\n}\n#answer-options li:not(.answered):hover {\n    background-color: #eee3;\n}\n#abstract-footer,\n#questions-footer {\n    display: flex;\n    justify-content: space-between;\n    height: 60px;\n}\n#questions-footer button {\n    height: 30px;\n    margin: 10px 17px 0 14px;\n    cursor: pointer;\n}\n#questions-indicator,\n.title-ai-text,\n.report-problem-text{\n    display: flex;\n    color: #fff;\n    justify-content: center;\n    align-items: center;\n    font-weight: 600;\n    font-size: 15px;\n}\n#copy-paste #report-first-step section {\n    display: flex;\n    flex-direction: column; \n    align-items: flex-start;\n    margin: 10px 30px 0px 30px;\n    color: #ccc;\n    font-size: 16px;\n}\n#copy-paste #report-first-step section div {\n    margin: 0 0 12px 0;\n}\n#modal-ai #content-ai footer,\n#copy-paste #report-first-step footer {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n#abstract-content {\n    color: white;\n    padding: 0 15px 0 15px;\n    font-size: 14px;\n}\n#abstract-content a {\n    color: white;\n}\n#abstract-content h1 {\n    font-size: 20px;\n}\n#abstract-content h2 {\n    font-size: 18px;\n}\n#abstract-content h3 {\n    font-size: 15px;\n}\n#abstract-copy-button,\n#abstract-download-button,\n#mindmap-download-button,\n.content-ai-dialog-button,\n.report-problem-dialog-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: #a6a2ec;\n    border-radius: 6px;\n    border-style: none;\n    box-sizing: border-box;\n    color: #FFFFFF;\n    cursor: pointer;\n    height: 35px;\n    line-height: 20px;\n    margin: 0;\n    outline: none;\n    padding: 10px 0px;\n    position: relative;\n    text-align: center;\n    text-decoration: none;\n    transition: color 100ms;\n    vertical-align: baseline;\n    user-select: none;\n    -webkit-user-select: none;\n    touch-action: manipulation;\n    width: 140px;\n    font-size: 0.8rem;\n}\n\n#abstract-copy-button,\n#abstract-download-button,\n#mindmap-download-button {\n    height: 30px;\n    width: 90px;\n    margin: 10px 15px 0 15px;\n}\n\n#modal-ai #content-ai footer button:hover,\n#modal-ai #content-ai footer button:focus,\n#copy-paste #report-first-step footer button:hover,\n#copy-paste #report-first-step footer button:focus {\n    background-color: #bab7eb;\n}\n#modal-ai #content-ai footer > :first-child,\n#copy-paste #report-first-step footer > :first-child {\n    margin-right: 20px;\n}\n.other-input {\n    width: 100%;\n    padding: 10px 20px;\n    margin: 0px 0px 8px 0px;\n    display: inline-block;\n    border: .5px solid #ccc !important;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n#copy-paste #report-second-step {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    color: #fff;\n    font-size: 16px;\n    font-weight: 600;\n    text-align: center;\n    line-height: 1.3rem;\n}\n#copy-paste #report-second-step header {\n    margin-top: 10px;\n}\n#copy-paste #report-second-step #second-step-text {\n    margin-top: -10px;\n}\n#copy-paste #report-second-step #loading-div {\n    width: 120px;\n}\n#copy-paste #report-third-step {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    color: #fff;\n    font-size: 16px;\n    font-weight: 600;\n    text-align: center;\n    line-height: 1.3rem;\n}\n#copy-paste #report-third-step.alone {\n    margin-top: 40px;\n}\n#copy-paste #report-third-step header {\n    margin-top: 15px;\n    margin-bottom: 5px;\n}\n#copy-paste #report-third-step footer {\n    margin-top: 15px;\n}\n.report-textfield-card {\n    height: 40px;\n    width: 97%;\n    padding-left: 5px;\n}\n\n@media (min-width: 1024px) {\n    #modal-ai {\n        width: 60%;\n        height: 60%;\n    }\n}\n@media (max-width: 450px) {\n    #modal-ai,\n    #copy-paste {\n        width: 300px;\n        height: 180px;\n    }\n    #modal-ai .close-ai-button {\n        top: -6px;\n        right: 5px;\n        font-size: 15px;\n        padding: 10px;\n    }\n    #modal-ai header p,\n    #copy-paste header p {\n        margin: 10px 0px 0px 0px;\n    }\n    #answer-options li {\n        font-size: 7px;\n        padding: 5px;\n        width: 90%;\n    }\n    #questions-footer button {\n        height: 20px;\n        margin: 7px 12px 0 12px;\n    }\n    #abstract-footer,\n    #questions-footer {\n        height: 40px;\n    }\n    #abstract-content,\n    #questions-indicator,\n    #question-enunciate,\n    .title-ai-text,\n    .report-problem-text {\n        font-size: 9px;\n    }\n    #question-enunciate {\n        margin: 6px 0 0 15px;\n    }\n    #abstract-content h1 {\n        font-size: 14px;\n    }\n    #abstract-content h2 {\n        font-size: 12px;\n    }\n    #abstract-content h3 {\n        font-size: 10px;\n    }\n    .report-textfield-card {\n        height: 32px;\n        width: 94%;\n        padding-left: 2px;\n    }\n    #abstract-copy-button,\n    #abstract-download-button,\n    #mindmap-download-button,\n    .report-problem-dialog-button {\n        height: 20px;\n        line-height: 14px;\n        padding: 2px 0px;\n        width: 80px;\n        font-size: .5rem;\n    }\n    #copy-paste #report-first-step section div {\n        margin: 0 0 2.4px 4px;\n    }\n    #copy-paste #report-first-step section {\n        margin: 2px 4px 0px 2px;\n        font-size: 10px;\n    }\n    #copy-paste #report-second-step #second-step-text {\n        font-size: 12px;\n    }\n    #copy-paste #report-third-step footer {\n        margin-top: 5px;\n    }\n    #panda-last-step-img {\n        width: 50%;\n    }\n    .other-input {\n        width: 100%;\n        padding: 4px 8px;\n        margin: 5px 0px;\n        display: inline-block;\n        border: .25px solid #ccc;\n        border-radius: 4px;\n        box-sizing: border-box;\n        font-size: 10px;\n    }\n}\n.customSettingsBtn {\n    --max-height: 100vh;\n    --plyr-captions-text-color: #FFF;\n    --plyr-captions-background: #000;\n    --plyr-video-control-color: #FFFFFFFF;\n    --plyr-video-control-color-hover: #FFFFFFFF;\n    --plyr-menu-color: #4a5464;\n    --live-indicator-color: #fc2d2d;\n    -webkit-font-smoothing: antialiased;\n    direction: ltr;\n    white-space: nowrap;\n    box-sizing: inherit;\n    background: 0 0;\n    border: 0;\n    border-radius: 3px;\n    cursor: pointer;\n    flex-shrink: 0;\n    overflow: visible;\n    position: relative;\n    transition: all .3s ease;\n    font: inherit;\n    line-height: inherit;\n    touch-action: manipulation;\n    margin-top: 2px;\n    align-items: center;\n    color: var(--plyr-menu-color, #4a5464);\n    display: flex;\n    font-size: 13px !important;\n    padding-bottom: calc(calc(10px * .7)/ 1.5);\n    padding-left: calc(calc(10px * .7) * 1.5);\n    padding-top: calc(calc(10px * .7)/ 1.5);\n    user-select: none;\n    width: 100% !important;\n    padding-right: calc(calc(10px * .7) * 4);\n}\n\n.customSettingsBtn:hover {\ncolor: #fff;\n}\n.small-muted-icon {\n    width: 200px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin-left: 10px;\n    margin-top: 10px;\n    background-color: var(--plyr-color-main);\n    opacity: 0.8;\n    display: flex;\n    color: var(--plyr-video-control-color);\n    align-items: center;\n    border: 1px solid var(--plyr-video-control-color);\n    border-radius: 3px;\n}\nbutton.small-muted-icon:after {\n    display: block;\n    width: 99999px;\n    top: 0;\n    left: 0;\n    z-index: 999999;\n    height: 99999px;\n    position: absolute;\n    content: '';\n}\n.small-muted-icon svg {\n    width: 50px;\n    height: 50px;\n}\n.small-muted-icon span{\n    padding: 0 10px;\n    font-weight: bold;\n}\n\n.blur {\n    visibility: visible;\n    position: absolute;\n    top: 0;\n    z-index: -1;\n    filter: blur(4px);\n    -webkit-filter: blur(4px);\n}\n\nbutton.panda-muted-indicator {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 80%;\n    max-width: 400px;\n    height: auto;\n    border-radius: 10px;\n    background-color: var(--muted-indicator-background);\n    border: var(--muted-indicator-border-size) solid var(--muted-indicator-text);\n    padding: 0.5em;\n    text-align: center;\n    transform: translate(-50%, -50%);\n    z-index: 9999999;\n    outline: none;\n    cursor: pointer;\n}\nbutton.panda-muted-indicator:after {\n    content: '';\n    position: absolute;\n    display: block;\n    width: 99999px;\n    height: 99999px;\n}\nbutton.panda-muted-indicator span {\n    display: block;\n    width: 100%;\n    padding: 0.5em 0;\n    box-sizing: border-box;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 24px;\n    font-weight: 700;\n    text-align: center;\n    color: var(--muted-indicator-text);\n    white-space: normal;\n    line-height: 1.1em;\n}\nbutton.panda-muted-indicator-big-text span {\n    font-size: 22px;\n}\nbutton.panda-muted-indicator svg {\n    width: 36%;\n    height: auto;\n}\nbutton.panda-muted-indicator svg,\nbutton.panda-muted-indicator svg path,\nbutton.panda-muted-indicator svg polygon {\n    fill: var(--muted-indicator-text);\n}\nbutton.panda-muted-indicator.medium {\n    transform: translate(-50%, -50%) scale(1.35);\n    transform-origin: center;\n}\nbutton.panda-muted-indicator.large {\n    width: 100%;\n    max-width: 100%;\n    height: 100%;\n    border-radius: 0;\n}\nbutton.panda-muted-indicator.large svg {\n    width: 24%;\n}\nbutton.panda-muted-indicator.large span {\n    font-size: 250%;\n}\n@media(max-width: 680px) {\n    button.panda-muted-indicator svg {\n        width: 30%;\n    }\n    button.panda-muted-indicator span,\n    button.panda-muted-indicator.large span {\n        font-size: 20px;\n    }\n    button.panda-muted-indicator-big-text span,\n    button.panda-muted-indicator-big-text.large span {\n        font-size: 16px;\n        line-height: 1em;\n    }\n}\n@media(max-width: 380px) {\n    button.panda-muted-indicator svg {\n        width: 25%;\n    }\n    button.panda-muted-indicator span,\n    button.panda-muted-indicator.large span {\n        font-size: 16px;\n        line-height: 1em;\n    }\n    button.panda-muted-indicator-big-text span,\n    button.panda-muted-indicator-big-text.large span {\n        font-size: 12px;\n        line-height: 1em;\n    }\n}\n\nbutton.panda-muted-indicator-impact-wrapper {\n    --size-width: 80%;\n    --size-height: 218px;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    z-index: 9999999;\n    display: flex;\n    width: 100%;\n    height: 100%;\n    padding: 0;\n    border: none;\n    background: rgba(0, 0, 0, 0);\t\t\t\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    outline: none;\n    cursor: pointer;\n    overflow: hidden;\n}\nbutton.panda-muted-indicator-impact-wrapper:after {\n    content: '';\n    position: absolute;\n    display: block;\n    width: 100%;\n    height: 100%;\n}\nbutton.panda-muted-indicator-impact-wrapper .text {\n    position: absolute;\n    display: block;\n    width: calc(80% - 0.5em);\n    max-width: calc(400px - 0.5em);\n    padding: 0.5em 0;\n    box-sizing: border-box;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 24px;\n    font-weight: 700;\n    text-align: center;\n    color: var(--muted-indicator-text);\n    white-space: normal;\n    line-height: 1.1em;\n}\nbutton.panda-muted-indicator-impact-wrapper-big-text .text {\n    font-size: 22px;\n}\nbutton.panda-muted-indicator-item .text.small-text {\n    padding: 0.7em 0;\n}\nbutton.panda-muted-indicator-item .text.large-text {\n    padding: 0;\n}\nbutton.panda-muted-indicator-item span.small-text {\n    padding: 10px 0;\n}\nbutton.panda-muted-indicator-item span.large-text {\n    padding: 8px 0;\n}\nbutton.panda-muted-indicator-impact-wrapper .text.top,\nbutton.panda-muted-indicator-impact-wrapper-big-text .text.top {\n    top: calc((50% - var(--size-height) / 2) + 0.5em - var(--muted-indicator-border-size));\n}\nbutton.panda-muted-indicator-impact-wrapper .text.bottom,\nbutton.panda-muted-indicator-impact-wrapper-big-text .text.bottom {\n    bottom: calc((50% - var(--size-height) / 2) + 0.5em - var(--muted-indicator-border-size));\n}\nbutton.panda-muted-indicator-impact-wrapper .panda-muted-indicator-impact-wrapper-canvas {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    z-index: -1;\n    width: 80%;\n    max-width: 400px;\n    height: var(--size-height);\n    background-color: var(--muted-indicator-background);\n    border-radius: 10px;\n    box-sizing: border-box;\n    border: var(--muted-indicator-border-size) solid var(--muted-indicator-text);\n    transform: translate(-50%, -50%);\n    transform-origin: center;\n}\nbutton.panda-muted-indicator-impact-wrapper svg {\n    position: absolute;\n    width:var(--size-width);\n    max-width: 400px;\n}\nbutton.panda-muted-indicator-impact-wrapper.medium {\n    transform: scale(1.35);\n}\nbutton.panda-muted-indicator-impact-wrapper.large .panda-muted-indicator-impact-wrapper-canvas {\n    --size-width: 100%;\n    --size-height: 100%;\n    width: 100%;\n    max-width: 100%;\n    border-radius: 0;\n}\nbutton.panda-muted-indicator-impact-wrapper.large {\n    --size-width: 65%;\n}\nbutton.panda-muted-indicator-impact-wrapper.large svg {\n    max-width: 500px;\n}\nbutton.panda-muted-indicator-impact-wrapper.large .text {\n    font-size: 225%;\n    width: 90%;\n}\nbutton.panda-muted-indicator-impact-wrapper.large .text.top {\n    top: calc((var(--size-width) / 3) - 0.5em);\n}\nbutton.panda-muted-indicator-impact-wrapper.large .text.bottom {\n    bottom: calc((var(--size-width) / 3) - 0.5em);\n}\n@media(max-width: 680px) {\n    button.panda-muted-indicator-impact-wrapper {\n        --size-height: 185px;\n    }\n    button.panda-muted-indicator-impact-wrapper svg {\n        --size-width: 65%;\n    }\n    button.panda-muted-indicator-impact-wrapper.medium {\n        transform: scale(1.15);\n    }\n    button.panda-muted-indicator-impact-wrapper .text,\n    button.panda-muted-indicator-impact-wrapper.large .text {\n        font-size: 20px;\n    }\n    button.panda-muted-indicator-impact-wrapper-big-text .text,\n    button.panda-muted-indicator-impact-wrapper-big-text.large .text {\n        font-size: 16px;\n        line-height: 1em;\n    }\n}\n@media(max-width: 380px) {\n    button.panda-muted-indicator-impact-wrapper {\n        --size-height: 140px;\n    }\n    button.panda-muted-indicator-impact-wrapper svg {\n        --size-width: 52.5%;\n    }\n    button.panda-muted-indicator-impact-wrapper.medium {\n        transform: initial;\n    }\n    button.panda-muted-indicator-impact-wrapper .text,\n    button.panda-muted-indicator-impact-wrapper.large .text {\n        font-size: 16px;\n        line-height: 1em;\n    }\n    button.panda-muted-indicator-impact-wrapper-big-text .text,\n    button.panda-muted-indicator-impact-wrapper-big-text.large .text {\n        font-size: 12px;\n        line-height: 1em;\n    }\n}\n.panda-muted-indicator-custom{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: none;\n    z-index: 999;\n    outline: 0;\n}\n#trial-warning{\n    position: absolute;\n    bottom: 50px;\n    right: 30px;\n    color: white;\n    text-align: center;\n    background: rgba(0,0,0,0.5);\n    opacity: 0.7;\n    font-size: 0.8rem;\n    padding: 5px 10px;\n}\n@media(max-width: 680px) {\n    #trial-warning{\n        font-size: 0.7rem;\n    }\n}\n@media(max-width: 380px) {\n    #trial-warning{\n        font-size: 0.5rem;\n    }\n}\n\n.plyr__controls .plyr__controls__item:first-child {\n    margin-right: 0;\n}\n\n\n.thumbnail-blur {\n    position: absolute;\n    top: -5px;\n    left: -5px;\n    width: 100%;\n    height: 100%;\n    filter: blur(10px);\n    transform: scale(1.1);\n    -webkit-filter: blur(5px);\n    -webkit-backdrop-filter:blur(5px);\n    backdrop-filter:blur(5px);\n    transition: filter .1s;\n    z-index: 1;\n}\n\n.panda-live-chat {\n    position: relative;\n}\n\n.panda-live-chat.new-message-badge::before{\n    position: absolute;\n    content: '';\n    width: 8px;\n    height: 8px;\n    top: 5px;\n    right: 6px;\n    border-radius: 100%;\n    background-color: red;\n}\n\n.live-chat-container:not(.disabled) {\n    width: 100%;\n}",""]);const o=a},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&a[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},443:function(e,t,n){"object"==typeof navigator&&(e.exports=function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a={addCSS:!0,thumbWidth:15,watch:!0};function o(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}var l=function(e){return null!=e?e.constructor:null},c=function(e,t){return!!(e&&t&&e instanceof t)},d=function(e){return l(e)===String},u=function(e){return Array.isArray(e)},h=function(e){return c(e,NodeList)},p=d,f=u,m=h,g=function(e){return c(e,Element)},y=function(e){return c(e,Event)},v=function(e){return function(e){return null==e}(e)||(d(e)||u(e)||h(e))&&!e.length||function(e){return l(e)===Object}(e)&&!Object.keys(e).length};var b=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),g(t)?this.element=t:p(t)&&(this.element=document.querySelector(t)),g(this.element)&&v(this.element.rangeTouch)&&(this.config=s({},a,{},n),this.init())}return function(e,n,i){n&&t(e.prototype,n),i&&t(e,i)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,n=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[n](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!y(t))return null;var n,i=t.target,r=t.changedTouches[0],s=parseFloat(i.getAttribute("min"))||0,a=parseFloat(i.getAttribute("max"))||100,o=parseFloat(i.getAttribute("step"))||1,l=i.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(n=100/l.width*(r.clientX-l.left))?n=0:100<n&&(n=100),50>n?n-=(100-2*n)*c:50<n&&(n+=2*(n-50)*c),s+function(e,t){if(1>t){var n=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(n))}return Math.round(e/t)*t}(n/100*(a-s),o)}},{key:"set",value:function(t){e.enabled&&y(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var n=new Event(t,{bubbles:!0});e.dispatchEvent(n)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=null;if(v(t)||p(t)?i=Array.from(document.querySelectorAll(p(t)?t:'input[type="range"]')):g(t)?i=[t]:m(t)?i=Array.from(t):f(t)&&(i=t.filter(g)),v(i))return null;var r=s({},a,{},n);if(p(t)&&r.watch){var l=new MutationObserver((function(n){Array.from(n).forEach((function(n){Array.from(n.addedNodes).forEach((function(n){g(n)&&o(n,t)&&new e(n,r)}))}))}));l.observe(document.body,{childList:!0,subtree:!0})}return i.map((function(t){return new e(t,n)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();const _=e=>null!=e?e.constructor:null,T=(e,t)=>Boolean(e&&t&&e instanceof t),E=e=>null==e,w=e=>_(e)===Object,S=e=>_(e)===String,x=e=>"function"==typeof e,k=e=>Array.isArray(e),C=e=>T(e,NodeList),L=e=>E(e)||(S(e)||k(e)||C(e))&&!e.length||w(e)&&!Object.keys(e).length;var A=E,R=w,I=e=>_(e)===Number&&!Number.isNaN(e),D=S,P=e=>_(e)===Boolean,M=x,O=k,N=C,F=e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,B=e=>T(e,Event),U=e=>T(e,KeyboardEvent),$=e=>T(e,TextTrack)||!E(e)&&S(e.kind),G=e=>{if(T(e,window.URL))return!0;if(!S(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!L(new URL(t).hostname)}catch(e){return!1}},H=L;const z=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n=Object.keys(t).find((t=>void 0!==e.style[t]));return!!D(n)&&t[n]})();function q(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}const j={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function Y(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function V(e={},...t){if(!t.length)return e;const n=t.shift();return R(n)?(Object.keys(n).forEach((t=>{R(n[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),V(e[t],n[t])):Object.assign(e,{[t]:n[t]})})),V(e,...t)):e}function K(e,t){const n=e.length?e:[e];Array.from(n).reverse().forEach(((e,n)=>{const i=n>0?t.cloneNode(!0):t,r=e.parentNode,s=e.nextSibling;i.appendChild(e),s?r.insertBefore(i,s):r.appendChild(i)}))}function W(e,t){F(e)&&!H(t)&&Object.entries(t).filter((([,e])=>!A(e))).forEach((([t,n])=>e.setAttribute(t,n)))}function X(e,t,n){const i=document.createElement(e);return R(t)&&W(i,t),D(n)&&(i.innerText=n),i}function Z(e,t,n,i){F(t)&&t.appendChild(X(e,n,i))}function Q(e){N(e)||O(e)?Array.from(e).forEach(Q):F(e)&&F(e.parentNode)&&e.parentNode.removeChild(e)}function J(e){if(!F(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function ee(e,t){return F(t)&&F(t.parentNode)&&F(e)?(t.parentNode.replaceChild(e,t),e):null}function te(e,t){if(!D(e)||H(e))return{};const n={},i=V({},t);return e.split(",").forEach((e=>{const t=e.trim(),r=t.replace(".",""),s=t.replace(/[[\]]/g,"").split("="),[a]=s,o=s.length>1?s[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":D(i.class)?n.class=`${i.class} ${r}`:n.class=r;break;case"#":n.id=t.replace("#","");break;case"[":n[a]=o}})),V(i,n)}function ne(e,t){if(!F(e))return;let n=t;P(n)||(n=!e.hidden),e.hidden=n}function ie(e,t,n){if(N(e))return Array.from(e).map((e=>ie(e,t,n)));if(F(e)){let i="toggle";return void 0!==n&&(i=n?"add":"remove"),e.classList[i](t),e.classList.contains(t)}return!1}function re(e,t){return F(e)&&e.classList.contains(t)}function se(e,t){const{prototype:n}=Element;return(n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function ae(e){return this.elements.container.querySelectorAll(e)}function oe(e){return this.elements.container.querySelector(e)}function le(e=null,t=!1){F(e)&&(e.focus({preventScroll:!0}),t&&ie(e,this.config.classNames.tabFocus))}const ce={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},de={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t,n){const i=j.isIPhone&&n&&de.playsinline,r=de[e]||"html5"!==t;return{api:r,ui:r&&de.rangeInput&&("video"!==e||!j.isIPhone||i)}},pip:!(j.isIPhone||!M(X("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||X("video").disablePictureInPicture)),airplay:M(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(H(e))return!1;const[t]=e.split("/");let n=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(ce).includes(n)&&(n+=`; codecs="${ce[e]}"`);try{return Boolean(n&&this.media.canPlayType(n).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==z,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},ue=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function he(e,t,n,i=!1,r=!0,s=!1){if(!e||!("addEventListener"in e)||H(t)||!M(n))return;const a=t.split(" ");let o=s;ue&&(o={passive:r,capture:s}),a.forEach((t=>{this&&this.eventListeners&&i&&this.eventListeners.push({element:e,type:t,callback:n,options:o}),e[i?"addEventListener":"removeEventListener"](t,n,o)}))}function pe(e,t="",n,i=!0,r=!1){he.call(this,e,t,n,!0,i,r)}function fe(e,t="",n,i=!0,r=!1){he.call(this,e,t,n,!1,i,r)}function me(e,t="",n,i=!0,r=!1){const s=(...a)=>{fe(e,t,s,i,r),n.apply(this,a)};he.call(this,e,t,s,!0,i,r)}function ge(e,t="",n=!1,i={}){if(!F(e)||H(t))return;const r=new CustomEvent(t,{bubbles:n,detail:{...i,plyr:this}});e.dispatchEvent(r)}function ye(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:n,callback:i,options:r}=e;t.removeEventListener(n,i,r)})),this.eventListeners=[])}function ve(){return new Promise((e=>this.ready?setTimeout(e,0):pe.call(this,this.elements.container,"ready",e))).then((()=>{}))}function be(e){(e=>T(e,Promise)&&x(e.then))(e)&&e.then(null,(()=>{}))}function _e(e){return O(e)?e.filter(((t,n)=>e.indexOf(t)===n)):e}function Te(e,t){return O(e)&&e.length?e.reduce(((e,n)=>Math.abs(n-t)<Math.abs(e-t)?n:e)):null}function Ee(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const we=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,n])=>({...e,[t/n]:[t,n]})),{});function Se(e){return!!(O(e)||D(e)&&e.includes(":"))&&(O(e)?e:e.split(":")).map(Number).every(I)}function xe(e){if(!O(e)||!e.every(I))return null;const[t,n]=e,i=(e,t)=>0===t?e:i(t,e%t),r=i(t,n);return[t/r,n/r]}function ke(e){const t=e=>Se(e)?e.split(":").map(Number):null;let n=t(e);if(null===n&&(n=t(this.config.ratio)),null===n&&!H(this.embed)&&O(this.embed.ratio)&&({ratio:n}=this.embed),null===n&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;n=[e,t]}return xe(n)}function Ce(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,n=ke.call(this,e);if(!O(n))return{};const[i,r]=xe(n),s=100/i*r;if(Ee(`aspect-ratio: ${i}/${r}`)?t.style.aspectRatio=`${i}/${r}`:t.style.paddingBottom=`${s}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),n=(e-s)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${n}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:n}}function Le(e,t,n=.05){const i=e/t,r=Te(Object.keys(we),i);return Math.abs(r-i)<=n?we[r]:[e,t]}const Ae={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!H(t)||de.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:Ae.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,H(this.config.ratio)||Ce.call(e),Object.defineProperty(e.media,"quality",{get(){const t=Ae.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&M(e.config.quality.onChange))e.config.quality.onChange(t);else{const n=Ae.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!n)return;const{currentTime:i,paused:r,preload:s,readyState:a,playbackRate:o}=e.media;e.media.src=n.getAttribute("src"),("none"!==s||a)&&(e.once("loadedmetadata",(()=>{e.speed=o,e.currentTime=i,r||be(e.play())})),e.media.load())}ge.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(Q(Ae.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function Re(e,...t){return H(e)?e:e.toString().replace(/{(\d+)}/g,((e,n)=>t[n].toString()))}const Ie=(e="",t="",n="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),n.toString()),De=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));function Pe(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const Me={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Oe={get(e="",t={}){if(H(e)||H(t))return"";let n=Y(t.i18n,e);if(H(n))return Object.keys(Me).includes(e)?Me[e]:"";const i={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(i).forEach((([e,t])=>{n=Ie(n,e,t)})),n}};class Ne{constructor(t){e(this,"get",(e=>{if(!Ne.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(H(t))return null;const n=JSON.parse(t);return D(e)&&e.length?n[e]:n})),e(this,"set",(e=>{if(!Ne.supported||!this.enabled)return;if(!R(e))return;let t=this.get();H(t)&&(t={}),V(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch(e){}})),this.enabled=t.config.storage.enabled,this.key=t.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function Fe(e,t="text"){return new Promise(((n,i)=>{try{const i=new XMLHttpRequest;if(!("withCredentials"in i))return;i.addEventListener("load",(()=>{if("text"===t)try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}else n(i.response)})),i.addEventListener("error",(()=>{throw new Error(i.status)})),i.open("GET",e,!0),i.responseType=t,i.send()}catch(e){i(e)}}))}function Be(e,t){if(!D(e))return;const n=D(t);let i=!1;const r=()=>null!==document.getElementById(t),s=(e,t)=>{e.innerHTML=t,n&&r()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!r()){const r=Ne.supported,a=document.createElement("div");if(a.setAttribute("hidden",""),n&&a.setAttribute("id",t),r){const e=window.localStorage.getItem(`cache-${t}`);if(i=null!==e,i){const t=JSON.parse(e);s(a,t.content)}}Fe(e).then((e=>{if(!H(e)){if(r)try{window.localStorage.setItem(`cache-${t}`,JSON.stringify({content:e}))}catch(e){}s(a,e)}})).catch((()=>{}))}}const Ue=e=>Math.trunc(e/60/60%60,10);function $e(e=0,t=!1,n=!1){if(!I(e))return $e(void 0,t,n);const i=e=>`0${e}`.slice(-2);let r=Ue(e);const s=(a=e,Math.trunc(a/60%60,10));var a;const o=(e=>Math.trunc(e%60,10))(e);return r=t||r>0?`${r}:`:"",`${n&&e>0?"-":""}${r}${i(s)}:${i(o)}`}const Ge={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,n=e.host!==t||j.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:n}},findElements(){try{return this.elements.controls=oe.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:ae.call(this,this.config.selectors.buttons.play),pause:oe.call(this,this.config.selectors.buttons.pause),restart:oe.call(this,this.config.selectors.buttons.restart),rewind:oe.call(this,this.config.selectors.buttons.rewind),fastForward:oe.call(this,this.config.selectors.buttons.fastForward),mute:oe.call(this,this.config.selectors.buttons.mute),pip:oe.call(this,this.config.selectors.buttons.pip),airplay:oe.call(this,this.config.selectors.buttons.airplay),settings:oe.call(this,this.config.selectors.buttons.settings),captions:oe.call(this,this.config.selectors.buttons.captions),fullscreen:oe.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=oe.call(this,this.config.selectors.progress),this.elements.inputs={seek:oe.call(this,this.config.selectors.inputs.seek),volume:oe.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:oe.call(this,this.config.selectors.display.buffer),currentTime:oe.call(this,this.config.selectors.display.currentTime),duration:oe.call(this,this.config.selectors.display.duration)},F(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const n="http://www.w3.org/2000/svg",i=Ge.getIconUrl.call(this),r=`${i.cors?"":i.url}#${this.config.iconPrefix}`,s=document.createElementNS(n,"svg");W(s,V(t,{"aria-hidden":"true",focusable:"false"}));const a=document.createElementNS(n,"use"),o=`${r}-${e}`;return"href"in a&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),s.appendChild(a),s},createLabel(e,t={}){const n=Oe.get(e,this.config);return X("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},n)},createBadge(e){if(H(e))return null;const t=X("span",{class:this.config.classNames.menu.value});return t.appendChild(X("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const n=V({},t);let i=function(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=Ie(t,"-"," "),t=Ie(t,"_"," "),t=De(t),Ie(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}(e);const r={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(n).includes(e)&&(r[e]=n[e],delete n[e])})),"button"!==r.element||Object.keys(n).includes("type")||(n.type="button"),Object.keys(n).includes("class")?n.class.split(" ").some((e=>e===this.config.classNames.control))||V(n,{class:`${n.class} ${this.config.classNames.control}`}):n.class=this.config.classNames.control,e){case"play":r.toggle=!0,r.label="play",r.labelPressed="pause",r.icon="play",r.iconPressed="pause";break;case"mute":r.toggle=!0,r.label="mute",r.labelPressed="unmute",r.icon="volume",r.iconPressed="muted";break;case"captions":r.toggle=!0,r.label="enableCaptions",r.labelPressed="disableCaptions",r.icon="captions-off",r.iconPressed="captions-on";break;case"fullscreen":r.toggle=!0,r.label="enterFullscreen",r.labelPressed="exitFullscreen",r.icon="enter-fullscreen",r.iconPressed="exit-fullscreen";break;case"play-large":n.class+=` ${this.config.classNames.control}--overlaid`,i="play",r.label="play",r.icon="play";break;default:H(r.label)&&(r.label=i),H(r.icon)&&(r.icon=e)}const s=X(r.element);return r.toggle?(s.appendChild(Ge.createIcon.call(this,r.iconPressed,{class:"icon--pressed"})),s.appendChild(Ge.createIcon.call(this,r.icon,{class:"icon--not-pressed"})),s.appendChild(Ge.createLabel.call(this,r.labelPressed,{class:"label--pressed"})),s.appendChild(Ge.createLabel.call(this,r.label,{class:"label--not-pressed"}))):(s.appendChild(Ge.createIcon.call(this,r.icon)),s.appendChild(Ge.createLabel.call(this,r.label))),V(n,te(this.config.selectors.buttons[i],n)),W(s,n),"play"===i?(O(this.elements.buttons[i])||(this.elements.buttons[i]=[]),this.elements.buttons[i].push(s)):this.elements.buttons[i]=s,s},createRange(e,t){const n=X("input",V(te(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Oe.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=n,Ge.updateRangeFill.call(this,n),b.setup(n),n},createProgress(e,t){const n=X("progress",V(te(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){n.appendChild(X("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],i=t?Oe.get(t,this.config):"";n.innerText=`% ${i.toLowerCase()}`}return this.elements.display[e]=n,n},createTime(e,t){const n=te(this.config.selectors.display[e],t),i=X("div",V(n,{class:`${n.class?n.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":Oe.get(e,this.config)}),"00:00");return this.elements.display[e]=i,i},bindMenuItemShortcuts(e,t){pe.call(this,e,"keydown keyup",(n=>{if(!["Space","ArrowUp","ArrowDown","ArrowRight"].includes(n.key))return;if(n.preventDefault(),n.stopPropagation(),"keydown"===n.type)return;const i=se(e,'[role="menuitemradio"]');if(!i&&["Space","ArrowRight"].includes(n.key))Ge.showMenuPanel.call(this,t,!0);else{let t;"Space"!==n.key&&("ArrowDown"===n.key||i&&"ArrowRight"===n.key?(t=e.nextElementSibling,F(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,F(t)||(t=e.parentNode.lastElementChild)),le.call(this,t,!0))}}),!1),pe.call(this,e,"keyup",(e=>{"Return"===e.key&&Ge.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:n,title:i,badge:r=null,checked:s=!1}){const a=te(this.config.selectors.inputs[n]),o=X("button",V(a,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${a.class?a.class:""}`.trim(),"aria-checked":s,value:e})),l=X("span");l.innerHTML=i,F(r)&&l.appendChild(r),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get:()=>"true"===o.getAttribute("aria-checked"),set(e){e&&Array.from(o.parentNode.children).filter((e=>se(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),o.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(o,"click keyup",(t=>{if(!U(t)||"Space"===t.key){switch(t.preventDefault(),t.stopPropagation(),o.checked=!0,n){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}Ge.showMenuPanel.call(this,"home",U(t))}}),n,!1),Ge.bindMenuItemShortcuts.call(this,o,n),t.appendChild(o)},formatTime(e=0,t=!1){return I(e)?$e(e,Ue(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,n=!1){F(e)&&I(t)&&(e.innerText=Ge.formatTime(t,n))},updateVolume(){this.supported.ui&&(F(this.elements.inputs.volume)&&Ge.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),F(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){F(e)&&(e.value=t,Ge.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!B(e))return;let t=0;const n=(e,t)=>{const n=I(t)?t:0,i=F(e)?e:this.elements.display.buffer;if(F(i)){i.value=n;const e=i.getElementsByTagName("span")[0];F(e)&&(e.childNodes[0].nodeValue=n)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":i=this.currentTime,r=this.duration,t=0===i||0===r||Number.isNaN(i)||Number.isNaN(r)?0:(i/r*100).toFixed(2),"timeupdate"===e.type&&Ge.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":n(this.elements.display.buffer,100*this.buffered)}var i,r},updateRangeFill(e){const t=B(e)?e.target:e;if(F(t)&&"range"===t.getAttribute("type")){if(se(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=Ge.formatTime(this.currentTime),n=Ge.formatTime(this.duration),i=Oe.get("seekLabel",this.config);t.setAttribute("aria-valuetext",i.replace("{currentTime}",e).replace("{duration}",n))}else if(se(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);j.isWebkit&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,n;if(!this.config.tooltips.seek||!F(this.elements.inputs.seek)||!F(this.elements.display.seekTooltip)||0===this.duration)return;const i=this.elements.display.seekTooltip,r=`${this.config.classNames.tooltip}--visible`,s=e=>ie(i,r,e);if(this.touch)return void s(!1);let a=0;const o=this.elements.progress.getBoundingClientRect();if(B(e))a=100/o.width*(e.pageX-o.left);else{if(!re(i,r))return;a=parseFloat(i.style.left,10)}a<0?a=0:a>100&&(a=100);const l=this.duration/100*a;i.innerText=Ge.formatTime(l);const c=null===(t=this.config.markers)||void 0===t||null===(n=t.points)||void 0===n?void 0:n.find((({time:e})=>e===Math.round(l)));c&&i.insertAdjacentHTML("afterbegin",`${c.label}<br>`),i.style.left=`${a}%`,B(e)&&["mouseenter","mouseleave"].includes(e.type)&&s("mouseenter"===e.type)},timeUpdate(e){const t=!F(this.elements.display.duration)&&this.config.invertTime;Ge.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||Ge.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return ne(this.elements.display.currentTime,!0),void ne(this.elements.progress,!0);F(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=F(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&Ge.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&Ge.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&Ge.setMarkers.call(this),Ge.updateSeekTooltip.call(this)},toggleMenuButton(e,t){ne(this.elements.settings.buttons[e],!t)},updateSetting(e,t,n){const i=this.elements.settings.panels[e];let r=null,s=t;if("captions"===e)r=this.currentTrack;else{if(r=H(n)?this[e]:n,H(r)&&(r=this.config[e].default),!H(this.options[e])&&!this.options[e].includes(r))return void this.debug.warn(`Unsupported value of '${r}' for ${e}`);if(!this.config[e].options.includes(r))return void this.debug.warn(`Disabled value of '${r}' for ${e}`)}if(F(s)||(s=i&&i.querySelector('[role="menu"]')),!F(s))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=Ge.getLabel.call(this,e,r);const a=s&&s.querySelector(`[value="${r}"]`);F(a)&&(a.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?Oe.get("normal",this.config):`${t}&times;`;case"quality":if(I(t)){const e=Oe.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return De(t);case"captions":return qe.getLabel.call(this);default:return null}},setQualityMenu(e){if(!F(this.elements.settings.panels.quality))return;const t="quality",n=this.elements.settings.panels.quality.querySelector('[role="menu"]');O(e)&&(this.options.quality=_e(e).filter((e=>this.config.quality.options.includes(e))));const i=!H(this.options.quality)&&this.options.quality.length>1;if(Ge.toggleMenuButton.call(this,t,i),J(n),Ge.checkMenu.call(this),!i)return;const r=e=>{const t=Oe.get(`qualityBadge.${e}`,this.config);return t.length?Ge.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const n=this.config.quality.options;return n.indexOf(e)>n.indexOf(t)?1:-1})).forEach((e=>{Ge.createMenuItem.call(this,{value:e,list:n,type:t,title:Ge.getLabel.call(this,"quality",e),badge:r(e)})})),Ge.updateSetting.call(this,t,n)},setCaptionsMenu(){if(!F(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),n=qe.getTracks.call(this),i=Boolean(n.length);if(Ge.toggleMenuButton.call(this,e,i),J(t),Ge.checkMenu.call(this),!i)return;const r=n.map(((e,n)=>({value:n,checked:this.captions.toggled&&this.currentTrack===n,title:qe.getLabel.call(this,e),badge:e.language&&Ge.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));r.unshift({value:-1,checked:!this.captions.toggled,title:Oe.get("disabled",this.config),list:t,type:"language"}),r.forEach(Ge.createMenuItem.bind(this)),Ge.updateSetting.call(this,e,t)},setSpeedMenu(){if(!F(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const n=!H(this.options.speed)&&this.options.speed.length>1;Ge.toggleMenuButton.call(this,e,n),J(t),Ge.checkMenu.call(this),n&&(this.options.speed.forEach((n=>{Ge.createMenuItem.call(this,{value:n,list:t,type:e,title:Ge.getLabel.call(this,"speed",n)})})),Ge.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!H(e)&&Object.values(e).some((e=>!e.hidden));ne(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let n=e;F(n)||(n=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const i=n.querySelector('[role^="menuitem"]');le.call(this,i,t)},toggleMenu(e){const{popup:t}=this.elements.settings,n=this.elements.buttons.settings;if(!F(t)||!F(n))return;const{hidden:i}=t;let r=i;if(P(e))r=e;else if(U(e)&&"Escape"===e.key)r=!1;else if(B(e)){const i=M(e.composedPath)?e.composedPath()[0]:e.target,s=t.contains(i);if(s||!s&&e.target!==n&&r)return}n.setAttribute("aria-expanded",r),ne(t,!r),ie(this.elements.container,this.config.classNames.menu.open,r),r&&U(e)?Ge.focusFirstMenuItem.call(this,null,!0):r||i||le.call(this,n,U(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const n=t.scrollWidth,i=t.scrollHeight;return Q(t),{width:n,height:i}},showMenuPanel(e="",t=!1){const n=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!F(n))return;const i=n.parentNode,r=Array.from(i.children).find((e=>!e.hidden));if(de.transitions&&!de.reducedMotion){i.style.width=`${r.scrollWidth}px`,i.style.height=`${r.scrollHeight}px`;const e=Ge.getMenuSize.call(this,n),t=e=>{e.target===i&&["width","height"].includes(e.propertyName)&&(i.style.width="",i.style.height="",fe.call(this,i,z,t))};pe.call(this,i,z,t),i.style.width=`${e.width}px`,i.style.height=`${e.height}px`}ne(r,!0),ne(n,!1),Ge.focusFirstMenuItem.call(this,n,t)},setDownloadUrl(){const e=this.elements.buttons.download;F(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:n,createProgress:i,createRange:r,createTime:s,setQualityMenu:a,setSpeedMenu:o,showMenuPanel:l}=Ge;this.elements.controls=null,O(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(n.call(this,"play-large"));const c=X("div",te(this.config.selectors.controls.wrapper));this.elements.controls=c;const d={class:"plyr__controls__item"};return _e(O(this.config.controls)?this.config.controls:[]).forEach((a=>{if("restart"===a&&c.appendChild(n.call(this,"restart",d)),"rewind"===a&&c.appendChild(n.call(this,"rewind",d)),"play"===a&&c.appendChild(n.call(this,"play",d)),"fast-forward"===a&&c.appendChild(n.call(this,"fast-forward",d)),"progress"===a){const t=X("div",{class:`${d.class} plyr__progress__container`}),n=X("div",te(this.config.selectors.progress));if(n.appendChild(r.call(this,"seek",{id:`plyr-seek-${e.id}`})),n.appendChild(i.call(this,"buffer")),this.config.tooltips.seek){const e=X("span",{class:this.config.classNames.tooltip},"00:00");n.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=n,t.appendChild(this.elements.progress),c.appendChild(t)}if("current-time"===a&&c.appendChild(s.call(this,"currentTime",d)),"duration"===a&&c.appendChild(s.call(this,"duration",d)),"mute"===a||"volume"===a){let{volume:t}=this.elements;if(F(t)&&c.contains(t)||(t=X("div",V({},d,{class:`${d.class} plyr__volume`.trim()})),this.elements.volume=t,c.appendChild(t)),"mute"===a&&t.appendChild(n.call(this,"mute")),"volume"===a&&!j.isIos){const n={max:1,step:.05,value:this.config.volume};t.appendChild(r.call(this,"volume",V(n,{id:`plyr-volume-${e.id}`})))}}if("captions"===a&&c.appendChild(n.call(this,"captions",d)),"settings"===a&&!H(this.config.settings)){const i=X("div",V({},d,{class:`${d.class} plyr__menu`.trim(),hidden:""}));i.appendChild(n.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const r=X("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),s=X("div"),a=X("div",{id:`plyr-settings-${e.id}-home`}),o=X("div",{role:"menu"});a.appendChild(o),s.appendChild(a),this.elements.settings.panels.home=a,this.config.settings.forEach((n=>{const i=X("button",V(te(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,i,n),pe.call(this,i,"click",(()=>{l.call(this,n,!1)}));const r=X("span",null,Oe.get(n,this.config)),a=X("span",{class:this.config.classNames.menu.value});a.innerHTML=e[n],r.appendChild(a),i.appendChild(r),o.appendChild(i);const c=X("div",{id:`plyr-settings-${e.id}-${n}`,hidden:""}),d=X("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});d.appendChild(X("span",{"aria-hidden":!0},Oe.get(n,this.config))),d.appendChild(X("span",{class:this.config.classNames.hidden},Oe.get("menuBack",this.config))),pe.call(this,c,"keydown",(e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),pe.call(this,d,"click",(()=>{l.call(this,"home",!1)})),c.appendChild(d),c.appendChild(X("div",{role:"menu"})),s.appendChild(c),this.elements.settings.buttons[n]=i,this.elements.settings.panels[n]=c})),r.appendChild(s),i.appendChild(r),c.appendChild(i),this.elements.settings.popup=r,this.elements.settings.menu=i}if("pip"===a&&de.pip&&c.appendChild(n.call(this,"pip",d)),"airplay"===a&&de.airplay&&c.appendChild(n.call(this,"airplay",d)),"download"===a){const e=V({},d,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!G(t)&&this.isEmbed&&V(e,{icon:`logo-${this.provider}`,label:this.provider}),c.appendChild(n.call(this,"download",e))}"fullscreen"===a&&c.appendChild(n.call(this,"fullscreen",d))})),this.isHTML5&&a.call(this,Ae.getQualityOptions.call(this)),o.call(this),c},inject(){if(this.config.loadSprite){const e=Ge.getIconUrl.call(this);e.cors&&Be(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let n,i=!0;if(M(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),F(this.config.controls)||D(this.config.controls)?e=this.config.controls:(e=Ge.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:qe.getLabel.call(this)}),i=!1),i&&D(this.config.controls)&&(e=(e=>{let n=e;return Object.entries(t).forEach((([e,t])=>{n=Ie(n,`{${e}}`,t)})),n})(e)),D(this.config.selectors.controls.container)&&(n=document.querySelector(this.config.selectors.controls.container)),F(n)||(n=this.elements.container),n[F(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),F(this.elements.controls)||Ge.findElements.call(this),!H(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;e.setAttribute("aria-pressed","false"),Object.defineProperty(e,"pressed",{configurable:!0,enumerable:!0,get:()=>re(e,t),set(n=!1){ie(e,t,n),e.setAttribute("aria-pressed",n?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{O(t)||N(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(j.isEdge&&q(n),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,n=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,i=ae.call(this,n);Array.from(i).forEach((e=>{ie(e,this.config.classNames.hidden,!1),ie(e,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t;if(!this.duration||this.elements.markers)return;const n=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((({time:e})=>e>0&&e<this.duration));if(null==n||!n.length)return;const i=document.createDocumentFragment(),r=document.createDocumentFragment();let s=null;const a=`${this.config.classNames.tooltip}--visible`,o=e=>ie(s,a,e);n.forEach((e=>{const t=X("span",{class:this.config.classNames.marker},""),n=e.time/this.duration*100+"%";s&&(t.addEventListener("mouseenter",(()=>{e.label||(s.style.left=n,s.innerHTML=e.label,o(!0))})),t.addEventListener("mouseleave",(()=>{o(!1)}))),t.addEventListener("click",(()=>{this.currentTime=e.time})),t.style.left=n,r.appendChild(t)})),i.appendChild(r),this.config.tooltips.seek||(s=X("span",{class:this.config.classNames.tooltip},""),i.appendChild(s)),this.elements.markers={points:r,tip:s},this.elements.progress.appendChild(i)}};function He(e,t=!0){let n=e;if(t){const e=document.createElement("a");e.href=n,n=e.href}try{return new URL(n)}catch(e){return null}}function ze(e){const t=new URLSearchParams;return R(e)&&Object.entries(e).forEach((([e,n])=>{t.set(e,n)})),t}const qe={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!de.textTracks)return void(O(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ge.setCaptionsMenu.call(this));var e,t;if(F(this.elements.captions)||(this.elements.captions=X("div",te(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),e=this.elements.captions,t=this.elements.wrapper,F(e)&&F(t)&&t.parentNode.insertBefore(e,t.nextSibling)),j.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),n=He(t);null!==n&&n.hostname!==window.location.href.hostname&&["http:","https:"].includes(n.protocol)&&Fe(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{Q(e)}))}))}const n=_e((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let i=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===i&&([i]=n);let r=this.storage.get("captions");if(P(r)||({active:r}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:r,language:i,languages:n}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";pe.call(this,this.media.textTracks,e,qe.update.bind(this))}setTimeout(qe.update.bind(this),0)},update(){const e=qe.getTracks.call(this,!0),{active:t,language:n,meta:i,currentTrackNode:r}=this.captions,s=Boolean(e.find((e=>e.language===n)));this.isHTML5&&this.isVideo&&e.filter((e=>!i.get(e))).forEach((e=>{this.debug.log("Track added",e),i.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),pe.call(this,e,"cuechange",(()=>qe.updateCues.call(this)))})),(s&&this.language!==n||!e.includes(r))&&(qe.setLanguage.call(this,n),qe.toggle.call(this,t&&s)),this.elements&&ie(this.elements.container,this.config.classNames.captions.enabled,!H(e)),O(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ge.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:n}=this.captions,i=this.config.classNames.captions.active,r=A(e)?!n:e;if(r!==n){if(t||(this.captions.active=r,this.storage.set({captions:r})),!this.language&&r&&!t){const e=qe.getTracks.call(this),t=qe.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void qe.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=r),ie(this.elements.container,i,r),this.captions.toggled=r,Ge.updateSetting.call(this,"captions"),ge.call(this,this.media,r?"captionsenabled":"captionsdisabled")}setTimeout((()=>{r&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const n=qe.getTracks.call(this);if(-1!==e)if(I(e))if(e in n){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const i=n[e],{language:r}=i||{};this.captions.currentTrackNode=i,Ge.updateSetting.call(this,"captions"),t||(this.captions.language=r,this.storage.set({language:r})),this.isVimeo&&this.embed.enableTextTrack(r),ge.call(this,this.media,"languagechange")}qe.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&qe.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else qe.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!D(e))return void this.debug.warn("Invalid language argument",e);const n=e.toLowerCase();this.captions.language=n;const i=qe.getTracks.call(this),r=qe.findTrack.call(this,[n]);qe.set.call(this,i.indexOf(r),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const n=qe.getTracks.call(this),i=e=>Number((this.captions.meta.get(e)||{}).default),r=Array.from(n).sort(((e,t)=>i(t)-i(e)));let s;return e.every((e=>(s=r.find((t=>t.language===e)),!s))),s||(t?r[0]:void 0)},getCurrentTrack(){return qe.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!$(t)&&de.textTracks&&this.captions.toggled&&(t=qe.getCurrentTrack.call(this)),$(t)?H(t.label)?H(t.language)?Oe.get("enabled",this.config):e.language.toUpperCase():t.label:Oe.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!F(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!A(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=qe.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(Pe)}const n=t.map((e=>e.trim())).join("\n");if(n!==this.elements.captions.innerHTML){J(this.elements.captions);const e=X("span",te(this.config.selectors.caption));e.innerHTML=n,this.elements.captions.appendChild(e),ge.call(this,this.media,"cuechange")}}},je={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.3/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isIos:"plyr--is-ios",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},tabFocus:"plyr__tab-focus",previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Ye="picture-in-picture",Ve={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Ke="video",We=()=>{};class Xe{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):We}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):We}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):We}}class Ze{constructor(t){e(this,"onChange",(()=>{if(!this.enabled)return;const e=this.player.elements.buttons.fullscreen;F(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;ge.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),e(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",ie(this.target,this.player.config.classNames.fullscreen.fallback,e),j.isIos){let t=document.head.querySelector('meta[name="viewport"]');const n="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const i=D(t.content)&&t.content.includes(n);e?(this.cleanupViewport=!i,i||(t.content+=`,${n}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==n)).join(","))}this.onChange()})),e(this,"trapFocus",(e=>{if(j.isIos||!this.active||"Tab"!==e.key)return;const t=document.activeElement,n=ae.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[i]=n,r=n[n.length-1];t!==r||e.shiftKey?t===i&&e.shiftKey&&(r.focus(),e.preventDefault()):(i.focus(),e.preventDefault())})),e(this,"update",(()=>{if(this.enabled){let e;e=this.forceFallback?"Fallback (forced)":Ze.native?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");ie(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.enabled)})),e(this,"enter",(()=>{this.enabled&&(j.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Ze.native||this.forceFallback?this.toggleFallback(!0):this.prefix?H(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),e(this,"exit",(()=>{if(this.enabled)if(j.isIos&&this.player.config.fullscreen.iosNative)this.target.webkitExitFullscreen(),be(this.player.play());else if(!Ze.native||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!H(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),e(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=t,this.prefix=Ze.prefix,this.property=Ze.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===t.config.fullscreen.fallback,this.player.elements.fullscreen=t.config.fullscreen.container&&function(e,t){const{prototype:n}=Element;return(n.closest||function(){let e=this;do{if(se.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,t.config.fullscreen.container),pe.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),pe.call(this.player,this.player.elements.container,"dblclick",(e=>{F(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),pe.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get native(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get usingNative(){return Ze.native&&!this.forceFallback}static get prefix(){if(M(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!M(document[`${t}ExitFullscreen`])&&!M(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get enabled(){return(Ze.native||this.player.config.fullscreen.fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}get active(){if(!this.enabled)return!1;if(!Ze.native||this.forceFallback)return re(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return j.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen||this.player.elements.container}}function Qe(e,t=1){return new Promise(((n,i)=>{const r=new Image,s=()=>{delete r.onload,delete r.onerror,(r.naturalWidth>=t?n:i)(r)};Object.assign(r,{onload:s,onerror:s,src:e})}))}const Je={addStyleHook(){ie(this.elements.container,this.config.selectors.container.replace(".",""),!0),ie(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Je.toggleNativeControls.call(this,!0);F(this.elements.controls)||(Ge.inject.call(this),this.listeners.controls()),Je.toggleNativeControls.call(this),this.isHTML5&&qe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,Ge.updateVolume.call(this),Ge.timeUpdate.call(this),Ge.durationUpdate.call(this),Je.checkPlaying.call(this),ie(this.elements.container,this.config.classNames.pip.supported,de.pip&&this.isHTML5&&this.isVideo),ie(this.elements.container,this.config.classNames.airplay.supported,de.airplay&&this.isHTML5),ie(this.elements.container,this.config.classNames.isIos,j.isIos),ie(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{ge.call(this,this.media,"ready")}),0),Je.setTitle.call(this),this.poster&&Je.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&Ge.durationUpdate.call(this),this.config.mediaMetadata&&Ge.setMediaMetadata.call(this)},setTitle(){let e=Oe.get("play",this.config);if(D(this.config.title)&&!H(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=oe.call(this,"iframe");if(!F(e))return;const t=H(this.config.title)?"video":this.config.title,n=Oe.get("frameTitle",this.config);e.setAttribute("title",n.replace("{title}",t))}},togglePoster(e){ie(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),ve.call(this).then((()=>Qe(e))).catch((t=>{throw e===this.poster&&Je.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),Je.togglePoster.call(this,!0),e))))},checkPlaying(e){ie(this.elements.container,this.config.classNames.playing,this.playing),ie(this.elements.container,this.config.classNames.paused,this.paused),ie(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",Oe.get(this.playing?"pause":"play",this.config))})),B(e)&&"timeupdate"===e.type||Je.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{ie(this.elements.container,this.config.classNames.loading,this.loading),Je.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const n=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||n))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!H(e)&&D(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),H(this.media.style)&&this.media.removeAttribute("style")}};class et{constructor(t){e(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,ie(t.container,e.config.classNames.isTouch,!0)})),e(this,"setTabFocus",(e=>{const{player:t}=this,{elements:n}=t,{key:i,type:r,timeStamp:s}=e;if(clearTimeout(this.focusTimer),"keydown"===r&&"Tab"!==i)return;"keydown"===r&&(this.lastKeyDown=s);const a=s-this.lastKeyDown<=20;("focus"!==r||a)&&((()=>{const e=t.config.classNames.tabFocus;ie(ae.call(t,`.${e}`),e,!1)})(),"focusout"!==r&&(this.focusTimer=setTimeout((()=>{const e=document.activeElement;n.container.contains(e)&&ie(document.activeElement,t.config.classNames.tabFocus,!0)}),10)))})),e(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&he.call(t,window,"keydown keyup",this.handleKey,e,!1),he.call(t,document.body,"click",this.toggleMenu,e),me.call(t,document.body,"touchstart",this.firstTouch),he.call(t,document.body,"keydown focus blur focusout",this.setTabFocus,e,!1,!0)})),e(this,"container",(()=>{const{player:e}=this,{config:t,elements:n,timers:i}=e;!t.keyboard.global&&t.keyboard.focused&&pe.call(e,n.container,"keydown keyup",this.handleKey,!1),pe.call(e,n.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:r}=n;r&&"enterfullscreen"===t.type&&(r.pressed=!1,r.hover=!1);let s=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(Je.toggleControls.call(e,!0),s=e.touch?3e3:2e3),clearTimeout(i.controls),i.controls=setTimeout((()=>Je.toggleControls.call(e,!1)),s)}));const r=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=n.wrapper,{active:i}=e.fullscreen,[r,s]=ke.call(e),a=Ee(`aspect-ratio: ${r} / ${s}`);if(!i)return void(a?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[o,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],c=o/l>r/s;a?(t.style.width=c?"auto":"100%",t.style.height=c?"100%":"auto"):(t.style.maxWidth=c?l/s*r+"px":null,t.style.margin=c?"0 auto":null)},s=()=>{clearTimeout(i.resized),i.resized=setTimeout(r,50)};pe.call(e,n.container,"enterfullscreen exitfullscreen",(t=>{const{target:i}=e.fullscreen;i===n.container&&(!e.isEmbed&&H(e.config.ratio)||(r(),("enterfullscreen"===t.type?pe:fe).call(e,window,"resize",s)))}))})),e(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(pe.call(e,e.media,"timeupdate seeking seeked",(t=>Ge.timeUpdate.call(e,t))),pe.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>Ge.durationUpdate.call(e,t))),pe.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),pe.call(e,e.media,"progress playing seeking seeked",(t=>Ge.updateProgress.call(e,t))),pe.call(e,e.media,"volumechange",(t=>Ge.updateVolume.call(e,t))),pe.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>Je.checkPlaying.call(e,t))),pe.call(e,e.media,"waiting canplay seeked playing",(t=>Je.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const n=oe.call(e,`.${e.config.classNames.video}`);if(!F(n))return;pe.call(e,t.container,"click",(i=>{([t.container,n].includes(i.target)||n.contains(i.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(i,e.restart,"restart"),this.proxy(i,(()=>{be(e.play())}),"play")):this.proxy(i,(()=>{be(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&pe.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),pe.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),pe.call(e,e.media,"ratechange",(()=>{Ge.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),pe.call(e,e.media,"qualitychange",(t=>{Ge.updateSetting.call(e,"quality",null,t.detail.quality)})),pe.call(e,e.media,"ready qualitychange",(()=>{Ge.setDownloadUrl.call(e)}));const n=e.config.events.concat(["keyup","keydown"]).join(" ");pe.call(e,e.media,n,(n=>{let{detail:i={}}=n;"error"===n.type&&(i=e.media.error),ge.call(e,t.container,n.type,!0,i)}))})),e(this,"proxy",((e,t,n)=>{const{player:i}=this,r=i.config.listeners[n];let s=!0;M(r)&&(s=r.call(i,e)),!1!==s&&M(t)&&t.call(i,e)})),e(this,"bind",((e,t,n,i,r=!0)=>{const{player:s}=this,a=s.config.listeners[i],o=M(a);pe.call(s,e,t,(e=>this.proxy(e,n,i)),r&&!o)})),e(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,n=j.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{be(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{ge.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),Ge.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{["Space","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),Ge.toggleMenu.call(e,t)):Ge.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{"Escape"===t.key&&Ge.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const n=t.progress.getBoundingClientRect(),i=100/n.width*(e.pageX-n.left);e.currentTarget.setAttribute("seek-value",i)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const n=t.currentTarget,i="play-on-seeked";if(U(t)&&!["ArrowLeft","ArrowRight"].includes(t.key))return;e.lastSeekTime=Date.now();const r=n.hasAttribute(i),s=["mouseup","touchend","keyup"].includes(t.type);r&&s?(n.removeAttribute(i),be(e.play())):!s&&e.playing&&(n.setAttribute(i,""),e.pause())})),j.isIos){const t=ae.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,n,(e=>q(e.target)))))}this.bind(t.inputs.seek,n,(t=>{const n=t.currentTarget;let i=n.getAttribute("seek-value");H(i)&&(i=n.value),n.removeAttribute("seek-value"),e.currentTime=i/n.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>Ge.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:n}=e;n&&n.loaded&&n.endScrubbing(t)})),j.isWebkit&&Array.from(ae.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>Ge.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!F(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,Ge.timeUpdate.call(e))})),this.bind(t.inputs.volume,n,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(n=>{t.controls.hover=!e.touch&&"mouseenter"===n.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((n=>{this.bind(n,"mouseenter mouseleave",(n=>{t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===n.type)}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:n,timers:i}=e;ie(t.controls,n.classNames.noTransition,!0),Je.toggleControls.call(e,!0),setTimeout((()=>{ie(t.controls,n.classNames.noTransition,!1)}),0);const r=this.touch?3e3:4e3;clearTimeout(i.controls),i.controls=setTimeout((()=>Je.toggleControls.call(e,!1)),r)})),this.bind(t.inputs.volume,"wheel",(t=>{const n=t.webkitDirectionInvertedFromDevice,[i,r]=[t.deltaX,-t.deltaY].map((e=>n?-e:e)),s=Math.sign(Math.abs(i)>Math.abs(r)?i:r);e.increaseVolume(s/50);const{volume:a}=e.media;(1===s&&a<1||-1===s&&a>0)&&t.preventDefault()}),"volume",!1)})),this.player=t,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.setTabFocus=this.setTabFocus.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:n}=t,{key:i,type:r,altKey:s,ctrlKey:a,metaKey:o,shiftKey:l}=e,c="keydown"===r,d=c&&i===this.lastKey;var u;if(!(s||a||o||l)&&i)if(c){const r=document.activeElement;if(F(r)){const{editable:i}=t.config.selectors,{seek:s}=n.inputs;if(r!==s&&se(r,i))return;if("Space"===e.key&&se(r,'button, [role^="menuitem"]'))return}switch(["Space","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(i)&&(e.preventDefault(),e.stopPropagation()),i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d||(u=parseInt(i,10),t.currentTime=t.duration/10*u);break;case"Space":case"k":d||be(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":d||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":d||t.toggleCaptions();break;case"l":t.loop=!t.loop}"Escape"===i&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=i}else this.lastKey=null}toggleMenu(e){Ge.toggleMenu.call(this.player,e)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var tt=function(e,t){return function(e,t){e.exports=function(){var e=function(){},t={},n={},i={};function r(e,t){e=e.push?e:[e];var r,s,a,o=[],l=e.length,c=l;for(r=function(e,n){n.length&&o.push(e),--c||t(o)};l--;)s=e[l],(a=n[s])?r(s,a):(i[s]=i[s]||[]).push(r)}function s(e,t){if(e){var r=i[e];if(n[e]=t,r)for(;r.length;)r[0](e,t),r.splice(0,1)}}function a(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function o(t,n,i,r){var s,a,l=document,c=i.async,d=(i.numRetries||0)+1,u=i.before||e,h=t.replace(/[\?|#].*$/,""),p=t.replace(/^(css|img)!/,"");r=r||0,/(^css!|\.css$)/.test(h)?((a=l.createElement("link")).rel="stylesheet",a.href=p,(s="hideFocus"in a)&&a.relList&&(s=0,a.rel="preload",a.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(a=l.createElement("img")).src=p:((a=l.createElement("script")).src=t,a.async=void 0===c||c),a.onload=a.onerror=a.onbeforeload=function(e){var l=e.type[0];if(s)try{a.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((r+=1)<d)return o(t,n,i,r)}else if("preload"==a.rel&&"style"==a.as)return a.rel="stylesheet";n(t,l,e.defaultPrevented)},!1!==u(t,a)&&l.head.appendChild(a)}function l(e,t,n){var i,r,s=(e=e.push?e:[e]).length,a=s,l=[];for(i=function(e,n,i){if("e"==n&&l.push(e),"b"==n){if(!i)return;l.push(e)}--s||t(l)},r=0;r<a;r++)o(e[r],i,n)}function c(e,n,i){var r,o;if(n&&n.trim&&(r=n),o=(r?i:n)||{},r){if(r in t)throw"LoadJS";t[r]=!0}function c(t,n){l(e,(function(e){a(o,e),t&&a({success:t,error:n},e),s(r,e)}),o)}if(o.returnPromise)return new Promise(c);c()}return c.ready=function(e,t){return r(e,(function(e){a(t,e)})),c},c.done=function(e){s(e,[])},c.reset=function(){t={},n={},i={}},c.isDefined=function(e){return e in t},c}()}(t={exports:{}}),t.exports}();function nt(e){return new Promise(((t,n)=>{tt(e,{success:t,error:n})}))}function it(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ge.call(this,this.media,e?"play":"pause"))}const rt={setup(){const e=this;ie(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,Ce.call(e),R(window.Vimeo)?rt.ready.call(e):nt(e.config.urls.vimeo.sdk).then((()=>{rt.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)}))},ready(){const e=this,t=e.config.vimeo,{premium:n,referrerPolicy:i,...r}=t;let s=e.media.getAttribute("src"),a="";H(s)?(s=e.media.getAttribute(e.config.attributes.embed.id),a=e.media.getAttribute(e.config.attributes.embed.hash)):a=function(e){const t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(s);const o=a?{h:a}:{};n&&Object.assign(r,{controls:!1,sidedock:!1});const l=ze({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:!this.config.fullscreen.iosNative,...o,...r}),c=H(d=s)?null:I(Number(d))?d:d.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:d;var d;const u=X("iframe"),h=Re(e.config.urls.vimeo.iframe,c,l);if(u.setAttribute("src",h),u.setAttribute("allowfullscreen",""),u.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),H(i)||u.setAttribute("referrerPolicy",i),n||!t.customControls)u.setAttribute("data-poster",e.poster),e.media=ee(u,e.media);else{const t=X("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(u),e.media=ee(t,e.media)}t.customControls||Fe(Re(e.config.urls.vimeo.api,h)).then((t=>{!H(t)&&t.thumbnail_url&&Je.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(u,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(it.call(e,!0),e.embed.play()),e.media.pause=()=>(it.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:p}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>p,set(t){const{embed:n,media:i,paused:r,volume:s}=e,a=r&&!n.hasPlayed;i.seeking=!0,ge.call(e,i,"seeking"),Promise.resolve(a&&n.setVolume(0)).then((()=>n.setCurrentTime(t))).then((()=>a&&n.pause())).then((()=>a&&n.setVolume(s))).catch((()=>{}))}});let f=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>f,set(t){e.embed.setPlaybackRate(t).then((()=>{f=t,ge.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:m}=e.config;Object.defineProperty(e.media,"volume",{get:()=>m,set(t){e.embed.setVolume(t).then((()=>{m=t,ge.call(e,e.media,"volumechange")}))}});let{muted:g}=e.config;Object.defineProperty(e.media,"muted",{get:()=>g,set(t){const n=!!P(t)&&t;e.embed.setVolume(n?0:e.config.volume).then((()=>{g=n,ge.call(e,e.media,"volumechange")}))}});let y,{loop:v}=e.config;Object.defineProperty(e.media,"loop",{get:()=>v,set(t){const n=P(t)?t:e.config.loop.active;e.embed.setLoop(n).then((()=>{v=n}))}}),e.embed.getVideoUrl().then((t=>{y=t,Ge.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>y}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[n,i]=t;e.embed.ratio=Le(n,i),Ce.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,Je.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{p=t,ge.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,ge.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,qe.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const n=t.map((e=>function(e){const t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}(e.text)));qe.updateCues.call(e,n)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{it.call(e,!t),t||ge.call(e,e.media,"playing")})),F(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{ge.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{ge.call(e,e.media,"playing")})),e.embed.on("play",(()=>{it.call(e,!0),ge.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{it.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,p=t.seconds,ge.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,ge.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&ge.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,ge.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,ge.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,ge.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,ge.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>Je.build.call(e)),0)}};function st(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,ge.call(this,this.media,e?"play":"pause"))}function at(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const ot={setup(){if(ie(this.elements.wrapper,this.config.classNames.embed,!0),R(window.YT)&&M(window.YT.Player))ot.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{M(e)&&e(),ot.ready.call(this)},nt(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){Fe(Re(this.config.urls.youtube.api,e)).then((e=>{if(R(e)){const{title:t,height:n,width:i}=e;this.config.title=t,Je.setTitle.call(this),this.embed.ratio=Le(i,n)}Ce.call(this)})).catch((()=>{Ce.call(this)}))},ready(){const e=this,t=e.config.youtube,n=e.media&&e.media.getAttribute("id");if(!H(n)&&n.startsWith("youtube-"))return;let i=e.media.getAttribute("src");H(i)&&(i=e.media.getAttribute(this.config.attributes.embed.id));const r=H(s=i)?null:s.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:s;var s;const a=X("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=ee(a,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${r}/${e}default.jpg`;Qe(t("maxres"),121).catch((()=>Qe(t("sd"),121))).catch((()=>Qe(t("hq")))).then((t=>Je.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:r,host:at(t),playerVars:V({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.fullscreen.iosNative?0:1,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const n=t.data,i={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[n]||"An unknown error occured";e.media.error={code:n,message:i},ge.call(e,e.media,"error")}},onPlaybackRateChange(t){const n=t.target;e.media.playbackRate=n.getPlaybackRate(),ge.call(e,e.media,"ratechange")},onReady(n){if(M(e.media.play))return;const i=n.target;ot.getTitle.call(e,r),e.media.play=()=>{st.call(e,!0),i.playVideo()},e.media.pause=()=>{st.call(e,!1),i.pauseVideo()},e.media.stop=()=>{i.stopVideo()},e.media.duration=i.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(i.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,ge.call(e,e.media,"seeking"),i.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>i.getPlaybackRate(),set(e){i.setPlaybackRate(e)}});let{volume:s}=e.config;Object.defineProperty(e.media,"volume",{get:()=>s,set(t){s=t,i.setVolume(100*s),ge.call(e,e.media,"volumechange")}});let{muted:a}=e.config;Object.defineProperty(e.media,"muted",{get:()=>a,set(t){const n=P(t)?t:a;a=n,i[n?"mute":"unMute"](),i.setVolume(100*s),ge.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>i.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const o=i.getAvailablePlaybackRates();e.options.speed=o.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),ge.call(e,e.media,"timeupdate"),ge.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=i.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&ge.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),ge.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>Je.build.call(e)),50)},onStateChange(n){const i=n.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(n.data)&&(e.media.seeking=!1,ge.call(e,e.media,"seeked")),n.data){case-1:ge.call(e,e.media,"timeupdate"),e.media.buffered=i.getVideoLoadedFraction(),ge.call(e,e.media,"progress");break;case 0:st.call(e,!1),e.media.loop?(i.stopVideo(),i.playVideo()):ge.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(st.call(e,!0),ge.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{ge.call(e,e.media,"timeupdate")}),50),e.media.duration!==i.getDuration()&&(e.media.duration=i.getDuration(),ge.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),st.call(e,!1);break;case 3:ge.call(e,e.media,"waiting")}ge.call(e,e.elements.container,"statechange",!1,{code:n.data})}}})}},lt={setup(){this.media?(ie(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),ie(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&ie(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=X("div",{class:this.config.classNames.video}),K(this.media,this.elements.wrapper),this.elements.poster=X("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?Ae.setup.call(this):this.isYouTube?ot.setup.call(this):this.isVimeo&&rt.setup.call(this)):this.debug.warn("No media element found!")}};class ct{constructor(t){e(this,"load",(()=>{this.enabled&&(R(window.google)&&R(window.google.ima)?this.ready():nt(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),e(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),e(this,"setupIMA",(()=>{this.elements.container=X("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),e(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),e(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=$e(Math.max(this.manager.getRemainingTime(),0)),t=`${Oe.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),e(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),e(this,"addCuePoints",(()=>{H(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(F(t)){const n=100/this.player.duration*e,i=X("span",{class:this.player.config.classNames.cues});i.style.left=`${n.toString()}%`,t.appendChild(i)}}}))})),e(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,n=e.getAd(),i=e.getAdData();switch((e=>{ge.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),n.isLinear()||(n.width=t.offsetWidth,n.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:i.adError&&this.player.debug.warn(`Non-fatal ad error: ${i.adError.getMessage()}`)}})),e(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),e(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;H(this.cuePoints)||this.cuePoints.forEach(((n,i)=>{t<n&&n<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(i,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),e(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),e(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,be(this.player.media.play())})),e(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),e(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),e(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),e(this,"trigger",((e,...t)=>{const n=this.events[e];O(n)&&n.forEach((e=>{M(e)&&e.apply(this,t)}))})),e(this,"on",((e,t)=>(O(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),e(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),e(this,"clearSafetyTimer",(e=>{A(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=t,this.config=t.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!H(e.publisherId)||G(e.tagUrl))}get tagUrl(){const{config:e}=this;return G(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${ze({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}function dt(e=0,t=0,n=255){return Math.min(Math.max(e,t),n)}const ut=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const n={};e.split(/\r\n|\n|\r/).forEach((e=>{if(I(n.startTime)){if(!H(e.trim())&&H(n.text)){const t=e.trim().split("#xywh=");[n.text]=t,t[1]&&([n.x,n.y,n.w,n.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(n.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),n.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),n.text&&t.push(n)})),t},ht=(e,t)=>{const n={};return e>t.width/t.height?(n.width=t.width,n.height=1/e*t.width):(n.height=t.height,n.width=e*t.height),n};class pt{constructor(t){e(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.loaded=!0)}))})),e(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(H(t))throw new Error("Missing previewThumbnails.src config attribute");const n=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(M(t))t((e=>{this.thumbnails=e,n()}));else{const e=(D(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(n)}})))),e(this,"getThumbnail",(e=>new Promise((t=>{Fe(e).then((n=>{const i={frames:ut(n),height:null,urlPrefix:""};i.frames[0].text.startsWith("/")||i.frames[0].text.startsWith("http://")||i.frames[0].text.startsWith("https://")||(i.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const r=new Image;r.onload=()=>{i.height=r.naturalHeight,i.width=r.naturalWidth,this.thumbnails.push(i),t()},r.src=i.urlPrefix+i.frames[0].text}))})))),e(this,"startMove",(e=>{if(this.loaded&&B(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var t,n;const i=this.player.elements.progress.getBoundingClientRect(),r=100/i.width*(e.pageX-i.left);this.seekTime=this.player.media.duration*(r/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=$e(this.seekTime);const s=null===(t=this.player.config.markers)||void 0===t||null===(n=t.points)||void 0===n?void 0:n.find((({time:e})=>e===Math.round(this.seekTime)));s&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${s.label}<br>`)}this.showImageAtCurrentTime()}})),e(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),e(this,"startScrubbing",(e=>{(A(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),e(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):me.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),e(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),e(this,"render",(()=>{this.elements.thumb.container=X("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=X("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=X("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=X("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),F(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=X("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),e(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),e(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let n=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,i)=>{this.loadedImages.includes(t.frames[e].text)&&(n=i)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(n)))})),e(this,"loadImage",((e=0)=>{const t=this.showingThumb,n=this.thumbnails[e],{urlPrefix:i}=n,r=n.frames[t],s=n.frames[t].text,a=i+s;if(this.currentImageElement&&this.currentImageElement.dataset.filename===s)this.showImage(this.currentImageElement,r,e,t,s,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const n=new Image;n.src=a,n.dataset.index=t,n.dataset.filename=s,this.showingThumbFilename=s,this.player.debug.log(`Loading image: ${a}`),n.onload=()=>this.showImage(n,r,e,t,s,!0),this.loadingImage=n,this.removeOldImages(n)}})),e(this,"showImage",((e,t,n,i,r,s=!0)=>{this.player.debug.log(`Showing thumb: ${r}. num: ${i}. qual: ${n}. newimg: ${s}`),this.setImageSizeAndOffset(e,t),s&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(r)||this.loadedImages.push(r)),this.preloadNearby(i,!0).then(this.preloadNearby(i,!1)).then(this.getHigherQuality(n,e,t,r))})),e(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const n=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),n)}}))})),e(this,"preloadNearby",((e,t=!0)=>new Promise((n=>{setTimeout((()=>{const i=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===i){let r;r=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let s=!1;r.forEach((e=>{const t=e.text;if(t!==i&&!this.loadedImages.includes(t)){s=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],i=e+t,r=new Image;r.src=i,r.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),n()}}})),s||n()}}),300)})))),e(this,"getHigherQuality",((e,t,n,i)=>{if(e<this.thumbnails.length-1){let r=t.naturalHeight;this.usingSprites&&(r=n.h),r<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===i&&(this.player.debug.log(`Showing higher quality thumb for: ${i}`),this.loadImage(e+1))}),300)}})),e(this,"toggleThumbContainer",((e=!1,t=!1)=>{const n=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(n,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),e(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),e(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()})),e(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:n}=this.elements.thumb,i=t.left-e.left+10,r=t.right-e.left-n.clientWidth-10,s=this.mousePosX-e.left-n.clientWidth/2,a=dt(s,i,r);n.style.left=`${a}px`,n.style.setProperty("--preview-arrow-offset",s-a+"px")})),e(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=ht(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),e(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const n=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*n+"px",e.style.width=e.naturalWidth*n+"px",e.style.left=`-${t.x*n}px`,e.style.top=`-${t.y*n}px`})),this.player=t,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=ht(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const ft={insertElements(e,t){D(t)?Z(e,this.media,{src:t}):O(t)&&t.forEach((t=>{Z(e,this.media,t)}))},change(e){Y(e,"sources.length")?(Ae.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],Q(this.media),this.media=null,F(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:n}=e,[{provider:i=Ve.html5,src:r}]=t,s="html5"===i?n:"div",a="html5"===i?{}:{src:r};Object.assign(this,{provider:i,type:n,supported:de.check(n,i,this.config.playsinline),media:X(s,a)}),this.elements.container.appendChild(this.media),P(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),H(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Je.addStyleHook.call(this),this.isHTML5&&ft.insertElements.call(this,"source",t),this.config.title=e.title,lt.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&ft.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Je.build.call(this),this.isHTML5&&this.media.load(),H(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new pt(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class mt{constructor(t,n){if(e(this,"play",(()=>M(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>be(this.media.play()))),this.media.play()):null)),e(this,"pause",(()=>this.playing&&M(this.media.pause)?this.media.pause():null)),e(this,"togglePlay",(e=>(P(e)?e:!this.playing)?this.play():this.pause())),e(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):M(this.media.stop)&&this.media.stop()})),e(this,"restart",(()=>{this.currentTime=0})),e(this,"rewind",(e=>{this.currentTime-=I(e)?e:this.config.seekTime})),e(this,"forward",(e=>{this.currentTime+=I(e)?e:this.config.seekTime})),e(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(I(e)?e:0)})),e(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),e(this,"airplay",(()=>{de.airplay&&this.media.webkitShowPlaybackTargetPicker()})),e(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=re(this.elements.container,this.config.classNames.hideControls),n=void 0===e?void 0:!e,i=ie(this.elements.container,this.config.classNames.hideControls,n);if(i&&O(this.config.controls)&&this.config.controls.includes("settings")&&!H(this.config.settings)&&Ge.toggleMenu.call(this,!1),i!==t){const e=i?"controlshidden":"controlsshown";ge.call(this,this.media,e)}return!i}return!1})),e(this,"on",((e,t)=>{pe.call(this,this.elements.container,e,t)})),e(this,"once",((e,t)=>{me.call(this,this.elements.container,e,t)})),e(this,"off",((e,t)=>{fe(this.elements.container,e,t)})),e(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const n=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(Q(this.elements.buttons.play),Q(this.elements.captions),Q(this.elements.controls),Q(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),M(e)&&e()):(ye.call(this),Ae.cancelRequests.call(this),ee(this.elements.original,this.elements.container),ge.call(this,this.elements.original,"destroyed",!0),M(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Je.toggleNativeControls.call(this,!0),n()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&M(this.embed.destroy)&&this.embed.destroy(),n()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(n),setTimeout(n,200))})),e(this,"supports",(e=>de.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=de.touch,this.media=t,D(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||N(this.media)||O(this.media))&&(this.media=this.media[0]),this.config=V({},je,mt.defaults,n||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Xe(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",de),A(this.media)||!F(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!de.check().api)return void this.debug.error("Setup failed: no support");const i=this.media.cloneNode(!0);i.autoplay=!1,this.elements.original=i;const r=this.media.tagName.toLowerCase();let s=null,a=null;switch(r){case"div":if(s=this.media.querySelector("iframe"),F(s)){if(a=He(s.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Ve.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Ve.vimeo:null}(a.toString()),this.elements.container=this.media,this.media=s,this.elements.container.className="",a.search.length){const e=["1","true"];e.includes(a.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(a.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(a.searchParams.get("playsinline")),this.config.youtube.hl=a.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(H(this.provider)||!Object.values(Ve).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Ke;break;case"video":case"audio":this.type=r,this.provider=Ve.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=de.check(this.type,this.provider,this.config.playsinline),this.supported.api?(this.eventListeners=[],this.listeners=new et(this),this.storage=new Ne(this),this.media.plyr=this,F(this.elements.container)||(this.elements.container=X("div",{tabindex:0}),K(this.media,this.elements.container)),Je.migrateStyles.call(this),Je.addStyleHook.call(this),lt.setup.call(this),this.config.debug&&pe.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new Ze(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Je.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new ct(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>be(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new pt(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Ve.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Ve.youtube}get isVimeo(){return this.provider===Ve.vimeo}get isVideo(){return this.type===Ke}get isAudio(){return"audio"===this.type}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=I(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return I(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,n=I(t)&&t!==1/0?t:0;return e||n}set volume(e){let t=e;D(t)&&(t=Number(t)),I(t)||(t=this.storage.get("volume")),I(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!H(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;P(t)||(t=this.storage.get("muted")),P(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;I(e)&&(t=e),I(t)||(t=this.storage.get("speed")),I(t)||(t=this.config.speed.selected);const{minimumSpeed:n,maximumSpeed:i}=this;t=dt(t,n,i),this.config.speed.selected=t,setTimeout((()=>{this.media&&(this.media.playbackRate=t)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,n=this.options.quality;if(!n.length)return;let i=[!H(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(I),r=!0;if(!n.includes(i)){const e=Te(n,i);this.debug.warn(`Unsupported quality option: ${i}, using ${e} instead`),i=e,r=!1}t.selected=i,this.media.quality=i,r&&this.storage.set({quality:i})}get quality(){return this.media.quality}set loop(e){const t=P(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){ft.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return G(e)?e:this.source}set download(e){G(e)&&(this.config.urls.download=e,Ge.setDownloadUrl.call(this))}set poster(e){this.isVideo?Je.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=xe(ke.call(this));return O(e)?e.join(":"):e}set ratio(e){this.isVideo?D(e)&&Se(e)?(this.config.ratio=xe(e),Ce.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){this.config.autoplay=P(e)?e:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){qe.toggle.call(this,e,!1)}set currentTrack(e){qe.set.call(this,e,!1),qe.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){qe.setLanguage.call(this,e,!1)}get language(){return(qe.getCurrentTrack.call(this)||{}).language}set pip(e){if(!de.pip)return;const t=P(e)?e:!this.pip;M(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?Ye:"inline"),M(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return de.pip?H(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Ye:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new pt(this))}static supported(e,t,n){return de.check(e,t,n)}static loadSprite(e,t){return Be(e,t)}static setup(e,t={}){let n=null;return D(e)?n=Array.from(document.querySelectorAll(e)):N(e)?n=Array.from(e):O(e)&&(n=e.filter(F)),H(n)?null:n.map((e=>new mt(e,t)))}}var gt;return mt.defaults=(gt=je,JSON.parse(JSON.stringify(gt))),mt}())},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var s={},a=[],o=0;o<e.length;o++){var l=e[o],c=i.base?l[0]+i.base:l[0],d=s[c]||0,u="".concat(c," ").concat(d);s[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=r(p,i);i.byIndex=o,t.splice(o,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var o=n(s[a]);t[o].references--}for(var l=i(e,r),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},500:(e,t,n)=>{var i={"./en.json":700,"./es.json":980,"./pt.json":193};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id=500},700:e=>{"use strict";e.exports=JSON.parse('{"restart":"Restart","rewind":"Rewind {seektime}s","play":"Play","pause":"Pause","fastForward":"Forward {seektime}s","seek":"Search","seekLabel":"{currentTime} of {duration}","played":"Played","buffered":"Buffered","currentTime":"Current time","duration":"Duration","volume":"Volume","mute":"No sound","unmute":"With sound","enableCaptions":"Enable Captions","disableCaptions":"Disable Captions","download":"Transfer","enterFullscreen":"Enter fullscreen mode","exitFullscreen":"Exit full screen mode","frameTitle":"Reader for {title}","captions":"Subtitles","settings":"Settings","pip":"PIP","menuBack":"Back to previous menu","speed":"Speed","normal":"Normal","quality":"Quality","loop":"Repeat","start":"Start","end":"End","all":"All","reset":"Reset","disabled":"Disabled","enabled":"Enabled","advertisement":"Advertisement","qualityBadge":{"480":"SD","576":"SD","720":"HD","1080":"HD","1440":"HD","2160":"4K"},"keepWatching":"Continue watching","reportModalTitle":"Report error","reportModalOption1":"Video does not load even with good internet connection","reportModalOption2":"The video content does not match the description","reportModalOption3":"Video is low quality or pixelated","reportModalOption4":"Other","reportModalField":"Describe your problem...","reportModalAction1":"Submit","reportModalAction2":"Cancel","reportModalText1":"Please wait a moment, your feedback","reportModalText2":"is being sent.","reportModalText3":"Thanks for helping us improve!","chapters":"Chapters","aboutPanda":"About Panda Video","aboutPandaLink":"https://pandavideo.com/","waitingForLive":"WAITING FOR LIVE STREAM","activateSound":"ACTIVATE SOUND","watermark_question":"Enter your access key","trialWarning":"Panda Video trial mode.<br>Start billing to remove this message.","mindmap":"Mind Map","questions":"Questions","abstract":"E-Book","cancel":"Cancel","reset_button":"reset","copy_button":"Copy","download_button":"Download","smart_search_placeholder":"Search in the caption","drmPreload":"Setting up video security","live_chat":{"removedMessage":"This message has been removed","you":"You","registerModal":{"title":"Join chat","actionBtn":"Join chat","namePlaceholder":"Name"}}}')},980:e=>{"use strict";e.exports=JSON.parse('{"restart":"Reiniciar","rewind":"Rebobinar {seektime}s","play":"Tocar","pause":"Pausa","fastForward":"Adelante {seektime}s","seek":"Buscar","seekLabel":"{currentTime} de {duration}","played":"Reproducido","buffered":"Buffered","currentTime":"Hora actual","duration":"Duración","volume":"Volumen","mute":"Sin sonido","unmute":"Con sonido","enableCaptions":"Habilitar subtítulos","disableCaptions":"Deshabilitar subtítulos","download":"Transferir","enterFullscreen":"Entrar en modo de pantalla completa","exitFullscreen":"Salir del modo de pantalla completa","frameTitle":"Lector de {title}","captions":"Subtítulos","settings":"Configuraciones","pip":"PIP","menuBack":"Volver al menú anterior","speed":"Velocidad","normal":"normal","quality":"Calidad","loop":"Repetir","start":"Inicio","end":"Fin","all":"Todos","reset":"Restablecer","disabled":"Deshabilitado","enabled":"Habilitado","advertisement":"Anuncio","qualityBadge":{"480":"SD","576":"SD","720":"HD","1080":"HD","1440":"HD","2160":"4K"},"keepWatching":"Continuar viendo","reportModalTitle":"Informe de error","reportModalOption1":"El video no se carga incluso con una buena conexión a Internet","reportModalOption2":"El contenido del video no coincide con la descripción","reportModalOption3":"El video es de baja calidad o está pixelado","reportModalOption4":"Otro","reportModalField":"Describe tu problema...","reportModalAction1":"Enviar","reportModalAction2":"Cancelar","reportModalText1":"Por favor, espere un momento, sus comentarios","reportModalText2":"se está enviando.","reportModalText3":"¡Gracias por ayudarnos a mejorar!","chapters":"Capítulos","aboutPanda":"Acerca del Panda Video","aboutPandaLink":"https://pandavideo.com/","waitingForLive":"ESPERANDO TRANSMISIÓN EN VIVO","activateSound":"ACTIVAR SONIDO","watermark_question":"Ingrese su clave de acceso","trialWarning":"Modo de prueba de video de Panda.<br>Comience la facturación para eliminar este mensaje.","mindmap":"Mapa Mental","questions":"Preguntas","abstract":"E-Book","cancel":"Cancelar","reset_button":"restablecer","copy_button":"Copiar","download_button":"Download","smart_search_placeholder":"Buscar en el subtítulo","drmPreload":"Preparando video seguridad","live_chat":{"removedMessage":"Este mensaje ha sido eliminado","you":"Tu","registerModal":{"title":"Participa en la charla","actionBtn":"Entrar al chat","namePlaceholder":"Nombre"}}}')},193:e=>{"use strict";e.exports=JSON.parse('{"restart":"Reiniciar","rewind":"Recuar {seektime}s","play":"Reproduzir","pause":"Pausar","fastForward":"Avançar {seektime}s","seek":"Procurar","seekLabel":"{currentTime} de {duration}","played":"Reproduzido","buffered":"Colocado na memória intermédia","currentTime":"Tempo atual","duration":"Duração","volume":"Volume","mute":"Sem som","unmute":"Com som","enableCaptions":"Ativar legendas","disableCaptions":"Desativar legendas","download":"Transferir","enterFullscreen":"Entrar no modo de ecrã inteiro","exitFullscreen":"Sair do modo de ecrã inteiro","frameTitle":"Leitor para {title}","captions":"Legendas","settings":"Definições","pip":"PIP","menuBack":"Voltar ao menu anterior","speed":"Velocidade","normal":"Normal","quality":"Qualidade","loop":"Repetir","start":"Início","end":"Fim","all":"Tudo","reset":"Repor","disabled":"Desativado","enabled":"Ativado","advertisement":"Anúncio","qualityBadge":{"480":"SD","576":"SD","720":"HD","1080":"HD","1440":"HD","2160":"4K"},"keepWatching":"Continuar assistindo","reportModalTitle":"Reportar erro","reportModalOption1":"O vídeo não carrega, mesmo com boa conexão de internet","reportModalOption2":"O conteúdo do vídeo não corresponde com a descrição","reportModalOption3":"O vídeo está em baixa qualidade ou pixelado","reportModalOption4":"Outro","reportModalField":"Descreva seu problema...","reportModalAction1":"Enviar","reportModalAction2":"Cancelar","reportModalText1":"Aguarde um momento, seu feedback","reportModalText2":"está sendo enviado.","reportModalText3":"Obrigado por nos ajudar a melhorar!","chapters":"Capítulos","aboutPanda":"Sobre a Panda Video","aboutPandaLink":"https://pandavideo.com.br/","waitingForLive":"AGUARDANDO LIVE STREAM","activateSound":"ATIVAR SOM","watermark_question":"Digite sua chave de acesso","trialWarning":"Panda Video período de teste.<br>Inicie o plano para remover esta mensagem.","mindmap":"Mapa Mental","questions":"Perguntas","abstract":"E-Book","cancel":"Cancelar","reset_button":"resetar","copy_button":"Copiar","download_button":"Download","smart_search_placeholder":"Buscar na legenda","drmPreload":"Preparando segurança do vídeo","live_chat":{"removedMessage":"Esta mensagem foi removida","you":"Você","registerModal":{"title":"Participe do chat","actionBtn":"Entrar no chat","namePlaceholder":"Nome"}}}')}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{"use strict";var e=n(379),t=n.n(e),i=n(795),r=n.n(i),s=n(569),a=n.n(s),o=n(565),l=n.n(o),c=n(216),d=n.n(c),u=n(589),h=n.n(u),p=n(376),f={};f.styleTagTransform=h(),f.setAttributes=l(),f.insert=a().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=d(),t()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals;var m=n(485),g={};g.styleTagTransform=h(),g.setAttributes=l(),g.insert=a().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=d(),t()(m.Z,g),m.Z&&m.Z.locals&&m.Z.locals;var y=n(615),v={};function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function T(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}v.styleTagTransform=h(),v.setAttributes=l(),v.insert=a().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=d(),t()(y.Z,v),y.Z&&y.Z.locals&&y.Z.locals;var E=2147483647,w=function(){function e(t,n,i){b(this,e),this.mouse_over_progressbar=!1,this.title_jumped=!1,this.sections=[],this.moments=[],this.el_pbar=document.querySelector(n),this.el_body=document.querySelector(t),this.el_body.style.pointerEvents="none",this.video_length=i.videoLength,this.ev_config=i,this.c_width=this.el_body.clientWidth-1,this.createElements(),this.startResizeMonitoring()}return T(e,[{key:"updateLengthForLiveStream",value:function(e){this.video_length=e,this.resizeSections()}},{key:"reloadChapters",value:function(){for(;this.el_root.firstChild;)this.el_root.removeChild(this.el_root.firstChild);if(this.sections=[],null==this.ev_config.chapters||0==this.ev_config.chapters.length){var e=new k(this,0,E,"",!1);this.sections.push(e),this.el_root.appendChild(e.GetElement())}else{var t=0;this.ev_config.chapters.sort(S.compare);for(var n=0;n<this.ev_config.chapters.length;n++){var i=this.ev_config.chapters[n];i.start>t&&(e=new k(this,t,i.start,"",!1),this.sections.push(e),this.el_root.appendChild(e.GetElement())),i.start<t&&(i.start=t),e=new k(this,i.start,i.end,i.title,!0),this.sections.push(e),this.el_root.appendChild(e.GetElement()),t=i.end}}}},{key:"createElements",value:function(){this.el_base=document.createElement("div"),this.el_base.className="sp__base",this.el_root=document.createElement("ul"),this.el_root.className="sp__progressbar",this.el_title=document.createElement("div"),this.el_title.className="sp__title",this.el_title.textContent="test",this.el_base.appendChild(this.el_root),this.el_base.appendChild(this.el_title),this.el_body.appendChild(this.el_base),this.reloadChapters();for(var e=0;e<this.ev_config.moments.length;e++){var t=this.ev_config.moments[e],n=new x(this,t.timestamp,t.title);this.el_base.appendChild(n.GetElement()),this.moments.push(n),n.Reposition()}var i=this;function r(e){var t=e.touches[0]||e.changedTouches[0],n=e.target.parentNode.getBoundingClientRect();i.mouse_x=t.pageX-n.left+6,i.mouse_y=t.pageY-n.top,i.mouse_over_progressbar=!0,i.el_root.classList.contains("hover")||i.el_root.classList.add("hover");var r=i.getCurrentMouseSecnds();i.DetectHoverMoments(r),i.moment_active||i.DetectHoverSection(r),i.updateSections("mark",r),i.CallThumbnailJumpDownEvent(),i.CallThumbnailJumpUpEvent(),null==i.c_highlightedSection||i.moment_active||i.PositionTitleAndIndicator(r);var s=document.querySelector(".plyr__preview-thumb"),a=document.querySelector(".plyr__preview-thumb__time-container span");if(s.classList.contains("plyr__tooltip--drag")||s.classList.add("plyr__tooltip--drag"),a.textContent=i.secondsToTimeString(r),null!=i.ev_config.onScrubbingChange&&i.ev_config.onScrubbingChange(i.getCurrentMouseSecnds(),i.SecondsToPixels(i.getCurrentMouseSecnds())),"touchend"===e.type){i.mouse_over_progressbar=!1,i.updateSections("mark",0);for(var o=0;o<i.sections.length;o++)i.sections[o].section_interactive&&(i.sections[o].HideTitle(),i.sections[o].SetInactive());s.classList.remove("plyr__tooltip--drag"),a.textContent=i.secondsToTimeString(i.c_progress),null!=i.ev_config.onScrubbingChange&&i.ev_config.onScrubbingChange(i.getCurrentMouseSecnds(),i.SecondsToPixels(i.getCurrentMouseSecnds()))}}this.el_pbar.addEventListener("mousemove",(function(e){var t=i.el_pbar.parentNode.getBoundingClientRect();i.mouse_x=e.clientX-t.left+6,i.mouse_y=e.clientY-t.top,i.mouse_over_progressbar=!0,i.el_root.classList.contains("hover")||i.el_root.classList.add("hover"),i.el_title.classList.remove("animated");var n=i.getCurrentMouseSecnds();i.DetectHoverMoments(n),i.moment_active||i.DetectHoverSection(n),i.updateSections("mark",n),i.CallThumbnailJumpDownEvent(),i.CallThumbnailJumpUpEvent(),null==i.c_highlightedSection||i.moment_active||i.PositionTitleAndIndicator(n)})),this.el_pbar.addEventListener("mouseleave",(function(e){i.el_title.classList.contains("animated")||i.el_title.classList.add("animated"),i.mouse_over_progressbar=!1,i.DetectHoverMoments(-1e4),i.el_root.classList.remove("hover"),i.updateSections("mark",0),i.c_timeoutEvent=void 0,clearInterval(i.c_timeout)})),this.el_pbar.addEventListener("touchmove",r.bind(this)),this.el_pbar.addEventListener("touchstart",r.bind(this)),this.el_pbar.addEventListener("touchend",r.bind(this))}},{key:"IsMobile",value:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}},{key:"SetDuration",value:function(e){this.video_length=e,this.resizeSections()}},{key:"SecondsToPixels",value:function(e){return this.c_width/this.video_length*e}},{key:"PixelsToSeconds",value:function(e){return e/(this.c_width/this.video_length)}},{key:"SetCurrentProgress",value:function(e){this.updateSections("progress",e),this.c_progress=e,this.mouse_over_progressbar||this.moment_active||(this.moment_active||this.DetectHoverSection(e),null!=this.c_highlightedSection&&this.PositionTitleAndIndicator(this.c_highlightedSection.section_start+(this.c_highlightedSection.section_end-this.c_highlightedSection.section_start)/2))}},{key:"SetBufferProgress",value:function(e){this.updateSections("buffer",e)}},{key:"DetectHoverSection",value:function(e){if(!this.moment_active){for(var t=null,n=0;n<this.sections.length;n++)this.sections[n].section_interactive&&(this.sections[n].section_start<=e&&this.sections[n].section_end>e?t=this.sections[n]:(this.sections[n].HideTitle(),this.sections[n].SetInactive()));if(null!=t)return t.ShowTitle(),t.SetActive(),this.c_highlightedSection=t,!0;this.c_highlightedSection=null}return!1}},{key:"DetectHoverMoments",value:function(e){for(var t=null,n=0;n<this.moments.length;n++){var i=this.PixelsToSeconds(12);this.moments[n].moment_timestamp-i<e&&this.moments[n].moment_timestamp+i>e?t=this.moments[n]:this.moments[n].RemoveHover()}return null!=t?(t.ShowTitle(),this.c_highlightedMoment=t,!0):(null!=this.c_highlightedMoment&&this.c_highlightedMoment.HideTitle(),this.c_highlightedSection=null,!1)}},{key:"PositionTitleAndIndicator",value:function(e){var t=Math.max(this.SecondsToPixels(e)-this.el_title.clientWidth/2,0);t=Math.min(t,this.el_root.clientWidth-this.el_title.clientWidth),this.el_title.style.left=t+"px"}},{key:"updateSections",value:function(e,t){for(var n=0;n<this.sections.length;n++)this.sections[n].SetMark(e,t)}},{key:"resizeSections",value:function(){for(var e=0;e<this.sections.length;e++)this.sections[e].Resize();for(e=0;e<this.moments.length;e++)this.moments[e].Reposition()}},{key:"secondsToTimeString",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);t<0&&(t=0),n<0&&(n=0);var i=t.toString(),r=n.toString();return i.length<2&&(i="0"+i),r.length<2&&(r="0"+r),i+":"+r}},{key:"getCurrentMouseSecnds",value:function(){return this.mouse_x/(this.c_width/this.video_length)}},{key:"startResizeMonitoring",value:function(){var e=this;setInterval((function(){var t=e.c_width;e.c_width=e.el_body.clientWidth-1,e.c_width!=t&&e.resizeSections()}),100)}},{key:"CallThumbnailJumpUpEvent",value:function(e){void 0===e&&(e=!1),this.title_jumped||!this.moment_active&&!this.IsThumbnailInTitleHitBox()||(document.querySelector(".plyr__preview-thumb").style.bottom="45px")}},{key:"CallThumbnailJumpDownEvent",value:function(e){void 0===e&&(e=!1),!this.title_jumped||this.IsThumbnailInTitleHitBox()||this.moment_active||(document.querySelector(".plyr__preview-thumb").style.bottom="22px")}},{key:"IsThumbnailInTitleHitBox",value:function(){if(this.moment_active)return this.title_jumped=!0,!0;var e=this.el_title.getBoundingClientRect().left,t=this.el_title.classList.contains("active");if(e<-50||!t)return this.title_jumped=!1,!1;var n=document.querySelector(".plyr__preview-thumb").getBoundingClientRect(),i=this.el_title.getBoundingClientRect();return i.left+i.width<n.left?(this.title_jumped=!1,!1):n.left+n.width>i.left?(this.title_jumped=!0,!0):(this.title_jumped=!1,!1)}}]),e}(),S=function(){function e(){b(this,e)}return T(e,null,[{key:"compare",value:function(e,t){return e.start-t.start}}]),e}(),x=function(){function e(t,n,i){b(this,e),this.pb=t,this.el_body=document.createElement("div"),this.el_body.className="sp__moment",this.moment_timestamp=n,this.moment_title=i,this.Reposition()}return T(e,[{key:"Reposition",value:function(){this.el_body.style.left="".concat(this.pb.SecondsToPixels(this.moment_timestamp)-6,"px")}},{key:"GetElement",value:function(){return this.el_body}},{key:"ShowTitle",value:function(){this.el_body.classList.contains("hover")||this.el_body.classList.add("hover"),this.pb.PositionTitleAndIndicator(this.moment_timestamp),this.pb.moment_active||(this.pb.moment_active=!0,""!=this.moment_title&&this.pb.CallThumbnailJumpUpEvent(),this.pb.el_title.classList.add("active")),this.pb.el_title.textContent=this.moment_title}},{key:"HideTitle",value:function(){if(this.pb.moment_active){this.RemoveHover(),this.pb.PositionTitleAndIndicator(this.moment_timestamp);for(var e=0;e<this.pb.sections.length;e++)this.pb.sections[e].section_interactive&&this.pb.sections[e].SetInactive();this.pb.moment_active=!1,this.pb.DetectHoverSection(this.moment_timestamp)?this.pb.el_title.textContent=this.pb.c_highlightedSection.section_title:(this.pb.el_title.textContent="",this.pb.el_title.classList.remove("active"),""!=this.moment_title&&(this.pb.title_jumped=!0,this.pb.CallThumbnailJumpDownEvent(!0)))}}},{key:"RemoveHover",value:function(){this.el_body.classList.remove("hover")}}]),e}(),k=function(){function e(t,n,i,r,s){b(this,e),this.bars={},this.pb=t,this.section_start=n,this.section_end=i,this.section_interactive=s,this.section_title=r,this.el_body=document.createElement("li"),s&&this.el_body.classList.add("interactive"),this.el_container=document.createElement("div"),this.el_container.className="sp__container",this.el_bg=document.createElement("div"),this.el_bg.className="sp__bg",this.el_body.append(this.el_container),this.el_container.append(this.el_bg);var a=new C(this,1,"#ffffff88");this.bars.mark=a,this.el_container.append(a.GetElement());var o=new C(this,2,"#ffffff50");this.bars.buffer=o,this.el_container.append(o.GetElement());var l=new C(this,3,"var(--plyr-color-main)");this.bars.progress=l,this.el_container.append(l.GetElement()),this.Resize()}return T(e,[{key:"SetInactive",value:function(){this.el_body.classList.remove("active")}},{key:"SetActive",value:function(){this.el_body.classList.contains("active")||this.el_body.classList.add("active")}},{key:"HideTitle",value:function(){this.c_titleShown&&(this.pb.el_title.textContent="",this.pb.el_title.classList.remove("active"),""!=this.section_title&&this.pb.CallThumbnailJumpDownEvent()),this.c_titleShown=!1}},{key:"ShowTitle",value:function(){this.c_titleShown||(this.section_interactive&&!this.pb.el_title.classList.contains("active")&&(this.pb.el_title.classList.add("active"),""!=this.section_title&&this.pb.CallThumbnailJumpUpEvent()),this.pb.el_title.textContent=this.section_interactive?this.section_title:"",this.c_titleShown=!0)}},{key:"Resize",value:function(){var e=this.section_end==E?this.pb.video_length:this.section_end,t=this.pb.SecondsToPixels(e-this.section_start);for(var n in this.el_body.style.width="".concat(t,"px"),this.c_width=t,this.bars)this.bars[n].Measure()}},{key:"SetMark",value:function(e,t){this.bars[e].SetMark(t)}},{key:"GetElement",value:function(){return this.el_body}}]),e}(),C=function(){function e(t,n,i){b(this,e),this.section=t,this.c_zindex=n,this.c_color=i,this.el_body=document.createElement("div"),this.el_body.className="sp__section",this.el_body.style.backgroundColor=this.c_color,this.el_body.style.zIndex=this.c_zindex,this.el_body.style.width="0",this.Measure()}return T(e,[{key:"SetMark",value:function(e){if(e<=this.section.section_start)this.el_body.style.width="0";else{var t=this.section.pb.SecondsToPixels(this.section.section_start),n=this.section.pb.SecondsToPixels(e)-t;this.el_body.style.width="".concat(Math.min(n,this.c_width),"px")}}},{key:"Measure",value:function(){var e=this.section.section_end==E?this.section.pb.video_length:this.section.section_end;this.c_width=this.section.pb.SecondsToPixels(e-this.section.section_start)}},{key:"GetElement",value:function(){return this.el_body}}]),e}();function L(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var A,R,I,D,P,M={exports:{}};A=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,R=/^(?=([^\/?#]*))\1([^]*)$/,I=/(?:\/|^)\.(?=\/)/g,D=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,P={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var i=P.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=P.normalizePath(i.path),P.buildURLFromParts(i)}var r=P.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return n.alwaysNormalize?(r.path=P.normalizePath(r.path),P.buildURLFromParts(r)):t;var s=P.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var a=R.exec(s.path);s.netLoc=a[1],s.path=a[2]}s.netLoc&&!s.path&&(s.path="/");var o={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){var l=s.path,c=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=P.normalizePath(c)}else o.path=s.path,r.params||(o.params=s.params,r.query||(o.query=s.query));return null===o.path&&(o.path=n.alwaysNormalize?P.normalizePath(r.path):r.path),P.buildURLFromParts(o)},parseURL:function(e){var t=A.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(I,"");e.length!==(e=e.replace(D,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},M.exports=P;var O=M.exports;function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},U.apply(this,arguments)}const $=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)};let G=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e}({}),H=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),z=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({});const q=function(){},j={trace:q,debug:q,log:q,warn:q,info:q,error:q};let Y=j;const V=Y,K=/^(\d+)x(\d+)$/,W=/(.+?)=(".*?"|.*?)(?:,|$)/g;class X{constructor(e){"string"==typeof e&&(e=X.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=K.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={};for(W.lastIndex=0;null!==(t=W.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1)),n[t[1].trim()]=e}return n}}function Z(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class Q{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){V.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=U(new X({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);$(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if($(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&$(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class J{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ee="audio",te="video",ne="audiovideo";class ie{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ee]:null,[te]:null,[ne]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2),i=[];1===n.length?i[0]=t?t.byteRangeEndOffset:0:i[0]=parseInt(n[1]),i[1]=parseInt(n[0])+i[0],this._byteRange=i}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=O.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class re extends ie{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new J,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!$(this.programDateTime))return null;const e=$(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r,s=!1){const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e.audio=null,e.video=null,e.audiovideo=null}}class se extends ie{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new J,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class ae{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&$(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function oe(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function le(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}var ce={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},de="org.w3.clearkey",ue="com.apple.streamingkeydelivery",he="com.microsoft.playready",pe="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function fe(e){switch(e){case ue:return ce.FAIRPLAY;case he:return ce.PLAYREADY;case pe:return ce.WIDEVINE;case de:return ce.CLEARKEY}}var me="edef8ba979d64acea3c827dcd51d21ed";function ge(e){switch(e){case ce.FAIRPLAY:return ue;case ce.PLAYREADY:return he;case ce.WIDEVINE:return pe;case ce.CLEARKEY:return de}}function ye(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[ce.FAIRPLAY,ce.WIDEVINE,ce.PLAYREADY,ce.CLEARKEY].filter((e=>!!t[e])):[];return!i[ce.WIDEVINE]&&n&&i.push(ce.WIDEVINE),i}const ve="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function be(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}const _e=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,Te=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,Ee=(e,t)=>{const n=t;let i=0;for(;_e(e,t);)i+=10,i+=we(e,t+6),Te(e,t+10)&&(i+=10),t+=i;if(i>0)return e.subarray(n,n+i)},we=(e,t)=>{let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n},Se=(e,t)=>_e(e,t)&&we(e,t+6)+10<=e.length-t,xe=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,ke=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=we(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},Ce=e=>{let t=0;const n=[];for(;_e(e,t);){const i=we(e,t+6);t+=10;const r=t+i;for(;t+8<r;){const i=ke(e.subarray(t)),r=Le(i);r&&n.push(r),t+=i.size+10}Te(e,t)&&(t+=10)}return n},Le=e=>"PRIV"===e.type?Ae(e):"W"===e.type[0]?Ie(e):Re(e),Ae=e=>{if(e.size<2)return;const t=Pe(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},Re=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=Pe(e.data.subarray(t),!0);t+=n.length+1;const i=Pe(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Pe(e.data.subarray(1));return{key:e.type,data:t}},Ie=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=Pe(e.data.subarray(t),!0);t+=n.length+1;const i=Pe(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Pe(e.data);return{key:e.type,data:t}},De=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},Pe=(e,t=!1)=>{const n=Oe();if(n){const i=n.decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const i=e.length;let r,s,a,o="",l=0;for(;l<i;){if(r=e[l++],0===r&&t)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=e[l++],o+=String.fromCharCode((31&r)<<6|63&s);break;case 14:s=e[l++],a=e[l++],o+=String.fromCharCode((15&r)<<12|(63&s)<<6|(63&a)<<0)}}return o};let Me;function Oe(){return Me||void 0===self.TextDecoder||(Me=new self.TextDecoder("utf-8")),Me}const Ne=function(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t},Fe=Math.pow(2,32)-1,Be=[].push,Ue={video:1,audio:2,id3:3,text:4};function $e(e){return String.fromCharCode.apply(null,e)}function Ge(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function He(e,t){const n=ze(e,t);return n<0?4294967296+n:n}function ze(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function qe(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function je(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=He(e,r),a=s>1?r+s:i;if($e(e.subarray(r+4,r+8))===t[0])if(1===t.length)n.push(e.subarray(r+8,a));else{const i=je(e.subarray(r+8,a),t.slice(1));i.length&&Be.apply(n,i)}r=a}return n}function Ye(e){const t=[],n=e[0];let i=8;const r=He(e,i);i+=4,i+=0===n?8:16,i+=2;let s=e.length+0;const a=Ge(e,i);i+=2;for(let n=0;n<a;n++){let n=i;const a=He(e,n);n+=4;const o=2147483647&a;if(1==(2147483648&a)>>>31)return V.warn("SIDX has hierarchical references (not supported)"),null;const l=He(e,n);n+=4,t.push({referenceSize:o,subsegmentDuration:l,info:{duration:l/r,start:s,end:s+o-1}}),s+=o,n+=4,i=n}return{earliestPresentationTime:0,timescale:r,version:n,referencesCount:a,references:t}}function Ve(e){const t=[],n=je(e,["moov","trak"]);for(let e=0;e<n.length;e++){const i=n[e],r=je(i,["tkhd"])[0];if(r){let e=r[0],n=0===e?12:20;const s=He(r,n),a=je(i,["mdia","mdhd"])[0];if(a){e=a[0],n=0===e?12:20;const r=He(a,n),o=je(i,["mdia","hdlr"])[0];if(o){const e=$e(o.subarray(8,12)),n={soun:ee,vide:te}[e];if(n){const e=je(i,["mdia","minf","stbl","stsd"])[0];let a;e&&(a=$e(e.subarray(12,16))),t[s]={timescale:r,type:n},t[n]={timescale:r,id:s,codec:a}}}}}}return je(e,["moov","mvex","trex"]).forEach((e=>{const n=He(e,4),i=t[n];i&&(i.default={duration:He(e,12),flags:He(e,20)})})),t}function Ke(e){const t=je(e,["schm"])[0];if(t){const n=$e(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return je(e,["schi","tenc"])[0]}return V.error("[eme] missing 'schm' box"),null}function We(e){const t=He(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let i=0;const r=He(e,4);for(let s=0;s<r;s++)256&t&&(i+=He(e,n),n+=4),512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4);return i}function Xe(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Ze(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;return je(i,["moof"]).map((o=>{const l=o.byteOffset-8;je(o,["traf"]).map((o=>{const c=je(o,["tfdt"]).map((e=>{const t=e[0];let n=He(e,4);return 1===t&&(n*=Math.pow(2,32),n+=He(e,8)),n/r}))[0];return void 0!==c&&(e=c),je(o,["tfhd"]).map((c=>{const d=He(c,4),u=16777215&He(c,0);let h=0;const p=0!=(16&u);let f=0;const m=0!=(32&u);let g=8;d===s&&(0!=(1&u)&&(g+=8),0!=(2&u)&&(g+=4),0!=(8&u)&&(h=He(c,g),g+=4),p&&(f=He(c,g),g+=4),m&&(g+=4),"video"===t.type&&(a=function(e){if(!e)return!1;const t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}(t.codec)),je(o,["trun"]).map((s=>{const o=s[0],c=16777215&He(s,0),d=0!=(1&c);let u=0;const p=0!=(4&c),m=0!=(256&c);let g=0;const y=0!=(512&c);let v=0;const b=0!=(1024&c),_=0!=(2048&c);let T=0;const E=He(s,4);let w=8;d&&(u=He(s,w),w+=4),p&&(w+=4);let S=u+l;for(let l=0;l<E;l++){if(m?(g=He(s,w),w+=4):g=h,y?(v=He(s,w),w+=4):v=f,b&&(w+=4),_&&(T=0===o?He(s,w):ze(s,w),w+=4),t.type===te){let t=0;for(;t<v;){const s=He(i,S);S+=4,Qe(a,i[S])&&Je(i.subarray(S,S+s),a?2:1,e+T/r,n),S+=s,t+=s+4}}e+=g/r}})))}))}))})),n}function Qe(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6==(31&t)}function Je(e,t,n,i){const r=et(e);let s=0;s+=t;let a=0,o=0,l=!1,c=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;c=r[s++],a+=c}while(255===c);o=0;do{if(s>=r.length)break;c=r[s++],o+=c}while(255===c);const e=r.length-s;if(!l&&4===a&&s<r.length){if(l=!0,181===r[s++]){const e=Ge(r,s);if(s+=2,49===e){const e=He(r,s);if(s+=4,1195456820===e){const e=r[s++];if(3===e){const t=r[s++],o=31&t,l=64&t,c=l?2+3*o:0,d=new Uint8Array(c);if(l){d[0]=t;for(let e=1;e<c;e++)d[e]=r[s++]}i.push({type:e,payloadType:a,pts:n,bytes:d})}}}}}else if(5===a&&o<e){if(l=!0,o>16){const e=[];for(let t=0;t<16;t++){const n=r[s++].toString(16);e.push(1==n.length?"0"+n:n),3!==t&&5!==t&&7!==t&&9!==t||e.push("-")}const t=o-16,l=new Uint8Array(t);for(let e=0;e<t;e++)l[e]=r[s++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:Pe(l),userDataBytes:l})}}else if(o<e)s+=o;else if(o>e)break}}function et(e){const t=e.byteLength,n=[];let i=1;for(;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}let tt={};class nt{static clearKeyUriToKeyIdMap(){tt={}}constructor(e,t,n,i=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case ue:case pe:case he:case de:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"!==this.method||this.iv||V.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(e);return new nt(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=function(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=oe(r)):n=function(e){const t=le(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(r)}}return n}(this.uri);if(t)switch(this.keyFormat){case pe:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case he:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;if(t){i=1,r=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const n=t[e];if(16!==n.byteLength)throw new RangeError("Invalid key");r.set(n,16*e)}}else i=0,r=new Uint8Array;i>0?(s=new Uint8Array(4),t.length>0&&new DataView(s.buffer).setUint32(0,t.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(e,...t){const n=t.length;let i=8,r=n;for(;r--;)i+=t[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),r=0,i=8;r<n;r++)s.set(t[r],i),i+=t[r].byteLength;return s}([112,115,115,104],new Uint8Array([i,0,0,0]),e,s,r,a,n||new Uint8Array)}(e,null,t);const n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),i=String.fromCharCode.apply(null,Array.from(n)),r=i.substring(i.indexOf("<"),i.length),s=(new DOMParser).parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(s){const e=s.childNodes[0]?s.childNodes[0].nodeValue:s.getAttribute("VALUE");if(e){const t=oe(e).subarray(0,16);!function(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=tt[this.uri];if(!e){const t=Object.keys(tt).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16),new DataView(e.buffer,12,4).setUint32(0,t),tt[this.uri]=e}this.keyId=e}return this}}const it=/\{\$([a-zA-Z0-9-_]+)\}/g;function rt(e){return it.test(e)}function st(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(let i=n.length;i--;){const r=n[i],s=t[r];s&&(t[r]=at(e,s))}}function at(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(it,(t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),t):r}))}return t}function ot(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${n}"`);r=e.get(i)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):s[i]=r||""}function lt(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function ct(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}const dt={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},ut=ct();function ht(e,t){var n;return null!=(n=null==ut?void 0:ut.isTypeSupported(`${t||"video"}/mp4;codecs="${e}"`))&&n}const pt=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,ft=/#EXT-X-MEDIA:(.*)/g,mt=/^#EXT(?:INF|-X-TARGETDURATION):/m,gt=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),yt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class vt{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let e=t.shift()+".";return e+=parseInt(t.shift()).toString(16),e+=("000"+parseInt(t.shift()).toString(16)).slice(-4),e}return e}static resolve(e,t){return O.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return mt.test(e)}static parseMasterPlaylist(e,t){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:rt(e)},i=[];let r;for(pt.lastIndex=0;null!=(r=pt.exec(e));)if(r[1]){var s;const e=new X(r[1]);st(n,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const a=at(n,r[2]),o={attrs:e,bitrate:e.decimalInteger("AVERAGE-BANDWIDTH")||e.decimalInteger("BANDWIDTH"),name:e.NAME,url:vt.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),Tt((e.CODECS||"").split(/[ ,]+/).filter((e=>e)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=vt.convertAVC1ToAVCOTI(o.videoCodec)),null!=(s=o.unknownCodecs)&&s.length||i.push(o),n.levels.push(o)}else if(r[3]){const e=r[3],i=r[4];switch(e){case"SESSION-DATA":{const e=new X(i);st(n,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[t]=e);break}case"SESSION-KEY":{const e=bt(i,t,n);e.encrypted&&e.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(e)):V.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${i}"`);break}case"DEFINE":{const e=new X(i);st(n,e,["NAME","VALUE","QUERYPARAM"]),ot(n,e,t)}break;case"CONTENT-STEERING":{const e=new X(i);st(n,e,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:vt.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=_t(i)}}const a=i.length>0&&i.length<n.levels.length;return n.levels=a?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:s.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;for(ft.lastIndex=0;null!==(i=ft.exec(e));){const e=new X(i[1]),s=e.TYPE;if(s){const i=a[s],l=r[s]||[];r[s]=l,st(n,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const c={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",instreamId:e["INSTREAM-ID"],name:e.NAME||e.LANGUAGE||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:e.LANGUAGE,url:e.URI?vt.resolve(e.URI,t):""};if(null!=i&&i.length){const e=vt.findGroup(i,c.groupId)||i[0];Et(c,e,"audioCodec"),Et(c,e,"textCodec")}l.push(c)}}return r}static parseLevelPlaylist(e,t,n,i,r,s){const a=new ae(t),o=a.fragments;let l,c,d,u=null,h=0,p=0,f=0,m=0,g=null,y=new re(i,t),v=-1,b=!1;for(gt.lastIndex=0,a.m3u8=e,a.hasVariableRefs=rt(e);null!==(l=gt.exec(e));){b&&(b=!1,y=new re(i,t),y.start=f,y.sn=h,y.cc=m,y.level=n,u&&(y.initSegment=u,y.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null));const e=l[1];if(e){y.duration=parseFloat(e);const t=(" "+l[2]).slice(1);y.title=t||null,y.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if($(y.duration)){y.start=f,d&&xt(y,d,a),y.sn=h,y.level=n,y.cc=m,y.urlId=r,o.push(y);const e=(" "+l[3]).slice(1);y.relurl=at(a,e),wt(y,g),g=y,f+=y.duration,h++,p=0,b=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);g?y.setByteRange(e,g):y.setByteRange(e)}else if(l[5])y.rawProgramDateTime=(" "+l[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),-1===v&&(v=o.length);else{if(l=l[0].match(yt),!l){V.warn("No matches on slow regex match for level playlist!");continue}for(c=1;c<l.length&&void 0===l[c];c++);const e=(" "+l[c]).slice(1),r=(" "+l[c+1]).slice(1),f=l[c+2]?(" "+l[c+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":a.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":h=a.startSN=parseInt(r);break;case"SKIP":{const e=new X(r);st(a,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if($(t)){a.skippedSegments=t;for(let e=t;e--;)o.unshift(null);h+=t}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(a.recentlyRemovedDateranges=n.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(r),1);break;case"VERSION":a.version=parseInt(r);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(r||f)&&y.tagList.push(f?[r,f]:[r]);break;case"DISCONTINUITY":m++,y.tagList.push(["DIS"]);break;case"GAP":y.gap=!0,y.tagList.push([e]);break;case"BITRATE":y.tagList.push([e,r]);break;case"DATERANGE":{const e=new X(r);st(a,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),st(a,e,e.clientAttrs);const t=new Q(e,a.dateRanges[e.ID]);t.isValid||a.skippedSegments?a.dateRanges[t.id]=t:V.warn(`Ignoring invalid DATERANGE tag: "${r}"`),y.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new X(r);st(a,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?lt(a,e,s):ot(a,e,t)}break;case"DISCONTINUITY-SEQUENCE":m=parseInt(r);break;case"KEY":{const e=bt(r,t,a);if(e.isSupported()){if("NONE"===e.method){d=void 0;break}d||(d={}),d[e.keyFormat]&&(d=U({},d)),d[e.keyFormat]=e}else V.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":a.startTimeOffset=_t(r);break;case"MAP":{const e=new X(r);if(st(a,e,["BYTERANGE","URI"]),y.duration){const r=new re(i,t);St(r,e,n,d),u=r,y.initSegment=u,u.rawProgramDateTime&&!y.rawProgramDateTime&&(y.rawProgramDateTime=u.rawProgramDateTime)}else St(y,e,n,d),u=y,b=!0;break}case"SERVER-CONTROL":{const e=new X(r);a.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),a.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new X(r);a.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=a.partList;e||(e=a.partList=[]);const n=p>0?e[e.length-1]:void 0,i=p++,s=new X(r);st(a,s,["BYTERANGE","URI"]);const o=new se(s,y,t,i,n);e.push(o),y.duration+=o.duration;break}case"PRELOAD-HINT":{const e=new X(r);st(a,e,["URI"]),a.preloadHint=e;break}case"RENDITION-REPORT":{const e=new X(r);st(a,e,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(e);break}default:V.warn(`line parsed but not handled: ${l}`)}}}g&&!g.relurl?(o.pop(),f-=g.duration,a.partList&&(a.fragmentHint=g)):a.partList&&(wt(y,g),y.cc=m,a.fragmentHint=y,d&&xt(y,d,a));const _=o.length,T=o[0],E=o[_-1];if(f+=a.skippedSegments*a.targetduration,f>0&&_&&E){a.averagetargetduration=f/_;const e=E.sn;a.endSN="initSegment"!==e?e:0,a.live||(E.endList=!0),T&&(a.startCC=T.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(f+=a.fragmentHint.duration),a.totalduration=f,a.endCC=m,v>0&&function(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(o,v),a}}function bt(e,t,n){var i,r;const s=new X(e);st(n,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(i=s.METHOD)?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,d=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&V.error(`Invalid IV: ${s.IV}`);const u=o?vt.resolve(o,t):"",h=(c||"1").split("/").map(Number).filter(Number.isFinite);return new nt(a,u,d,h,l)}function _t(e){const t=new X(e).decimalFloatingPoint("TIME-OFFSET");return $(t)?t:null}function Tt(e,t){["video","audio","text"].forEach((n=>{const i=e.filter((e=>function(e,t){const n=dt[t];return!!n&&!0===n[e.slice(0,4)]}(e,n)));if(i.length){const r=i.filter((e=>0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)));t[`${n}Codec`]=r.length>0?r[0]:i[0],e=e.filter((e=>-1===i.indexOf(e)))}})),t.unknownCodecs=e}function Et(e,t,n){const i=t[n];i&&(e[n]=i)}function wt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),$(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function St(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function xt(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||i.push(e)}var kt="manifest",Ct="level",Lt="audioTrack",At="subtitleTrack",Rt="main",It="audio",Dt="subtitle";function Pt(e){const{type:t}=e;switch(t){case Lt:return It;case At:return Dt;default:return Rt}}function Mt(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class Ot{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(G.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_LOADING,this.onLevelLoading,this),e.off(G.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(G.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=new(n||i)(t);return this.loaders[e.type]=r,r}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:kt,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,url:r,deliveryDirectives:s}=t;this.load({id:n,level:i,responseType:"text",type:Ct,url:r,deliveryDirectives:s})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Lt,url:r,deliveryDirectives:s})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:At,url:r,deliveryDirectives:s})}load(e){var t;const n=this.hls.config;let i,r=this.getInternalLoader(e);if(r){const t=r.context;if(t&&t.url===e.url)return void V.trace("[playlist-loader]: playlist request ongoing");V.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}if(i=e.type===kt?n.manifestLoadPolicy.default:U({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let t;if(e.type===Ct&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Lt&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===At&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);i=U({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}const s=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;0===s.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),vt.isMediaPlaylist(s)?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),i||null,t)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,a,o)}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=Mt(e,n),o=vt.parseMasterPlaylist(s,a);if(o.playlistParsingError)return void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:c,sessionData:d,sessionKeys:u,startTimeOffset:h,variableList:p}=o;this.variableList=p;const{AUDIO:f=[],SUBTITLES:m,"CLOSED-CAPTIONS":g}=vt.parseMasterPlaylistMedia(s,a,o);f.length&&(f.some((e=>!e.url))||!c[0].audioCodec||c[0].attrs.AUDIO||(V.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),f.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new X({}),bitrate:0,url:""}))),r.trigger(G.MANIFEST_LOADED,{levels:c,audioTracks:f,subtitles:m,captions:g,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:d,sessionKeys:u,startTimeOffset:h,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,i,r){const s=this.hls,{id:a,level:o,type:l}=n,c=Mt(e,n),d=$(a)?a:0,u=$(o)?o:d,h=Pt(n),p=vt.parseLevelPlaylist(e.data,c,u,h,d,this.variableList);if(l===kt){const e={attrs:new X({}),bitrate:0,details:p,name:"",url:c};s.trigger(G.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:c,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(G.ERROR,{type:H.NETWORK_ERROR,details:z.MANIFEST_PARSING_ERROR,fatal:t.type===kt,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let s=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Ct?s+=`: ${e.level} id: ${e.id}`:e.type!==Lt&&e.type!==At||(s+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(s);V.warn(`[playlist-loader]: ${s}`);let o=z.UNKNOWN,l=!1;const c=this.getInternalLoader(e);switch(e.type){case kt:o=n?z.MANIFEST_LOAD_TIMEOUT:z.MANIFEST_LOAD_ERROR,l=!0;break;case Ct:o=n?z.LEVEL_LOAD_TIMEOUT:z.LEVEL_LOAD_ERROR,l=!1;break;case Lt:o=n?z.AUDIO_TRACK_LOAD_TIMEOUT:z.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case At:o=n?z.SUBTITLE_TRACK_LOAD_TIMEOUT:z.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(e.type);const d={type:H.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;d.response=F({url:n,data:void 0},i)}this.hls.trigger(G.ERROR,d)}handlePlaylistLoaded(e,t,n,i,r,s){const a=this.hls,{type:o,level:l,id:c,groupId:d,deliveryDirectives:u}=i,h=Mt(t,i),p=Pt(i),f="number"==typeof i.level&&p===Rt?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void a.trigger(G.ERROR,{type:H.NETWORK_ERROR,details:z.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:e,reason:e.message,response:t,context:i,level:f,parent:p,networkDetails:r,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m)a.trigger(G.ERROR,{type:H.NETWORK_ERROR,details:z.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:i,level:f,parent:p,networkDetails:r,stats:n});else switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case kt:case Ct:a.trigger(G.LEVEL_LOADED,{details:e,level:f||0,id:c||0,stats:n,networkDetails:r,deliveryDirectives:u});break;case Lt:a.trigger(G.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:u});break;case At:a.trigger(G.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:u})}}}function Nt(e,t){let n;try{n=new Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function Ft(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(n){V.debug(`[texttrack-utils]: ${n}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){V.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===n&&(e.mode=n)}function Bt(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function Ut(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=function(e,t,n){const i=[],r=function(e,t){if(t<e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i=0,r=n;for(;i<=r;){const s=Math.floor((r+i)/2);if(t<e[s].startTime)r=s-1;else{if(!(t>e[s].startTime&&i<n))return s;i=s+1}}return e[i].startTime-t<t-e[r].startTime?i:r}(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}var $t="org.id3",Gt="https://aomedia.org/emsg/ID3";function Ht(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const zt=(()=>{const e=Ht();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function qt(e,t){return e.getTime()/1e3-t}class jt{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(G.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(G.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Bt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Nt(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=Ht();for(let e=0;e<r.length;e++){const t=r[e].type;if(t===Gt&&!n||!i)continue;const a=Ce(r[e].data);if(a){const n=r[e].pts;let i=n+r[e].duration;i>zt&&(i=zt),i-n<=0&&(i=n+.25);for(let e=0;e<a.length;e++){const r=a[e];if(!xe(r)){this.updateId3CueEnds(n,t);const e=new s(n,i,"");e.value=r,t&&(e.type=t),this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let n=i.length;n--;){const r=i[n];r.type===t&&r.startTime<e&&r.endTime===zt&&(r.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=s;if(r&&(a||o)){let e;e="audio"===i?e=>e.type===$t&&o:"video"===i?e=>e.type===Gt&&a:e=>e.type===$t&&o||e.type===Gt&&a,Ut(r,t,n,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:r}=t,s=Object.keys(r);if(i){const e=Object.keys(n).filter((e=>!s.includes(e)));for(let t=e.length;t--;){const r=e[t];Object.keys(n[r].cues).forEach((e=>{i.removeCue(n[r].cues[e])})),delete n[r]}}const a=t.fragments[t.fragments.length-1];if(0===s.length||!$(null==a?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=a.programDateTime/1e3-a.start,l=Ht();for(let e=0;e<s.length;e++){const t=s[e],i=r[t],a=n[t],u=(null==a?void 0:a.cues)||{};let h=(null==a?void 0:a.durationKnown)||!1;const p=qt(i.startDate,o);let f=zt;const m=i.endDate;if(m)f=qt(m,o),h=!0;else if(i.endOnNext&&!h){const e=s.reduce(((e,t)=>{const n=r[t];return n.class===i.class&&n.id!==t&&n.startDate>i.startDate&&e.push(n),e}),[]).sort(((e,t)=>e.startDate.getTime()-t.startDate.getTime()))[0];e&&(f=qt(e.startDate,o),h=!0)}const g=Object.keys(i.attr);for(let e=0;e<g.length;e++){const n=g[e];if("ID"===(d=n)||"CLASS"===d||"START-DATE"===d||"DURATION"===d||"END-DATE"===d||"END-ON-NEXT"===d)continue;let r=u[n];if(r)h&&!a.durationKnown&&(r.endTime=f);else{let e=i.attr[n];r=new l(p,f,""),Z(n)&&(c=e,e=Uint8Array.from(c.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),r.value={key:n,data:e},r.type="com.apple.quicktime.HLS",r.id=t,this.id3Track.addCue(r),u[n]=r}}n[t]={cues:u,dateRange:i,durationKnown:h}}var c,d}}class Yt{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&n||t;(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*i);const c=i;return l+Math.min(1*this.stallCount,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(G.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(G.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(G.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(G.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===z.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&V.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r)return;const s=this.targetLatency;if(null===s)return;const a=n-s,o=a<Math.min(this.maxLatency,s+t.targetduration);if(t.live&&o&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const Vt=["NONE","TYPE-0","TYPE-1",null];class Kt{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Wt{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>e)).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function Xt(e,t){const n=t.startPTS;if($(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&(i.duration=r)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function Zt(e,t,n,i,r,s){i-n<=0&&(V.warn("Fragment should have a positive duration",t),i=n+t.duration,s=r+t.duration);let a=n,o=i;const l=t.startPTS,c=t.endPTS;if($(l)){const e=Math.abs(l-n);$(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,a=Math.max(n,l),n=Math.min(n,l),r=Math.min(r,t.startDTS),o=Math.min(i,c),i=Math.max(i,c),s=Math.max(s,t.endDTS)}const d=n-t.start;0!==t.start&&(t.start=n),t.duration=i-t.start,t.startPTS=n,t.maxStartPTS=a,t.startDTS=r,t.endPTS=i,t.minEndPTS=o,t.endDTS=s;const u=t.sn;if(!e||u<e.startSN||u>e.endSN)return 0;let h;const p=u-e.startSN,f=e.fragments;for(f[p]=t,h=p;h>0;h--)Xt(f[h],f[h-1]);for(h=p;h<f.length-1;h++)Xt(f[h],f[h+1]);return e.fragmentHint&&Xt(f[f.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function Qt(e,t){const n=t.startSN+t.skippedSegments-e.startSN,i=e.fragments;n<0||n>=i.length||Jt(t,i[n].start)}function Jt(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function en(e,t,n){var i;return null!=e&&e.details?tn(null==(i=e.details)?void 0:i.partList,t,n):null}function tn(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function nn(e){switch(e.details){case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_TIMEOUT:case z.LEVEL_LOAD_TIMEOUT:case z.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function rn(e,t){const n=nn(t);return e.default[(n?"timeout":"error")+"Retry"]}function sn(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function an(e){return F(F({},e),{errorRetry:null,timeoutRetry:null})}function on(e,t,n,i){return!!e&&t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(i)||!!n)}const ln=function(e,t){let n=0,i=e.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null};function cn(e,t,n=0,i=0){let r=null;if(e?r=t[e.sn-t[0].sn+1]||null:0===n&&0===t[0].start&&(r=t[0]),r&&0===dn(n,i,r))return r;const s=ln(t,dn.bind(null,n,i));return!s||s===e&&r?r:s}function dn(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function un(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>e}function hn(e,t,n){if(performance.now()-e.lastErrorPerfMs>3e5)return!0;const i=e.details;if(t.details===z.FRAG_GAP&&i&&t.frag){const e=t.frag.start,n=cn(null,i.fragments,e);if(n&&!n.gap)return!0}if(n&&e.errors.length<n.errors.length){const n=e.errors[e.errors.length-1];if(i&&n.frag&&t.frag&&Math.abs(n.frag.start-t.frag.start)>3*i.targetduration)return!0}return!1}class pn{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=V.log.bind(V,`${t}:`),this.warn=V.warn.bind(V,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const n=null==t?void 0:t.renditionReports;if(n){let i=-1;for(let r=0;r<n.length;r++){const s=n[r];let a;try{a=new self.URL(s.URI,t.url).href}catch(e){V.warn(`Could not construct new URL for Rendition Report: ${e}`),a=s.URI||""}if(a===e){i=r;break}a===e.substring(0,a.length)&&(i=r)}if(-1!==i){const e=n[i],r=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let s=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);s>=0&&e>t.partTarget&&(s+=1)}return new Kt(r,s>=0?s:void 0,"")}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||null!=n&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED"}`),n&&i.fragments.length>0&&function(e,t){let n=null;const i=e.fragments;for(let e=i.length-1;e>=0;e--){const t=i[e].initSegment;if(t){n=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let r,s=0;if(function(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=r;e<=s;e++){const r=l[a+e];let s=o[e];i&&!s&&e<i&&(s=t.fragments[e]=r),r&&s&&n(r,s)}}(e,t,((e,i)=>{e.relurl&&(s=e.cc-i.cc),$(e.startPTS)&&$(e.endPTS)&&(i.start=i.startPTS=e.startPTS,i.startDTS=e.startDTS,i.maxStartPTS=e.maxStartPTS,i.endPTS=e.endPTS,i.endDTS=e.endDTS,i.minEndPTS=e.minEndPTS,i.duration=e.endPTS-e.startPTS,i.duration&&(r=i),t.PTSKnown=t.alignedSliding=!0),i.elementaryStreams=e.elementaryStreams,i.loader=e.loader,i.stats=e.stats,i.urlId=e.urlId,e.initSegment&&(i.initSegment=e.initSegment,n=e.initSegment)})),n&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((e=>{var t;e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)})),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((e=>!e)),t.deltaUpdateFailed){V.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){const i=U({},e);return n&&n.forEach((e=>{delete i[e]})),Object.keys(t).forEach((e=>{const n=new Q(t[e].attr,i[e]);n.isValid?i[e]=n:V.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)})),i}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const a=t.fragments;if(s){V.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<a.length;e++)a[e].cc+=s}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),r?Zt(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):Qt(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const o=t.advancedDateTime;if(t.advanced&&o){const e=t.edge;t.driftStart||(t.driftStartTime=o,t.driftStart=e),t.driftEndTime=o,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}(n,i),!this.canLoad||!i.live)return;let a,o,l;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,s=i.endSN,c=i.lastPartIndex,d=r===s,u=e?0:c;-1!==c?(o=d?s+1:r,l=d?u:c+1):o=s+1;const h=i.age,p=h+i.ageHeader;let f=Math.min(p-i.partTarget,1.5*i.targetduration);if(f>0){if(n&&f>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${f} with playlist age: ${i.age}`),f=0;else{const e=Math.floor(f/i.targetduration);o+=e,void 0!==l&&(l+=Math.round(f%i.targetduration/i.partTarget)),this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${h.toFixed(2)}s goal: ${f} skip sn ${e} to part ${l}`)}i.tuneInGoal=f}if(a=this.getDeliveryDirectives(i,t.deliveryDirectives,o,l),e||!d)return void this.loadPlaylist(a)}else i.canBlockReload&&(a=this.getDeliveryDirectives(i,t.deliveryDirectives,o,l));const c=this.hls.mainForwardBufferInfo,d=c?c.end-c.len:0,u=function(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}(i,1e3*(i.edge-d));i.updated&&s>this.requestScheduled+u&&(this.requestScheduled=r.loading.start),void 0!==o&&i.canBlockReload?this.requestScheduled=r.loading.first+u-(1e3*i.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+u<s?this.requestScheduled=s:this.requestScheduled-s<=0&&(this.requestScheduled+=u);let h=this.requestScheduled-s;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(a)),h)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let r=function(e,t){const{canSkipUntil:n,canSkipDateRanges:i,endSN:r}=e;return n&&(void 0!==t?t-r:0)<n?i?"v2":"YES":""}(e,n);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=""),new Kt(n,i,r)}checkRetry(e){const t=e.details,n=nn(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(5===r||!i.resolved&&2===r);if(o){var l;if(this.requestScheduled=-1,s>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=sn(a,s);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${s+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,i.resolved=!0}return o}}let fn;class mn extends pn{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this),e.on(G.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this),e.off(G.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=[],i={};let r;t.levels.forEach((e=>{var t;const s=e.attrs;-1!==(null==(t=e.audioCodec)?void 0:t.indexOf("mp4a.40.34"))&&(fn||(fn=/chrome|firefox/i.test(navigator.userAgent)),fn&&(e.audioCodec=void 0));const{AUDIO:a,CODECS:o,"FRAME-RATE":l,"PATHWAY-ID":c,RESOLUTION:d,SUBTITLES:u}=s,h=`${c||"."}-${e.bitrate}-${d}-${l}-${o}`;r=i[h],r?r.addFallback(e):(r=new Wt(e),i[h]=r,n.push(r)),gn(r,"audio",a),gn(r,"text",u)})),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],i=[],r=!1,s=!1,a=!1,o=e.filter((({audioCodec:e,videoCodec:t,width:n,height:i,unknownCodecs:o})=>(r||(r=!(!n||!i)),s||(s=!!t),a||(a=!!e),!(null!=o&&o.length)&&(!e||ht(e,"audio"))&&(!t||ht(t,"video")))));if((r||s)&&a&&(o=o.filter((({videoCodec:e,width:t,height:n})=>!!e||!(!t||!n)))),0===o.length)return void Promise.resolve().then((()=>{if(this.hls){const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}));t.audioTracks&&(n=t.audioTracks.filter((e=>!e.audioCodec||ht(e.audioCodec,"audio"))),yn(n)),t.subtitles&&(i=t.subtitles,yn(i));const l=o.slice(0);o.sort(((e,t)=>e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs["FRAME-RATE"]!==t.attrs["FRAME-RATE"]?e.attrs.decimalFloatingPoint("FRAME-RATE")-t.attrs.decimalFloatingPoint("FRAME-RATE"):e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):r&&e.height!==t.height?e.height-t.height:0));let c=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==l.length))for(let e=0;e<l.length;e++)if(l[e].pathwayId===o[0].pathwayId){c=l[e];break}this._levels=o;for(let e=0;e<o.length;e++)if(o[e]===c){this._firstLevel=e,this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${c.bitrate}`);break}const d=a&&!s,u={levels:o,audioTracks:n,subtitleTracks:i,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:s,altAudio:!d&&n.some((e=>!!e.url))};this.hls.trigger(G.MANIFEST_PARSED,u),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(G.ERROR,{type:H.OTHER_ERROR,details:z.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&s.details&&i&&r===a)return;this.log(`Switching to level ${e}${a?" with Pathway "+a:""} from level ${n}${r?" with Pathway "+r:""}`);const o=U({},s,{level:e,maxBitrate:s.maxBitrate,attrs:s.attrs,uri:s.uri,urlId:s.urlId});delete o._attrs,delete o._urlId,this.hls.trigger(G.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const e=this.switchParams(s.uri,null==i?void 0:i.details);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===Ct&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===Rt){const e=this._levels[t.level];void 0!==e&&(e.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=this._levels[i];var a;if(!s)return this.warn(`Invalid level index ${i}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0),this.playlistLoaded(i,t,s.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const n=this.currentLevel;if(!n)return;const i=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==i){let e=-1;for(let t=0;t<n.audioGroupIds.length;t++)if(n.audioGroupIds[t]===i){e=t;break}-1!==e&&e!==n.urlId&&(n.urlId=e,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){const i=n.urlId;let r=n.uri;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}const s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} URI ${i+1}/${n.url.length} ${r}`),this.clearTimer(),this.hls.trigger(G.LEVEL_LOADING,{url:r,level:t,id:i,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const n=(e,n)=>n!==t,i=this._levels.filter(((i,r)=>r!==e||(i.url.length>1&&void 0!==t?(i.url=i.url.filter(n),i.audioGroupIds&&(i.audioGroupIds=i.audioGroupIds.filter(n)),i.textGroupIds&&(i.textGroupIds=i.textGroupIds.filter(n)),i.urlId=0,!0):(this.steering&&this.steering.removeLevel(i),!1))));this.hls.trigger(G.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){t.forEach(((e,t)=>{const{details:n}=e;null!=n&&n.fragments&&n.fragments.forEach((e=>{e.level=t}))})),this._levels=t}}function gn(e,t,n){n&&("audio"===t?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=n):"text"===t&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=n))}function yn(e){const t={};e.forEach((e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}var vn="NOT_LOADED",bn="APPENDING",_n="PARTIAL",Tn="OK";class En{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(G.BUFFER_APPENDED,this.onBufferAppended,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(G.BUFFER_APPENDED,this.onBufferAppended,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let t=n.length;t--;){const i=n[t];if(!i)break;const r=i.end;if(i.start<=e&&null!==r&&e<=r)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let r=i.length;r--;){const s=n[i[r]];if((null==s?void 0:s.body.type)===t&&s.buffered){const t=s.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const r=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach((i=>{const s=this.fragments[i];if(!s)return;if(r>=s.body.sn)return;if(!s.buffered&&!s.loaded)return void(s.body.type===n&&this.removeFragment(s.body));const a=s.range[e];a&&a.time.some((e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(s.body),n}))}))}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||"initSegment"===n.sn)return;const r=Sn(n),s=this.fragments[r];if(!s||s.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach((e=>{const r=n.elementaryStreams[e];if(!r)return;const o=t[e],l=a||!0===r.partial;s.range[e]=this.getBufferedTimes(n,i,l,o)})),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,s.body.endList&&(this.endListFragments[s.body.type]=s),wn(s)||this.removeParts(n.sn-1,n.type)):this.removeFragment(s.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter((t=>t.fragment.sn>=e)))}fragBuffered(e,t){const n=Sn(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,l=e.maxStartPTS||s;for(let e=0;e<i.length;e++){const t=i.start(e)-this.bufferPadding,n=i.end(e)+this.bufferPadding;if(l>=t&&o<=n){r.time.push({startPTS:Math.max(s,i.start(e)),endPTS:Math.min(a,i.end(e))});break}if(s<n&&a>t)r.partial=!0,r.time.push({startPTS:Math.max(s,i.start(e)),endPTS:Math.min(a,i.end(e))});else if(a<=t)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((l=>{const c=o[l];c&&wn(c)&&(n=c.body.start-a,i=c.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=c.body,s=t)))})),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||wn(t))}getState(e){const t=Sn(e),n=this.fragments[t];return n?n.buffered?wn(n)?_n:Tn:bn:vn}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if("initSegment"===n.sn||n.bitrateTest)return;const r=i?null:t,s=Sn(n);this.fragments[s]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r}=t;if("initSegment"===n.sn)return;const s=n.type;if(i){let e=this.activePartLists[s];e||(this.activePartLists[s]=e=[]),e.push(i)}this.timeRanges=r,Object.keys(r).forEach((e=>{const t=r[e];this.detectEvictedFragments(e,t,s,i)}))}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Sn(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(e){const t=Sn(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=n.filter((e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function wn(e){var t,n,i;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(i=e.range.audiovideo)?void 0:i.partial))}function Sn(e){return`${e.type}_${e.level}_${e.urlId}_${e.sn}`}const xn=Math.pow(2,17);class kn{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new An({type:H.NETWORK_ERROR,details:z.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void o(Ln(e));e.gap=!1}const l=this.loader=e.loader=r?new r(i):new s(i),c=Cn(e),d=an(i.fragLoadPolicy.default),u={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:xn};e.stats=l.stats,l.load(c,u,{onSuccess:(t,n,i,r)=>{this.resetLoader(e,l);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,l),o(new An({type:H.NETWORK_ERROR,details:z.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:F({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,l),o(new An({type:H.NETWORK_ERROR,details:z.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,l),o(new An({type:H.NETWORK_ERROR,details:z.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${u.timeout}ms`),networkDetails:i,stats:t}))},onProgress:(n,i,r,s)=>{t&&t({frag:e,part:null,payload:r,networkDetails:s})}})}))}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(Ln(e,t));const l=this.loader=e.loader=r?new r(i):new s(i),c=Cn(e,t),d=an(i.fragLoadPolicy.default),u={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:xn};t.stats=l.stats,l.load(c,u,{onSuccess:(i,r,s,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const c={frag:e,part:t,payload:i.data,networkDetails:o};n(c),a(c)},onError:(n,i,r,s)=>{this.resetLoader(e,l),o(new An({type:H.NETWORK_ERROR,details:z.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:F({url:c.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new An({type:H.NETWORK_ERROR,details:z.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,l),o(new An({type:H.NETWORK_ERROR,details:z.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${u.timeout}ms`),networkDetails:r,stats:n}))}})}))}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=(i-s)*Math.round(n.loaded/s);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Cn(e,t=null){const n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if($(r)&&$(s)){var a;let t=r,n=s;if("initSegment"===e.sn&&"AES-128"===(null==(a=e.decryptdata)?void 0:a.method)){const e=s-r;e%16&&(n=s+(16-e%16)),0!==r&&(i.resetIV=!0,t=r-16)}i.rangeStart=t,i.rangeEnd=n}return i}function Ln(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),i={type:H.MEDIA_ERROR,details:z.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new An(i)}class An extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Rn{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;if(n){if(e&&e!==n.context.frag.type)return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=z.KEY_LOAD_ERROR,n,i,r){return new An({type:H.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let e=0;e<t.length;e++){const r=t[e];if(i<=r.cc&&("initSegment"===n||"initSegment"===r.sn||n<r.sn)){this.emeController.selectKeySystemFormat(r).then((e=>{r.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,z.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,z.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));let a=this.keyUriToKeyInfo[s];if(null!=(n=a)&&n.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var o;if(null!=(i=a)&&i.keyLoadPromise)switch(null==(o=a.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[s]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,z.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,n)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=new(0,n.loader)(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise(((r,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=n.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{const{frag:a,keyInfo:o,url:l}=n;if(!a.decryptdata||o!==this.keyUriToKeyInfo[l])return s(this.createKeyLoadError(a,z.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));o.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,z.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),i,F({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,z.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,z.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(a,l,c)}))}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],r&&r.destroy()}}const In={length:0,start:()=>0,end:()=>0};class Dn{static isBuffered(e,t){try{if(e){const n=Dn.getBuffered(e);for(let e=0;e<n.length;e++)if(t>=n.start(e)&&t<=n.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,n){try{if(e){const i=Dn.getBuffered(e),r=[];let s;for(s=0;s<i.length;s++)r.push({start:i.start(s),end:i.end(s)});return this.bufferedInfo(r,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort((function(e,t){return e.start-t.start||t.end-e.end}));let i=[];if(n)for(let t=0;t<e.length;t++){const r=i.length;if(r){const s=i[r-1].end;e[t].start-s<n?e[t].end>s&&(i[r-1].end=e[t].end):i.push(e[t])}else i.push(e[t])}else i=e;let r,s=0,a=t,o=t;for(let e=0;e<i.length;e++){const l=i[e].start,c=i[e].end;if(t+n>=l&&t<c)a=l,o=c,s=o-t;else if(t+n<l){r=l;break}}return{len:s,start:a||0,end:o||0,nextStart:r}}static getBuffered(e){try{return e.buffered}catch(e){return V.log("failed to get media.buffered",e),In}}}class Pn{constructor(e,t,n,i=0,r=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}function Mn(e,t){let n=null;for(let i=0,r=e.length;i<r;i++){const r=e[i];if(r&&r.cc===t){n=r;break}}return n}function On(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function Nn(e,t){const n=t.fragments;for(let t=0,i=n.length;t<i;t++)On(n[t],e);t.fragmentHint&&On(t.fragmentHint,e),t.alignedSliding=!0}function Fn(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;const r=i[Math.round(i.length/2)-1],s=Mn(n,r.cc)||n[Math.round(n.length/2)-1],a=r.programDateTime,o=s.programDateTime;null!==a&&null!==o&&Nn((o-a)/1e3-(s.start-r.start),e)}class Bn{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class Un{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class $n{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let e=0;e<4;e++)n[e]=t.getUint32(4*e);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,l=o[0],c=o[1],d=o[2],u=o[3],h=new Uint32Array(256);let p=0,f=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let n=f^f<<1^f<<2^f<<3^f<<4;n=n>>>8^255&n^99,e[p]=n,t[n]=p;const o=h[p],m=h[o],g=h[m];let y=257*h[n]^16843008*n;i[p]=y<<24|y>>>8,r[p]=y<<16|y>>>16,s[p]=y<<8|y>>>24,a[p]=y,y=16843009*g^65537*m^257*o^16843008*p,l[n]=y<<24|y>>>8,c[n]=y<<16|y>>>16,d[n]=y<<8|y>>>24,u[n]=y,p?(p=o^h[h[h[g^o]]],f^=h[h[f]]):p=f=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),d=this.sBox,u=this.rcon,h=this.invSubMix,p=h[0],f=h[1],m=h[2],g=h[3];let y,v;for(a=0;a<s;a++)a<r?y=l[a]=t[a]:(v=y,a%r==0?(v=v<<8|v>>>24,v=d[v>>>24]<<24|d[v>>>16&255]<<16|d[v>>>8&255]<<8|d[255&v],v^=u[a/r|0]<<24):r>6&&a%r==4&&(v=d[v>>>24]<<24|d[v>>>16&255]<<16|d[v>>>8&255]<<8|d[255&v]),l[a]=y=(l[a-r]^v)>>>0);for(o=0;o<s;o++)a=s-o,v=3&o?l[a]:l[a-4],c[o]=o<4||a<=4?v:p[d[v>>>24]]^f[d[v>>>16&255]]^m[d[v>>>8&255]]^g[d[255&v]],c[o]=c[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],c=a[2],d=a[3],u=this.uint8ArrayToUint32Array_(n);let h=u[0],p=u[1],f=u[2],m=u[3];const g=new Int32Array(e),y=new Int32Array(g.length);let v,b,_,T,E,w,S,x,k,C,L,A,R,I;const D=this.networkToHostOrderSwap;for(;t<g.length;){for(k=D(g[t]),C=D(g[t+1]),L=D(g[t+2]),A=D(g[t+3]),E=k^r[0],w=A^r[1],S=L^r[2],x=C^r[3],R=4,I=1;I<i;I++)v=o[E>>>24]^l[w>>16&255]^c[S>>8&255]^d[255&x]^r[R],b=o[w>>>24]^l[S>>16&255]^c[x>>8&255]^d[255&E]^r[R+1],_=o[S>>>24]^l[x>>16&255]^c[E>>8&255]^d[255&w]^r[R+2],T=o[x>>>24]^l[E>>16&255]^c[w>>8&255]^d[255&S]^r[R+3],E=v,w=b,S=_,x=T,R+=4;v=s[E>>>24]<<24^s[w>>16&255]<<16^s[S>>8&255]<<8^s[255&x]^r[R],b=s[w>>>24]<<24^s[S>>16&255]<<16^s[x>>8&255]<<8^s[255&E]^r[R+1],_=s[S>>>24]<<24^s[x>>16&255]<<16^s[E>>8&255]<<8^s[255&w]^r[R+2],T=s[x>>>24]<<24^s[E>>16&255]<<16^s[w>>8&255]<<8^s[255&S]^r[R+3],y[t]=D(v^h),y[t+1]=D(T^p),y[t+2]=D(_^f),y[t+3]=D(b^m),h=k,p=C,f=L,m=A,t+=4}return y.buffer}}class Gn{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?be(e,0,t-n):e}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise(((i,r)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const s=this.flush();s?i(s.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:r,remainderData:s}=this;this.logOnce("JS AES decrypt"),s&&(e=Xe(s,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(n=i);let o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new $n),o.expandKey(t);const l=r;return this.currentResult=o.decrypt(a.buffer,0,n),this.currentIV=be(a,-16).buffer,l||null}webCryptoDecrypt(e,t,n){const i=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new Un(i,t)),this.fastAesKey.expandKey().then((t=>i?(this.logOnce("WebCrypto AES decrypt"),new Bn(i,new Uint8Array(n)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized")))).catch((i=>(V.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,n))))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=be(e,0,n),this.remainderData=be(e,n)),t}logOnce(e){this.logEnabled&&(V.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Hn="STOPPED",zn="IDLE",qn="KEY_LOADING",jn="FRAG_LOADING",Yn="FRAG_LOADING_WAITING_RETRY",Vn="WAITING_TRACK",Kn="PARSING",Wn="PARSED",Xn="ENDED",Zn="ERROR",Qn="WAITING_INIT_PTS",Jn="WAITING_LEVEL";class ei extends class{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}{constructor(e,t,n,i,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Hn,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=i,this.log=V.log.bind(V,`${i}:`),this.warn=V.warn.bind(V,`${i}:`),this.hls=e,this.fragmentLoader=new kn(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Gn(e.config),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Hn}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1];return Dn.isBuffered(this.media,e.start+e.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Hn&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,s=n?n.currentTime:0,a=Dn.bufferInfo(i||n,s,e.maxBufferHole);if(this.log(`media seeking to ${$(s)?s.toFixed(3):s}, state: ${r}`),this.state===Xn)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(!a.len||r<a.start||i>a.end){const e=s>r;(s<i||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0),this.lastCurrentTime=s),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=Hn,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,(t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const n=this.state;this.fragContextChanged(e)?(n===jn||!this.fragCurrent&&n===Kn)&&(this.fragmentTracker.removeFragment(e),this.state=zn):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(G.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((t=>{this.state!==Hn&&this.state!==Zn&&(this.warn(t),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===bn){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength);this.reduceMaxBufferLength(r)&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===_n&&n.removeFragment(e))}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(G.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:n}=this,{payload:i}=t,r=e.decryptdata;if(i&&i.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch((t=>{throw n.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((i=>{const r=self.performance.now();return n.trigger(G.FRAG_DECRYPTED,{frag:e,payload:i,stats:{tstart:s,tdecrypt:r}}),t.payload=i,t}))}return t})).then((n=>{const{fragCurrent:i,hls:r,levels:s}=this;if(!s)throw new Error("init load aborted, missing levels");const a=e.stats;this.state=zn,t.fragmentError=0,e.data=new Uint8Array(n.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),n.frag===i&&r.trigger(G.FRAG_BUFFERED,{stats:a,frag:i,part:null,id:e.type}),this.tick()})).catch((t=>{this.state!==Hn&&this.state!==Zn&&(this.warn(t),this.resetFragmentLoading(e))}))}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,i,r,s;const a=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Rt?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(i=e.endPTS)?i:NaN).toFixed(3)}] > buffer:${a?function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+=`[${e.start(i).toFixed(3)}-${e.end(i).toFixed(3)}]`;return t}(Dn.getBuffered(a)):"(detached)"})`),this.state=zn,a&&(!this.loadedmetadata&&e.type==Rt&&a.buffered.length&&(null==(r=this.fragCurrent)?void 0:r.sn)===(null==(s=this.fragPrevious)?void 0:s.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some((e=>!e)),a=new Pn(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;const s=null==t?void 0:t.details;if(!this.levels||!s)throw new Error(`frag load aborted, missing level${s?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key?!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${s.startSN}-${s.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=qn,this.fragCurrent=e,a=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(G.KEY_LOADED,e),this.state===qn&&(this.state=zn),e})),this.hls.trigger(G.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const r=s.partList;if(r&&i){n>e.end&&s.fragmentHint&&(e=s.fragmentHint);const o=this.getNextPart(r,e,n);if(o>-1){const l=r[o];let c;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${s.startSN}-${s.endSN}] parts [0-${o}-${r.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=jn,c=a?a.then((n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,i))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,i).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(G.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${s?"of ["+s.startSN+"-"+s.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),$(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=jn;const o=this.config.progressive;let l;return l=o&&a?a.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,i))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,o?i:void 0),a]).then((([e])=>(!o&&e&&i&&i(e),e))).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(G.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,n,i){return new Promise(((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=t=>{this.fragmentLoader.loadPart(e,t,i).then((i=>{o[t.index]=i;const s=i.part;this.hls.trigger(G.FRAG_LOADED,i);const a=en(n,e.sn,t.index+1)||tn(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});c(a)})).catch(s)};c(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===z.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(G.ERROR,t)}else this.hls.trigger(G.ERROR,{type:H.OTHER_ERROR,details:z.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Kn)return void(this.fragCurrent||this.state===Hn||this.state===Zn||(this.state=zn));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s),this.updateLevelTiming(n,i,r,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn(`Levels object was unset while buffering fragment ${r} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],o=s>-1?en(a,r,s):null,l=o?o.fragment:function(e,t,n){if(null==e||!e.details)return null;const i=e.details;let r=i.fragments[t-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===t?r:t<i.startSN&&n&&n.sn===t?n:null)}(a,r,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:o,level:a}):null}bufferFragmentData(e,t,n,i,r){var s;if(!e||this.state!==Kn)return;const{data1:a,data2:o}=e;let l=a;if(a&&o&&(l=Xe(a,o)),null==(s=l)||!s.length)return;const c={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:l};if(this.hls.trigger(G.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Dn.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=Dn.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return $(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,r=Dn.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&r.nextStart<s.end)return Dn.bufferInfo(e,t,Math.max(r.nextStart,i))}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t="main"){const n=this.fragmentTracker.getAppendedFrag(e,Rt);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start;let a;if(t.live){const s=r.initialLiveManifestSize;if(i<s)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${s})`),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(a=this.getInitialLiveFragment(t,n),this.startPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=s&&(a=n[0]);if(!a){const n=r.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Tn||n===_n&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){const s=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(null===a)return a;if(e=a,s&&e&&!e.gap&&n.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(null!==t&&n.len+t.len>=r)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const l=o.loaded;l?i=-1:(r||o.independent||s)&&o.fragment===t&&(i=a),r=l}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!$(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(let i=0;i<e.length;++i){const r=e[i];if(un(t,n,r))return r}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=function(e,t){return ln(e,(e=>e.cc<t?1:e.cc>t?-1:0))}(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,l=i.maxFragLookUpTolerance,c=n.partList,d=!!(i.lowLatencyMode&&null!=c&&c.length&&o);let u;if(d&&o&&!this.bitrateTest&&(s=s.concat(o),a=o.sn),u=e<t?cn(r,s,e,e>t-l?0:l):s[s.length-1],u){const e=u.sn-n.startSN,t=this.fragmentTracker.getState(u);if((t===Tn||t===_n&&u.gap)&&(r=u),r&&u.sn===r.sn&&(!d||c[0].fragment.sn>u.sn)&&r&&u.level===r.level){const t=s[e+1];u=u.sn<a&&this.fragmentTracker.getState(t)!==Tn?t:null}}return u}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=n.currentTime,s=e.fragments[0].start,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!o&&n.readyState<4||r<a-s)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t){const{levels:n,levelLastLoaded:i,fragPrevious:r}=this,s=null!==i?n[i]:null,a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;const o=e.fragments[0].start,l=!t,c=e.alignedSliding&&$(o);if(l||!c&&!o){!function(e,t,n){t&&(function(e,t,n){if(function(e,t,n){return!(!t.details||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}(e,n,t)){const e=function(e,t,n=0){const i=e.fragments,r=t.fragments;if(!r.length||!i.length)return void V.log("No fragments to align");const s=Mn(i,r[0].cc);if(s&&(!s||s.startPTS))return s;V.log("No frag in previous level to align on")}(n.details,t);e&&$(e.start)&&(V.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),Nn(e.start,t))}}(e,n,t),!n.alignedSliding&&t.details&&function(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=t.fragments[0].programDateTime,i=e.fragments[0].programDateTime,r=(i-n)/1e3+t.fragments[0].start;r&&$(r)&&(V.log(`Adjusting PTS using programDateTime delta ${i-n}ms, sliding:${r.toFixed(3)} ${e.url} `),Nn(r,e))}(n,t.details),n.alignedSliding||!t.details||n.skippedSegments||Qt(t.details,n))}(r,s,e);const n=e.fragments[0].start;return this.log(`Live playlist sliding: ${n.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${r?r.sn:"na"} fragments: ${a}`),n}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const i=null!==this.startTimeOffset,r=i?this.startTimeOffset:e.startTimeOffset;null!==r&&$(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${r} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Yn)||(this.state=zn)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const r=t.details===z.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(n,!0);const s=t.errorAction,{action:a,retryCount:o=0,retryConfig:l}=s||{};if(s&&5===a&&l){var c;this.resetStartWhenNotLoaded(null!=(c=this.levelLastLoaded)?c:n.level);const i=sn(l,o);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${o+1}/${l.maxNumRetry} in ${i}ms`),s.resolved=!0,this.retryDate=self.performance.now()+i,this.state=Yn}else l&&s?(this.resetFragmentErrors(e),o<l.maxNumRetry?r||(s.resolved=!0):V.warn(`${t.details} reached or exceeded max retry (${o})`)):2===(null==s?void 0:s.action)?this.state=Jn:this.state=Zn;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Kn||this.state===Wn){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len);const r=!i;return r&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),r}return!1}resetFragmentErrors(e){e===It&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Hn&&(this.state=zn)}afterBufferFlushed(e,t,n){if(!e)return;const i=Dn.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Xn&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=zn}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var r;const s=n.details;if(s){if(Object.keys(e.elementaryStreams).reduce(((t,r)=>{const a=e.elementaryStreams[r];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${r} duration reliably (${o})`),t||!1;const l=i?0:Zt(s,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(G.LEVEL_PTS_UPDATED,{details:s,level:n,drift:l,type:r,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t}),!1))n.fragmentError=0;else if(null===(null==(r=this.transmuxer)?void 0:r.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Wn,this.hls.trigger(G.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){var t,n,i;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(n=this.levelLastLoaded)?n:null==(i=this.fragCurrent)?void 0:i.level)?t:0),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function ti(){return self.SourceBuffer||self.WebKitSourceBuffer}function ni(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class ii{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Xe(this.cachedData,e),this.cachedData=null);let n,i=Ee(e,0),r=i?i.length:0;const s=this._audioTrack,a=this._id3Track,o=i?(e=>{const t=Ce(e);for(let e=0;e<t.length;e++){const n=t[e];if(xe(n))return De(n)}})(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&$(o))&&(this.basePTS=ri(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:$t,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(e,r)){const t=this.appendFrame(s,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,n=r):r=l}else Se(e,r)?(i=Ee(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:$t,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const t=be(e,n);this.cachedData?this.cachedData=Xe(this.cachedData,t):this.cachedData=t}}return{audioTrack:s,videoTrack:ni(),id3Track:a,textTrack:ni()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:ni(),id3Track:this._id3Track,textTrack:ni()}}destroy(){}}const ri=(e,t,n)=>$(e)?90*e:9e4*t+(n?9e4*n.baseTime/n.timescale:0);function si(e,t){return 255===e[t]&&240==(246&e[t+1])}function ai(e,t){return 1&e[t+1]?7:9}function oi(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function li(e,t){return t+1<e.length&&si(e,t)}function ci(e,t){if(li(e,t)){const n=ai(e,t);if(t+n>=e.length)return!1;const i=oi(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||li(e,r)}return!1}function di(e,t,n,i,r){if(!e.samplerate){const s=function(e,t,n,i){let r,s,a,o;const l=navigator.userAgent.toLowerCase(),c=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&t[n+2])>>>6);const u=(60&t[n+2])>>>2;if(!(u>d.length-1))return a=(1&t[n+2])<<2,a|=(192&t[n+3])>>>6,V.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${u}`),/firefox/i.test(l)?u>=6?(r=5,o=new Array(4),s=u-3):(r=2,o=new Array(2),s=u):-1!==l.indexOf("android")?(r=2,o=new Array(2),s=u):(r=5,o=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&u>=6?s=u-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(u>=6&&1===a||/vivaldi/i.test(l))||!i&&1===a)&&(r=2,o=new Array(2)),s=u)),o[0]=r<<3,o[0]|=(14&u)>>1,o[1]|=(1&u)<<7,o[1]|=a<<3,5===r&&(o[1]|=(14&s)>>1,o[2]=(1&s)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:d[u],channelCount:a,codec:"mp4a.40."+r,manifestCodec:c};e.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${u}`})}(t,n,i,r);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,V.log(`parsed codec:${e.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function ui(e){return 9216e4/e}function hi(e,t,n,i,r){const s=i+r*ui(e.samplerate),a=function(e,t){const n=ai(e,t);if(t+n<=e.length){const i=oi(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}(t,n);let o;if(a){const{frameLength:i,headerLength:r}=a,l=r+i,c=Math.max(0,n+l-t.length);c?(o=new Uint8Array(l-r),o.set(t.subarray(n+r,t.length),0)):o=t.subarray(n+r,n+l);const d={unit:o,pts:s};return c||e.samples.push(d),{sample:d,length:l,missing:c}}const l=t.length-n;return o=new Uint8Array(l),o.set(t.subarray(n,t.length),0),{sample:{unit:o,pts:s},length:l,missing:-1}}const pi=/\/emsg[-/]ID3/i;let fi=null;const mi=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],gi=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],yi=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],vi=[0,1,1,4];function bi(e,t,n,i,r){if(n+24>t.length)return;const s=_i(t,n);if(s&&n+s.frameLength<=t.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:t.subarray(n,n+s.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function _i(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*mi[14*(3===n?3-i:3===i?3:4)+r-1],c=gi[3*(3===n?0:2===n?1:2)+s],d=3===o?1:2,u=yi[n][i],h=vi[i],p=8*u*h,f=Math.floor(u*l/c+a)*h;if(null===fi){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);fi=e?parseInt(e[1]):0}return!!fi&&fi<=87&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:c,channelCount:d,frameLength:f,samplesPerFrame:p}}}function Ti(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function Ei(e,t){return t+1<e.length&&Ti(e,t)}function wi(e,t){if(t+1<e.length&&Ti(e,t)){const n=4,i=_i(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||Ei(e,s)}return!1}class Si{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&V.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,n=8,i=8;for(let r=0;r<e;r++)0!==i&&(t=this.readEG(),i=(n+t+256)%256),n=0===i?n:i}readSPS(){let e,t,n,i=0,r=0,s=0,a=0;const o=this.readUByte.bind(this),l=this.readBits.bind(this),c=this.readUEG.bind(this),d=this.readBoolean.bind(this),u=this.skipBits.bind(this),h=this.skipEG.bind(this),p=this.skipUEG.bind(this),f=this.skipScalingList.bind(this);o();const m=o();if(l(5),u(3),o(),p(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){const e=c();if(3===e&&u(1),p(),p(),u(1),d())for(t=3!==e?8:12,n=0;n<t;n++)d()&&f(n<6?16:64)}p();const g=c();if(0===g)c();else if(1===g)for(u(1),h(),h(),e=c(),n=0;n<e;n++)h();p(),u(1);const y=c(),v=c(),b=l(1);0===b&&u(1),u(1),d()&&(i=c(),r=c(),s=c(),a=c());let _=[1,1];if(d()&&d())switch(o()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[o()<<8|o(),o()<<8|o()]}return{width:Math.ceil(16*(y+1)-2*i-2*r),height:(2-b)*(v+1)*16-(b?2:4)*(s+a),pixelRatio:_}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class xi{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Gn(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then((r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}))}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,n),this.decrypter.isSync())))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)n.set(e.subarray(t,t+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)e.set(n.subarray(i,i+16),t);return e}decryptAvcSample(e,t,n,i,r){const s=et(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}))}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;!(n>=r.length);n++){const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type||(this.decryptAvcSample(e,t,n,i,s),this.decrypter.isSync())))return}}}}const ki=188;class Ci{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(e){const t=Ci.syncOffset(e);return t>0&&V.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(940,e.length-ki)+1,i=0;for(;i<n;){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=ki){if(71!==e[o]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+18612,e.length-ki)+1)),r||(r=0===Ai(e,o)),r&&a>1&&(0===s&&a>2||o+ki>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Ue[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=Ci.createTrack("video"),this._audioTrack=Ci.createTrack("audio",i),this._id3Track=Ci.createTrack("id3"),this._txtTrack=Ci.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,n=!1,i=!1){let r;n||(this.sampleAes=null);const s=this._avcTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let c=s.pid,d=s.pesData,u=a.pid,h=o.pid,p=a.pesData,f=o.pesData,m=null,g=this.pmtParsed,y=this._pmtId,v=e.length;if(this.remainderData&&(v=(e=Xe(this.remainderData,e)).length,this.remainderData=null),v<ki&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const b=Math.max(0,Ci.syncOffset(e));v-=(v-b)%ki,v<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,v,e.buffer.byteLength-v));let _=0;for(let t=b;t<v;t+=ki)if(71===e[t]){const i=!!(64&e[t+1]),v=Ai(e,t);let _;if((48&e[t+3])>>4>1){if(_=t+5+e[t+4],_===t+ki)continue}else _=t+4;switch(v){case c:i&&(d&&(r=Di(d))&&this.parseAVCPES(s,l,r,!1),d={data:[],size:0}),d&&(d.data.push(e.subarray(_,t+ki)),d.size+=t+ki-_);break;case u:if(i){if(p&&(r=Di(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r)}p={data:[],size:0}}p&&(p.data.push(e.subarray(_,t+ki)),p.size+=t+ki-_);break;case h:i&&(f&&(r=Di(f))&&this.parseID3PES(o,r),f={data:[],size:0}),f&&(f.data.push(e.subarray(_,t+ki)),f.size+=t+ki-_);break;case 0:i&&(_+=e[_]+1),y=this._pmtId=Ri(e,_);break;case y:{i&&(_+=e[_]+1);const r=Ii(e,_,this.typeSupported,n);c=r.avc,c>0&&(s.pid=c),u=r.audio,u>0&&(a.pid=u,a.segmentCodec=r.segmentCodec),h=r.id3,h>0&&(o.pid=h),null===m||g||(V.warn(`MPEG-TS PMT found at ${t} after unknown PID '${m}'. Backtracking to sync byte @${b} to parse all TS packets.`),m=null,t=b-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=v}}else _++;if(_>0){const e=new Error(`Found ${_} TS packet/s that do not start with 0x47`);this.observer.emit(G.ERROR,G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message})}s.pesData=d,a.pesData=p,o.pesData=f;const T={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return i&&this.extractRemainingSamples(T),T}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let l;if(s&&(l=Di(s))?(this.parseAVCPES(n,r,l,!0),n.pesData=null):n.pesData=s,a&&(l=Di(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l)}t.pesData=null}else null!=a&&a.size&&V.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(l=Di(o))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new xi(this.observer,this.config,t);return this.decrypt(i,r)}decrypt(e,t){return new Promise((n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,(()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)})):n(e)})):r.samples&&t.decryptAvcSamples(r.samples,0,0,(()=>{n(e)}))}))}destroy(){this._duration=0}parseAVCPES(e,t,n,i){const r=this.parseAVCNALu(e,n.data);let s,a=this.avcSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(Pi(a,e),a=this.avcSample=Li(!1,n.pts,n.dts,"")),r.forEach((i=>{var r;switch(i.type){case 1:{let t=!1;s=!0;const r=i.data;if(o&&r.length>4){const e=new Si(r).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;t&&null!=(l=a)&&l.frame&&!a.key&&(Pi(a,e),a=this.avcSample=null),a||(a=this.avcSample=Li(!0,n.pts,n.dts,"")),a.frame=!0,a.key=t;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(Pi(a,e),a=this.avcSample=null),a||(a=this.avcSample=Li(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:s=!0,Je(i.data,1,n.pts,t.samples);break;case 7:if(s=!0,o=!0,!e.sps){const t=i.data,n=new Si(t).readSPS();e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t],e.duration=this._duration;const r=t.subarray(1,4);let s="avc1.";for(let e=0;e<3;e++){let t=r[e].toString(16);t.length<2&&(t="0"+t),s+=t}e.codec=s}break;case 8:s=!0,e.pps||(e.pps=[i.data]);break;case 9:s=!1,e.audFound=!0,a&&Pi(a,e),a=this.avcSample=Li(!1,n.pts,n.dts,"");break;case 12:s=!0;break;default:s=!1,a&&(a.debug+="unknown NAL "+i.type+" ")}a&&s&&a.units.push(i)})),i&&a&&(Pi(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let n,i=this.avcSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const r=i,s=[];let a,o,l,c=0,d=-1,u=0;for(-1===i&&(d=0,u=31&t[0],i=0,c=1);c<n;)if(a=t[c++],i)if(1!==i)if(a)if(1===a){if(d>=0){const e={data:t.subarray(d,c-i-1),type:u};s.push(e)}else{const n=this.getLastNalUnit(e.samples);if(n&&(r&&c<=4-r&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-r)),o=c-i-1,o>0)){const e=new Uint8Array(n.data.byteLength+o);e.set(n.data,0),e.set(t.subarray(0,o),n.data.byteLength),n.data=e,n.state=0}}c<n?(l=31&t[c],d=c,u=l,i=0):i=-1}else i=0;else i=3;else i=a?0:2;else i=a?0:1;if(d>=0&&i>=0){const e={data:t.subarray(d,n),type:u,state:i};s.push(e)}if(0===s.length){const n=this.getLastNalUnit(e.samples);if(n){const e=new Uint8Array(n.data.byteLength+t.byteLength);e.set(n.data,0),e.set(t,n.data.byteLength),n.data=e}}return e.naluState=i,s}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t){const e=new Uint8Array(r+o.byteLength);e.set(i.sample.unit,0),e.set(o,r),o=e}else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1&&!li(o,r);r++);if(r!==n){let e;const t=r<s-1;e=t?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES";const n=new Error(e);if(V.warn(`parsing error: ${e}`),this.observer.emit(G.ERROR,G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:n,reason:e}),!t)return}if(di(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void V.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=ui(e.samplerate);a=i.sample.pts+t}}let l,c=0;for(;r<s;){if(l=hi(e,o,r,a,c),r+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;r<s-1&&!li(o,r);r++);}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)for(;s<i;)if(Ei(n,s)){const t=bi(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else V.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(e,t){if(void 0===t.pts)return void V.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=U({},t,{type:this._avcTrack?Gt:$t,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Li(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}function Ai(e,t){return((31&e[t+1])<<8)+e[t+2]}function Ri(e,t){return(31&e[t+10])<<8|e[t+11]}function Ii(e,t,n,i){const r={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<s;){const s=Ai(e,t);switch(e[t]){case 207:if(!i){V.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===r.audio&&(r.audio=s);break;case 21:-1===r.id3&&(r.id3=s);break;case 219:if(!i){V.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===r.avc&&(r.avc=s);break;case 3:case 4:!0!==n.mpeg&&!0!==n.mp3?V.log("MPEG audio found, not supported in this browser"):-1===r.audio&&(r.audio=s,r.segmentCodec="mp3");break;case 36:V.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return r}function Di(e){let t,n,i,r,s,a=0;const o=e.data;if(!e||0===e.size)return null;for(;o[0].length<19&&o.length>1;){const e=new Uint8Array(o[0].length+o[1].length);e.set(o[0]),e.set(o[1],o[0].length),o[0]=e,o.splice(1,1)}if(t=o[0],1===(t[0]<<16)+(t[1]<<8)+t[2]){if(n=(t[4]<<8)+t[5],n&&n>e.size-6)return null;const l=t[7];192&l&&(r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,r-s>54e5&&(V.warn(`${Math.round((r-s)/9e4)}s delta between PTS and DTS, align them`),r=s)):s=r),i=t[8];let c=i+9;if(e.size<=c)return null;e.size-=c;const d=new Uint8Array(e.size);for(let e=0,n=o.length;e<n;e++){t=o[e];let n=t.byteLength;if(c){if(c>n){c-=n;continue}t=t.subarray(c),n-=c,c=0}d.set(t,a),a+=n}return n&&(n-=i+3),{data:d,pts:r,dts:s,len:n}}return null}function Pi(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&V.log(e.pts+"/"+e.dts+":"+e.debug)}class Mi{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const Oi=Math.pow(2,32)-1;class Ni{static init(){let e;for(e in Ni.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Ni.types)Ni.types.hasOwnProperty(e)&&(Ni.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ni.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Ni.STTS=Ni.STSC=Ni.STCO=r,Ni.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ni.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ni.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ni.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Ni.FTYP=Ni.box(Ni.types.ftyp,s,o,s,a),Ni.DINF=Ni.box(Ni.types.dinf,Ni.box(Ni.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;for(;i--;)n+=t[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(e,4),i=0,n=8;i<r;i++)s.set(t[i],n),n+=t[i].byteLength;return s}static hdlr(e){return Ni.box(Ni.types.hdlr,Ni.HDLR_TYPES[e])}static mdat(e){return Ni.box(Ni.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Oi+1)),i=Math.floor(t%(Oi+1));return Ni.box(Ni.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return Ni.box(Ni.types.mdia,Ni.mdhd(e.timescale,e.duration),Ni.hdlr(e.type),Ni.minf(e))}static mfhd(e){return Ni.box(Ni.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?Ni.box(Ni.types.minf,Ni.box(Ni.types.smhd,Ni.SMHD),Ni.DINF,Ni.stbl(e)):Ni.box(Ni.types.minf,Ni.box(Ni.types.vmhd,Ni.VMHD),Ni.DINF,Ni.stbl(e))}static moof(e,t,n){return Ni.box(Ni.types.moof,Ni.mfhd(e),Ni.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=Ni.trak(e[t]);return Ni.box.apply(null,[Ni.types.moov,Ni.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(Ni.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=Ni.trex(e[t]);return Ni.box.apply(null,[Ni.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Oi+1)),i=Math.floor(t%(Oi+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ni.box(Ni.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Ni.box(Ni.types.sdtp,n)}static stbl(e){return Ni.box(Ni.types.stbl,Ni.stsd(e),Ni.box(Ni.types.stts,Ni.STTS),Ni.box(Ni.types.stsc,Ni.STSC),Ni.box(Ni.types.stsz,Ni.STSZ),Ni.box(Ni.types.stco,Ni.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=Ni.box(Ni.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,l=e.height,c=e.pixelRatio[0],d=e.pixelRatio[1];return Ni.box(Ni.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Ni.box(Ni.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ni.box(Ni.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return Ni.box(Ni.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),Ni.box(Ni.types.esds,Ni.esds(e)))}static mp3(e){const t=e.samplerate;return Ni.box(Ni.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?Ni.box(Ni.types.stsd,Ni.STSD,Ni.mp3(e)):Ni.box(Ni.types.stsd,Ni.STSD,Ni.mp4a(e)):Ni.box(Ni.types.stsd,Ni.STSD,Ni.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,r=e.height,s=Math.floor(n/(Oi+1)),a=Math.floor(n%(Oi+1));return Ni.box(Ni.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=Ni.sdtp(e),i=e.id,r=Math.floor(t/(Oi+1)),s=Math.floor(t%(Oi+1));return Ni.box(Ni.types.traf,Ni.box(Ni.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),Ni.box(Ni.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),Ni.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,Ni.box(Ni.types.trak,Ni.tkhd(e),Ni.mdia(e))}static trex(e){const t=e.id;return Ni.box(Ni.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,l,c,d,u;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],l=o.duration,c=o.size,d=o.flags,u=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*a);return Ni.box(Ni.types.trun,s)}static initSegment(e){Ni.types||Ni.init();const t=Ni.moov(e),n=new Uint8Array(Ni.FTYP.byteLength+t.byteLength);return n.set(Ni.FTYP),n.set(t,Ni.FTYP.byteLength),n}}function Fi(e,t,n=1,i=!1){const r=e*t*n;return i?Math.round(r):r}function Bi(e,t=!1){return Fi(e,1e3,1/9e4,t)}Ni.types=void 0,Ni.HDLR_TYPES=void 0,Ni.STTS=void 0,Ni.STSC=void 0,Ni.STCO=void 0,Ni.STSZ=void 0,Ni.VMHD=void 0,Ni.SMHD=void 0,Ni.STSD=void 0,Ni.FTYP=void 0,Ni.DINF=void 0;let Ui,$i=null,Gi=null;class Hi{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===$i){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);$i=e?parseInt(e[1]):0}if(null===Gi){const e=navigator.userAgent.match(/Safari\/(\d+)/i);Gi=e?parseInt(e[1]):0}}destroy(){}resetTimeStamp(e){V.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){V.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){V.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const n=e.reduce(((e,n)=>{const i=n.pts-e;return i<-4294967296?(t=!0,zi(e,n.pts)):i>0?e:n.pts}),e[0].pts);return t&&V.debug("PTS rollover detected"),n}remux(e,t,n,i,r,s,a,o){let l,c,d,u,h,p,f=r,m=r;const g=e.pid>-1,y=t.pid>-1,v=t.samples.length,b=e.samples.length>0,_=a&&v>0||v>1;if((!g||b)&&(!y||_)||this.ISGenerated||a){this.ISGenerated||(d=this.generateIS(e,t,r,s));const n=this.isVideoContiguous;let i,a=-1;if(_&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,a>0){V.warn(`[mp4-remuxer]: Dropped ${a} out of ${v} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,i=m}else-1===a&&(V.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),p=!1);if(this.ISGenerated){if(b&&_){const n=this.getVideoStartPts(t.samples),i=(zi(e.samples[0].pts,n)-n)/t.inputTimeScale;f+=Math.max(0,i),m+=Math.max(0,-i)}if(b){if(e.samplerate||(V.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,r,s)),c=this.remuxAudio(e,f,this.isAudioContiguous,s,y||_||o===It?m:void 0),_){const i=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(V.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,r,s)),l=this.remuxVideo(t,m,n,i)}}else _&&(l=this.remuxVideo(t,m,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=qi(n,r,this._initPTS,this._initDTS)),i.samples.length&&(u=ji(i,r,this._initPTS))),{audio:c,video:l,initSegment:d,independent:p,text:u,id3:h}}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},l=this._initPTS;let c,d,u,h=!l||i,p="audio/mp4";if(h&&(c=d=1/0),e.config&&r.length&&(e.timescale=e.samplerate,"mp3"===e.segmentCodec&&(a.mpeg?(p="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3")),o.audio={id:"audio",container:p,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):Ni.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(u=e.inputTimeScale,l&&u===l.timescale?h=!1:c=d=r[0].pts-Math.round(u*n))),t.sps&&t.pps&&s.length&&(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Ni.initSegment([t]),metadata:{width:t.width,height:t.height}},h))if(u=t.inputTimeScale,l&&u===l.timescale)h=!1;else{const e=this.getVideoStartPts(s),t=Math.round(u*n);d=Math.min(d,zi(s[0].dts,e)-t),c=Math.min(c,e-t)}if(Object.keys(o).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:c,timescale:u},this._initDTS={baseTime:d,timescale:u}):c=u=void 0,{tracks:o,initPTS:c,timescale:u}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,a=[],o=s.length,l=this._initPTS;let c,d,u=this.nextAvcDts,h=8,p=this.videoSampleDuration,f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=!1;n&&null!==u||(u=t*r-(s[0].pts-zi(s[0].dts,s[0].pts)));const y=l.baseTime*r/l.timescale;for(let e=0;e<o;e++){const t=s[e];t.pts=zi(t.pts-y,u),t.dts=zi(t.dts-y,u),t.dts<s[e>0?e-1:e].dts&&(g=!0)}g&&s.sort((function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i})),c=s[0].dts,d=s[s.length-1].dts;const v=d-c,b=v?Math.round(v/(o-1)):p||e.inputTimeScale/30;if(n){const e=c-u,t=e>b,n=e<-1;if((t||n)&&(t?V.warn(`AVC: ${Bi(e,!0)} ms (${e}dts) hole between fragments detected, filling it`):V.warn(`AVC: ${Bi(-e,!0)} ms (${e}dts) overlapping between fragments detected`),!n||u>=s[0].pts)){c=u;const t=s[0].pts-e;s[0].dts=c,s[0].pts=t,V.log(`Video: First PTS/DTS adjusted: ${Bi(t,!0)}/${Bi(c,!0)}, delta: ${Bi(e,!0)} ms`)}}c=Math.max(0,c);let _=0,T=0;for(let e=0;e<o;e++){const t=s[e],n=t.units,i=n.length;let r=0;for(let e=0;e<i;e++)r+=n[e].data.length;T+=r,_+=i,t.length=r,t.dts=Math.max(t.dts,c),f=Math.min(t.pts,f),m=Math.max(t.pts,m)}d=s[o-1].dts;const E=T+4*_+8;let w;try{w=new Uint8Array(E)}catch(e){return void this.observer.emit(G.ERROR,G.ERROR,{type:H.MUX_ERROR,details:z.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:E,reason:`fail allocating video mdat ${E}`})}const S=new DataView(w.buffer);S.setUint32(0,E),w.set(Ni.types.mdat,4);let x=!1,k=Number.POSITIVE_INFINITY,C=Number.POSITIVE_INFINITY,L=Number.NEGATIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){const t=s[e],n=t.units;let l,c=0;for(let e=0,t=n.length;e<t;e++){const t=n[e],i=t.data,r=t.data.byteLength;S.setUint32(h,r),h+=4,w.set(i,h),h+=r,c+=4+r}if(e<o-1)p=s[e+1].dts-t.dts,l=s[e+1].pts-t.pts;else{const n=this.config,a=e>0?t.dts-s[e-1].dts:b;if(l=e>0?t.pts-s[e-1].pts:b,n.stretchShortVideoTrack&&null!==this.nextAudioPts){const e=Math.floor(n.maxBufferHole*r),s=(i?f+i*r:this.nextAudioPts)-t.pts;s>e?(p=s-a,p<0?p=a:x=!0,V.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=a}else p=a}const d=Math.round(t.pts-t.dts);k=Math.min(k,p),L=Math.max(L,p),C=Math.min(C,l),A=Math.max(A,l),a.push(new Yi(t.key,p,c,d))}if(a.length)if($i){if($i<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(Gi&&A-C<L-k&&b/L<.025&&0===a[0].cts){V.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=c;for(let t=0,n=a.length;t<n;t++){const i=e+a[t].duration,r=e+a[t].cts;if(t<n-1){const e=i+a[t+1].cts;a[t].duration=e-r}else a[t].duration=t?a[t-1].duration:b;a[t].cts=0,e=i}}p=x||!p?b:p,this.nextAvcDts=u=d+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const R={data1:Ni.moof(e.sequenceNumber++,c,U({},e,{samples:a})),data2:w,startPTS:f/r,endPTS:(m+p)/r,startDTS:c/r,endDTS:u/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,R}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,a=s/(e.samplerate?e.samplerate:s),o="aac"===e.segmentCodec?1024:1152,l=o*a,c=this._initPTS,d="mp3"===e.segmentCodec&&this.typeSupported.mpeg,u=[],h=void 0!==r;let p=e.samples,f=d?0:8,m=this.nextAudioPts||-1;const g=t*s,y=c.baseTime*s/c.timescale;if(this.isAudioContiguous=n=n||p.length&&m>0&&(i&&Math.abs(g-m)<9e3||Math.abs(zi(p[0].pts-y,g)-m)<20*l),p.forEach((function(e){e.pts=zi(e.pts-y,g)})),!n||m<0){if(p=p.filter((e=>e.pts>=0)),!p.length)return;m=0===r?0:i&&!h?Math.max(0,g):p[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=m;n<p.length;n++){const r=p[n],a=r.pts,o=a-i,c=Math.abs(1e3*o/s);if(o<=-t*l&&h)0===n&&(V.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=m=i=a);else if(o>=t*l&&c<1e4&&h){let t=Math.round(o/l);i=a-t*l,i<0&&(t--,i+=l),0===n&&(this.nextAudioPts=m=i),V.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(i/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let s=0;s<t;s++){const t=Math.max(i,0);let s=Mi.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);s||(V.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),s=r.unit.subarray()),p.splice(n,0,{unit:s,pts:t}),i+=l,n++}}r.pts=i,i+=l}}let v,b=null,_=null,T=0,E=p.length;for(;E--;)T+=p[E].unit.byteLength;for(let t=0,i=p.length;t<i;t++){const i=p[t],r=i.unit;let s=i.pts;if(null!==_)u[t-1].duration=Math.round((s-_)/a);else{if(n&&"aac"===e.segmentCodec&&(s=m),b=s,!(T>0))return;T+=f;try{v=new Uint8Array(T)}catch(e){return void this.observer.emit(G.ERROR,G.ERROR,{type:H.MUX_ERROR,details:z.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:T,reason:`fail allocating audio mdat ${T}`})}d||(new DataView(v.buffer).setUint32(0,T),v.set(Ni.types.mdat,4))}v.set(r,f);const l=r.byteLength;f+=l,u.push(new Yi(!0,o,l,0)),_=s}const w=u.length;if(!w)return;const S=u[u.length-1];this.nextAudioPts=m=_+a*S.duration;const x=d?new Uint8Array(0):Ni.moof(e.sequenceNumber++,b/a,U({},e,{samples:u}));e.samples=[];const k=b/s,C=m/s,L={data1:x,data2:v,startPTS:k,endPTS:C,startDTS:k,endDTS:C,type:"audio",hasAudio:!0,hasVideo:!1,nb:w};return this.isAudioContiguous=!0,L}remuxEmptyAudio(e,t,n,i){const r=e.inputTimeScale,s=r/(e.samplerate?e.samplerate:r),a=this.nextAudioPts,o=this._initDTS,l=9e4*o.baseTime/o.timescale,c=(null!==a?a:i.startDTS*r)+l,d=i.endDTS*r+l,u=1024*s,h=Math.ceil((d-c)/u),p=Mi.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(V.warn("[mp4-remuxer]: remux empty Audio"),!p)return void V.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const f=[];for(let e=0;e<h;e++){const t=c+e*u;f.push({unit:p,pts:t,dts:t})}return e.samples=f,this.remuxAudio(e,t,n,!1)}}function zi(e,t){let n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function qi(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let a=0;a<r;a++){const r=e.samples[a];r.pts=zi(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=zi(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function ji(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let s=0;s<i;s++){const i=e.samples[s];i.pts=zi(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort(((e,t)=>e.pts-t.pts));const s=e.samples;return e.samples=[],{samples:s}}class Yi{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags=new Vi(e)}}class Vi{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function Ki(e,t){const n=null==e?void 0:e.codec;return n&&n.length>4?n:"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1"===n||t===te?"avc1.42e01e":"mp4a.40.5"}try{Ui=self.performance.now.bind(self.performance)}catch(e){V.debug("Unable to use Performance API on this environment"),Ui="undefined"!=typeof self&&self.Date.now}const Wi=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=ni("video",1),s=this.audioTrack=ni("audio",1),a=this.txtTrack=ni("text",1);if(this.id3Track=ni("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=Ve(e);if(o.video){const{id:e,timescale:t,codec:n}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=Ue.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return je(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Xe(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},n=je(e,["moof"]);if(!n)return t;if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=be(e,0,i.byteOffset-8),t.remainder=be(e,i.byteOffset-8),t}(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=Ze(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Ze(e,t),{videoTrack:t,audioTrack:ni(),id3Track:i,textTrack:ni()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=je(e.samples,["emsg"]);i&&i.forEach((e=>{const i=function(e){const t=e[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,c=0;if(0===t){for(;"\0"!==$e(e.subarray(c,c+1));)n+=$e(e.subarray(c,c+1)),c+=1;for(n+=$e(e.subarray(c,c+1)),c+=1;"\0"!==$e(e.subarray(c,c+1));)i+=$e(e.subarray(c,c+1)),c+=1;i+=$e(e.subarray(c,c+1)),c+=1,r=He(e,12),s=He(e,16),o=He(e,20),l=He(e,24),c=28}else if(1===t){c+=4,r=He(e,c),c+=4;const t=He(e,c);c+=4;const s=He(e,c);for(c+=4,a=2**32*t+s,Number.isSafeInteger(a)||(a=Number.MAX_SAFE_INTEGER,V.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=He(e,c),c+=4,l=He(e,c),c+=4;"\0"!==$e(e.subarray(c,c+1));)n+=$e(e.subarray(c,c+1)),c+=1;for(n+=$e(e.subarray(c,c+1)),c+=1;"\0"!==$e(e.subarray(c,c+1));)i+=$e(e.subarray(c,c+1)),c+=1;i+=$e(e.subarray(c,c+1)),c+=1}return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:e.subarray(c,e.byteLength)}}(e);if(pi.test(i.schemeIdUri)){const e=$(i.presentationTime)?i.presentationTime/i.timeScale:t+i.presentationTimeDelta/i.timeScale;let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:Gt,duration:r})}}))}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(function(e,t){if(!e||!t)return e;const n=t.keyId;return n&&t.isCommonEncryption&&je(e,["moov","trak"]).forEach((e=>{const t=je(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let i=je(t,["enca"]);const r=i.length>0;r||(i=je(t,["encv"])),i.forEach((e=>{je(r?e.subarray(28):e.subarray(78),["sinf"]).forEach((e=>{const t=Ke(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(V.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${Ne(e)} -> ${Ne(n)}`),t.set(n,8))}}))}))})),e}(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const i=this.initData=Ve(e);t||(t=Ki(i.audio,ee)),n||(n=Ki(i.video,te));const r={};i.audio&&i.video?r.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?r.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?r.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:V.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(e,t,n,i,r,s){var a,o;let{initPTS:l,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};$(c)||(c=this.lastEndTime=r||0);const u=t.samples;if(null==u||!u.length)return d;const h={initPTS:void 0,timescale:1};let p=this.initData;if(null!=(a=p)&&a.length||(this.generateInitSegment(u),p=this.initData),null==(o=p)||!o.length)return V.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const f=function(e,t){let n=0,i=0,r=0;const s=je(e,["moof","traf"]);for(let e=0;e<s.length;e++){const a=s[e],o=je(a,["tfhd"])[0],l=t[He(o,4)];if(!l)continue;const c=l.default,d=He(o,0)|(null==c?void 0:c.flags);let u=null==c?void 0:c.duration;8&d&&(u=He(o,2&d?12:8));const h=l.timescale||9e4,p=je(a,["trun"]);for(let e=0;e<p.length;e++)n=We(p[e]),!n&&u&&(n=u*He(p[e],4)),l.type===te?i+=n/h:l.type===ee&&(r+=n/h)}if(0===i&&0===r){let t=0;const n=je(e,["sidx"]);for(let e=0;e<n.length;e++){const i=Ye(n[e]);null!=i&&i.references&&(t+=i.references.reduce(((e,t)=>e+t.info.duration||0),0))}return t}return i||r}(u,p),m=function(e,t){return je(t,["moof","traf"]).reduce(((t,n)=>{const i=je(n,["tfdt"])[0],r=i[0],s=je(n,["tfhd"]).reduce(((t,n)=>{const s=He(n,4),a=e[s];if(a){let e=He(i,4);if(1===r){if(e===Fe)return V.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=Fe+1,e+=He(i,8)}const n=e/(a.timescale||9e4);if(isFinite(n)&&(null===t||n<t))return n}return t}),null);return null!==s&&isFinite(s)&&(null===t||s<t)?s:t}),null)}(p,u),g=null===m?r:m;(function(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}(l,g,r,f)||h.timescale!==l.timescale&&s)&&(h.initPTS=g-r,l&&1===l.timescale&&V.warn("Adjusting initPTS by "+(h.initPTS-l.baseTime)),this.initPTS=l={baseTime:h.initPTS,timescale:1});const y=e?g-l.baseTime/l.timescale:c,v=y+f;!function(e,t,n){je(t,["moof","traf"]).forEach((t=>{je(t,["tfhd"]).forEach((i=>{const r=He(i,4),s=e[r];if(!s)return;const a=s.timescale||9e4;je(t,["tfdt"]).forEach((e=>{const t=e[0];let i=He(e,4);if(0===t)i-=n*a,i=Math.max(i,0),qe(e,4,i);else{i*=Math.pow(2,32),i+=He(e,8),i-=n*a,i=Math.max(i,0);const t=Math.floor(i/(Fe+1)),r=Math.floor(i%(Fe+1));qe(e,4,t),qe(e,8,r)}}))}))}))}(p,u,l.baseTime/l.timescale),f>0?this.lastEndTime=v:(V.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!p.audio,_=!!p.video;let T="";b&&(T+="audio"),_&&(T+="video");const E={data1:u,startPTS:y,startDTS:y,endPTS:v,endDTS:v,type:T,hasAudio:b,hasVideo:_,nb:1,dropped:0};return d.audio="audio"===E.type?E:void 0,d.video="audio"!==E.type?E:void 0,d.initSegment=h,d.id3=qi(n,r,l,l),i.samples.length&&(d.text=ji(i,r,l)),d}}},{demux:Ci,remux:Hi},{demux:class extends ii{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(Ee(e,0)||[]).length;for(let n=e.length;t<n;t++)if(ci(e,t))return V.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&si(e,t)&&oi(e,t)<=e.length-t}(e,t)}appendFrame(e,t,n){di(e,this.observer,t,n,e.manifestCodec);const i=hi(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}},remux:Hi},{demux:class extends ii{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(Ee(e,0)||[]).length;for(let n=e.length;t<n;t++)if(wi(e,t))return V.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return Ti(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return bi(e,t,n,this.basePTS,this.frameIndex)}},remux:Hi}];class Xi{constructor(e,t,n,i,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=Ui();let s=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:o}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:c,trackSwitch:d,accurateTimeOffset:u,timeOffset:h,initSegmentChange:p}=i||a,{audioCodec:f,videoCodec:m,defaultInitPts:g,duration:y,initSegmentData:v}=o,b=function(e,t){let n=null;return e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(n=t),n}(s,t);if(b&&"AES-128"===b.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(s,b.key.buffer,b.iv.buffer).then((e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t})),this.decryptionPromise;{let t=e.softwareDecrypt(s,b.key.buffer,b.iv.buffer);if(n.part>-1&&(t=e.flush()),!t)return r.executeEnd=Ui(),Zi(n);s=new Uint8Array(t)}}const _=this.needsProbing(c,d);if(_){const e=this.configureTransmuxer(s);if(e)return V.warn(`[transmuxer] ${e.message}`),this.observer.emit(G.ERROR,G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=Ui(),Zi(n)}(c||d||p||_)&&this.resetInitSegment(v,f,m,y,t),(c||p||_)&&this.resetInitialTimestamp(g),l||this.resetContiguity();const T=this.transmux(s,b,h,u,n),E=this.currentTransmuxState;return E.contiguous=!0,E.discontinuity=!1,E.trackSwitch=!1,r.executeEnd=Ui(),T}flush(e){const t=e.transmuxing;t.executeStart=Ui();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return r.then((()=>this.flush(e)));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t,null,e))}const{demuxer:o,remuxer:l}=this;if(!o||!l)return t.executeEnd=Ui(),[Zi(e)];const c=o.flush(a);return Qi(c)?c.then((t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,c,e),s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;V.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(i,r,s,a,l,o,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=Ui()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then((e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id),chunkMeta:r})))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:r}=this;let s;for(let t=0,n=Wi.length;t<n;t++)if(Wi[t].demux.probe(e)){s=Wi[t];break}if(!s)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,l=s.remux,c=s.demux;o&&o instanceof l||(this.remuxer=new l(n,t,i,r)),a&&a instanceof c||(this.demuxer=new c(n,t,i),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Gn(this.config)),e}}const Zi=e=>({remuxResult:{},chunkMeta:e});function Qi(e){return"then"in e&&e.then instanceof Function}class Ji{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class er{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}var tr={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,i),!0;case 4:return d.fn.call(d.context,t,i,r),!0;case 5:return d.fn.call(d.context,t,i,r,s),!0;case 6:return d.fn.call(d.context,t,i,r,s,a),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var h,p=d.length;for(c=0;c<p;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,i);break;case 4:d[c].fn.call(d[c].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];d[c].fn.apply(d[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],d=o.length;l<d;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(tr);var nr=L(tr.exports);const ir=ct()||{isTypeSupported:()=>!1};class rr{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===G.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new nr,this.observer.on(G.FRAG_DECRYPTED,s),this.observer.on(G.ERROR,s);const a={mp4:ir.isTypeSupported("video/mp4"),mpeg:ir.isTypeSupported("audio/mpeg"),mp3:ir.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(!this.useWorker||"undefined"==typeof Worker||!r.workerPath&&"function"!=typeof __HLS_WORKER_BUNDLE__)this.transmuxer=new Xi(this.observer,a,r,o,t);else try{r.workerPath?(V.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=function(e){const t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(r.workerPath)):(V.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const n=new Error(`${e.message}  (${e.filename}:${e.lineno})`);r.enableWorker=!1,V.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(G.ERROR,{type:H.OTHER_ERROR,details:z.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:n})},e.postMessage({cmd:"init",typeSupported:a,vendor:o,id:t,config:JSON.stringify(r)})}catch(e){V.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new Xi(this.observer,a,r,o,t)}}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,l,c){var d,u;l.transmuxing.start=self.performance.now();const{transmuxer:h}=this,p=s?s.start:r.start,f=r.decryptdata,m=this.frag,g=!(m&&r.cc===m.cc),y=!(m&&l.level===m.level),v=m?l.sn-m.sn:-1,b=this.part?l.part-this.part.index:-1,_=0===v&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),T=!y&&(1===v||0===v&&(1===b||_&&b<=0)),E=self.performance.now();(y||v||0===r.stats.parsing.start)&&(r.stats.parsing.start=E),!s||!b&&T||(s.stats.parsing.start=E);const w=!(m&&(null==(d=r.initSegment)?void 0:d.url)===(null==(u=m.initSegment)?void 0:u.url)),S=new er(g,T,o,y,p,w);if(!T||g||w){V.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${g}\n        trackSwitch: ${y}\n        contiguous: ${T}\n        accurateTimeOffset: ${o}\n        timeOffset: ${p}\n        initSegmentChange: ${w}`);const e=new Ji(n,i,t,a,c);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:f,chunkMeta:l,state:S},e instanceof ArrayBuffer?[e]:[]);else if(h){const t=h.push(e,f,l,S);Qi(t)?(h.async=!0,t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Qi(n)||t.async?(Qi(n)||(n=Promise.resolve(n)),n.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}onWorkerMessage(e){const t=e.data,n=this.hls;switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":V[t.data.logType]&&V[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class sr{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:r}=this;if(null===i)return;const{currentTime:s,seeking:a}=i,o=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,s!==e){if(this.moved=!0,null!==r){if(this.stallReported){const e=self.performance.now()-r;V.warn(`playback not stuck anymore @${s}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(l||o)return void(this.stalled=null);if(i.paused&&!a||i.ended||0===i.playbackRate||!Dn.getBuffered(i).length)return;const c=Dn.bufferInfo(i,s,0),d=c.len>0,u=c.nextStart||0;if(!d&&!u)return;if(a){const e=c.len>2,n=!u||t&&t.start<=s||u-s>2&&!this.fragmentTracker.getPartialFragment(s);if(e||n)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var h;const e=Math.max(u,c.start||0)-s,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,n=(null==t||null==(h=t.details)?void 0:h.live)?2*t.details.targetduration:2,i=this.fragmentTracker.getPartialFragment(s);if(e>0&&(e<=n||i))return void this._trySkipBufferHole(i)}const p=self.performance.now();if(null===r)return void(this.stalled=p);const f=p-r;if(!a&&f>=250&&(this._reportStall(c),!this.media))return;const m=Dn.bufferInfo(i,s,n.maxBufferHole);this._tryFixBufferStall(m,f)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:r}=this;if(null===r)return;const s=r.currentTime,a=i.getPartialFragment(s);(!a||!this._trySkipBufferHole(a)&&this.media)&&(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-s<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(V.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const i=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);V.warn(i.message),t.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(null===i)return 0;const r=i.currentTime,s=Dn.bufferInfo(i,r,0),a=r<s.start?s.start:s.nextStart;if(a){const o=s.len<=t.maxBufferHole,l=s.len>0&&s.len<1&&i.readyState<3,c=a-r;if(c>0&&(o||l)){if(c>t.maxBufferHole){const{fragmentTracker:t}=this;let n=!1;if(0===r){const e=t.getAppendedFrag(0,Rt);e&&a<e.end&&(n=!0)}if(!n){const n=e||t.getAppendedFrag(r,Rt);if(n){let e=!1,i=n.end;for(;i<a;){const n=t.getPartialFragment(i);if(!n){e=!0;break}i+=n.duration}if(e)return 0}}}const s=Math.max(a+.05,r+.1);if(V.warn(`skipping hole, adjusting currentTime from ${r} to ${s}`),this.moved=!0,this.stalled=null,i.currentTime=s,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${s}`);n.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return s}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(null===n)return;const r=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const s=r+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${s}`);V.warn(a.message),n.currentTime=s,t.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const n=new Error(`Playhead still not moving while enough data buffered @${r} after ${e.nudgeMaxRetry} nudges`);V.error(n.message),t.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}}class ar extends ei{constructor(e,t,n){super(e,t,n,"[stream-controller]",Rt),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(G.ERROR,this.onError,this),e.on(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(G.BUFFER_CREATED,this.onBufferCreated,this),e.on(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(G.ERROR,this.onError,this),e.off(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(G.BUFFER_CREATED,this.onBufferCreated,this),e.off(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=n.startLevel;-1===e&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.nextAutoLevel),this.level=n.nextLoadLevel=e,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=zn,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Hn}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Jn:{var e;const{levels:t,level:n}=this,i=null==t||null==(e=t[n])?void 0:e.details;if(i&&(!i.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(i))break;this.state=zn;break}if(this.hls.nextLoadLevel!==this.level){this.state=zn;break}break}case Yn:{var t;const e=self.performance.now(),n=this.retryDate;(!n||e>=n||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=zn)}}this.state===zn&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this,{config:r,nextLoadLevel:s}=e;if(null===t||!i&&(this.startFragRequested||!r.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;if(null==n||!n[s])return;const a=n[s],o=this.getMainFwdBufferInfo();if(null===o)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(G.BUFFER_EOS,e),void(this.state=Xn)}e.loadLevel!==s&&-1===e.manualLevel&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const c=a.details;if(!c||this.state===Jn||c.live&&this.levelLastLoaded!==s)return this.level=s,void(this.state=Jn);const d=o.len,u=this.getMaxBufferLength(a.maxBitrate);if(d>=u)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:o.end;let p=this.getNextFragment(h,c);if(this.couldBacktrack&&!this.fragPrevious&&p&&"initSegment"!==p.sn&&this.fragmentTracker.getState(p)!==Tn){var f;const e=(null!=(f=this.backtrackFragment)?f:p).sn-c.startSN,t=c.fragments[e-1];t&&p.cc===t.cc&&(p=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,h)){if(!p.gap){const e=this.audioOnly&&!this.altAudio?ee:te,t=(e===te?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Rt)}p=this.getNextFragmentLoopLoading(p,c,o,Rt,u)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,a,h))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===vn||i===_n?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Rt)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*i)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,.5*n),.75*n));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case qn:case jn:case Yn:case Kn:case Wn:this.state=zn}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new sr(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;$(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(G.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let n,i=!1,r=!1;t.levels.forEach((e=>{n=e.audioCodec,n&&(-1!==n.indexOf("mp4a.40.2")&&(i=!0),-1!==n.indexOf("mp4a.40.5")&&(r=!0))})),this.audioCodecSwitch=i&&r&&!function(){var e;const t=ti();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==zn)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(i.details))&&(this.state=Jn)}onLevelLoaded(e,t){var n;const{levels:i}=this,r=t.level,s=t.details,a=s.totalduration;if(!i)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""}, cc [${s.startCC}, ${s.endCC}] duration:${a}`);const o=i[r],l=this.fragCurrent;!l||this.state!==jn&&this.state!==Yn||l.level===t.level&&l.urlId===o.urlId||!l.loader||this.abortCurrentFrag();let c=0;if(s.live||null!=(n=o.details)&&n.live){if(s.fragments[0]||(s.deltaUpdateFailed=!0),s.deltaUpdateFailed)return;c=this.alignPlaylists(s,o.details)}if(o.details=s,this.levelLastLoaded=r,this.hls.trigger(G.LEVEL_UPDATED,{details:s,level:r}),this.state===Jn){if(this.waitForCdnTuneIn(s))return;this.state=zn}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=s[n.level],o=a.details;if(!o)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,c=o.PTSKnown||!o.live,d=null==(t=n.initSegment)?void 0:t.data,u=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new rr(this.hls,Rt,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=i?i.index:-1,f=-1!==p,m=new Pn(n.level,n.sn,n.stats.chunkCount,r.byteLength,p,f),g=this.initPTS[n.cc];h.push(r,d,u,l,n,i,o.totalduration,c,m,g)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;n&&(e.trigger(G.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(G.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const e in n){const t=n[e];if("main"===t.id){if(r=e,i=t,"video"===e){const t=n[e];t&&(this.videoBuffer=t.buffer)}}else s=!0}s&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==Rt)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Wn&&(this.state=zn));const r=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal)this.state=Zn;else switch(t.details){case z.FRAG_GAP:case z.FRAG_PARSING_ERROR:case z.FRAG_DECRYPT_ERROR:case z.FRAG_LOAD_ERROR:case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_ERROR:case z.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Rt,t);break;case z.LEVEL_LOAD_ERROR:case z.LEVEL_LOAD_TIMEOUT:case z.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Jn||(null==(n=t.context)?void 0:n.type)!==Ct||(this.state=zn);break;case z.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case z.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!Dn.getBuffered(e).length){const e=this.state!==zn?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=zn,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ee||this.audioOnly&&!this.altAudio){const e=(t===te?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,Rt)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const i=Dn.getBuffered(e),r=(i.length?i.start(0):0)-n;r>0&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),n+=r,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=zn,this.startFragRequested=!1,this.bitrateTest=!1;const r=e.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),i.trigger(G.FRAG_LOADED,n),e.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{video:d,text:u,id3:h,initSegment:p}=r,{details:f}=c,m=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Kn,p){if(null!=p&&p.tracks){const e=o.initSegment||o;this._bufferInitSegment(c,p.tracks,e,s),i.trigger(G.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}const e=p.initPTS,t=p.timescale;$(e)&&(this.initPTS[o.cc]={baseTime:e,timescale:t},i.trigger(G.INIT_PTS_FOUND,{frag:o,id:n,initPTS:e,timescale:t}))}if(d&&f&&"initSegment"!==o.sn){const e=f.fragments[o.sn-1-f.startSN],t=o.sn===f.startSN,n=!e||o.cc>e.cc;if(!1!==r.independent){const{startPTS:e,endPTS:i,startDTS:r,endDTS:a}=d;if(l)l.elementaryStreams[d.type]={startPTS:e,endPTS:i,startDTS:r,endDTS:a};else if(d.firstKeyFrame&&d.independent&&1===s.id&&!n&&(this.couldBacktrack=!0),d.dropped&&d.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=d.firstKeyFramePTS?d.firstKeyFramePTS:e;if(!t&&s<l-this.config.maxBufferHole&&!n)return void this.backtrack(o);n&&(o.gap=!0),o.setElementaryStreamInfo(d.type,o.start,i,o.start,a,!0)}o.setElementaryStreamInfo(d.type,e,i,r,a),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(d,o,l,s,t||n)}else{if(!t&&!n)return void this.backtrack(o);o.gap=!0}}if(m){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=m;l&&(l.elementaryStreams.audio={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(ee,e,t,n,i),this.bufferFragmentData(m,o,l,s)}if(f&&null!=h&&null!=(t=h.samples)&&t.length){const e={id:n,frag:o,details:f,samples:h.samples};i.trigger(G.FRAG_PARSING_METADATA,e)}if(f&&u){const e={id:n,frag:o,details:f,samples:u.samples};i.trigger(G.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,n,i){if(this.state!==Kn)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:r,video:s,audiovideo:a}=t;if(r){let t=e.audioCodec;const n=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==r.metadata.channelCount&&-1===n.indexOf("firefox")&&(t="mp4a.40.5")),-1!==n.indexOf("android")&&"audio/mpeg"!==r.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),r.levelCodec=t,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${r.codec}]`)}s&&(s.levelCodec=e.videoCodec,s.id="main",this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${e.videoCodec||""}/${s.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${a.codec}]`),this.hls.trigger(G.BUFFER_CODECS,t),Object.keys(t).forEach((e=>{const r=t[e].initSegment;null!=r&&r.byteLength&&this.hls.trigger(G.BUFFER_APPENDING,{type:e,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Rt)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=zn}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(Dn.isBuffered(e,n)?t=this.getAppendedFrag(n):Dn.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n&&t.urlId===e.urlId||(this.fragPlaying=t,this.hls.trigger(G.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(G.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&$(t)&&$(n.programDateTime)){const e=n.programDateTime+1e3*(t-n.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class or{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class lr{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new or(e),this.fast_=new or(t),this.defaultTTFB_=i,this.ttfb_=new or(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new or(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new or(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new or(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){const n=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class cr{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function(e,t){const n=new Uint8Array(t);let i=0;for(let t=0;t<e.length;t++){const r=e[t];n.set(r,i),i+=r.length}return n}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function dr(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!ur(e[n].attrs,t[n].attrs))return!1;return!0}function ur(e,t){const n=e["STABLE-RENDITION-ID"];return n?n===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some((n=>e[n]!==t[n]))}class hr{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if((n>>>=0)>i-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${i})`);return e[n][t]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}function pr(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}class fr{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const n=this.queues[t];n.push(e),1===n.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise((e=>{t=e})),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const{buffers:t,queues:n}=this,i=t[e],r=n[e];if(r.length){const t=r[0];try{t.execute()}catch(n){V.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),t.onError(n),null!=i&&i.updating||(r.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const mr=ct(),gr=/([ha]vc.)(?:\.[^.,]+)+/,yr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},vr=function(e){let t=e;return yr.hasOwnProperty(e)&&(t=yr[e]),String.fromCharCode(t)},br=15,_r=100,Tr={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Er={17:2,18:4,21:6,22:8,23:10,19:13,20:15},wr={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Sr={25:2,26:4,29:6,30:8,31:10,27:13,28:15},xr=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class kr{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"==typeof t?t():t;V.log(`${this.time} [${e}] ${n}`)}}}const Cr=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class Lr{constructor(e,t,n,i,r){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=i||"black",this.flash=r||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Ar{constructor(e,t,n,i,r,s){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Lr(t,n,i,r,s)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class Rr{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let e=0;e<_r;e++)this.chars.push(new Ar);this.logger=e,this.pos=0,this.currPenState=new Lr}equals(e){let t=!0;for(let n=0;n<_r;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<_r;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<_r;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>_r&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=_r)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=vr(e);this.pos>=_r?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<_r;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<_r;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Ir{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<br;t++)this.rows.push(new Rr(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<br;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<br;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<br;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<br;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+JSON.stringify(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<br;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(i&&null!==r&&i<r)for(let i=0;i<this.nrRollUpRows;i++)this.rows[t-this.nrRollUpRows+i+1].copy(n.rows[e+i])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let n=0;n<br;n++){const r=this.rows[n].getTextString();r&&(i=n+1,e?t.push("Row "+i+": '"+r+"'"):t.push(r.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class Dr{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Ir(n),this.nonDisplayedMemory=new Ir(n),this.lastOutputScreen=new Ir(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Pr{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const i=new kr;this.channels=[null,new Dr(e,t,i),new Dr(e+1,n,i)],this.cmdHistory={a:null,b:null},this.logger=i}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,i,r,s=!1;this.logger.time=e;for(let e=0;e<t.length;e+=2)if(i=127&t[e],r=127&t[e+1],0!==i||0!==r){if(this.logger.log(3,"["+Cr([t[e],t[e+1]])+"] -> ("+Cr([i,r])+")"),n=this.parseCmd(i,r),n||(n=this.parseMidrow(i,r)),n||(n=this.parsePAC(i,r)),n||(n=this.parseBackgroundAttributes(i,r)),!n&&(s=this.parseChars(i,r),s)){const e=this.currentChannel;e&&e>0?this.channels[e].insertChars(s):this.logger.log(2,"No channel found yet. TEXT-MODE?")}n||s||this.logger.log(2,"Couldn't parse cleaned data "+Cr([i,r])+" orig: "+Cr([t[e],t[e+1]]))}}parseCmd(e,t){const{cmdHistory:n}=this;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(Or(e,t,n))return Mr(null,null,n),this.logger.log(3,"Repeated command ("+Cr([e,t])+") is dropped"),!0;const i=20===e||21===e||23===e?1:2,r=this.channels[i];return 20===e||21===e||28===e||29===e?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),Mr(e,t,n),this.currentChannel=i,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Cr([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;const i=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(Or(e,t,i))return Mr(null,null,i),!0;const r=e<=23?1:2;n=t>=64&&t<=95?1===r?Tr[e]:wr[e]:1===r?Er[e]:Sr[e];const s=this.channels[r];return!!s&&(s.setPAC(this.interpretPAC(n,t)),Mr(e,t,i),this.currentChannel=r,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1==(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,"Special char '"+vr(e)+"' in channel "+n),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);if(i){const n=Cr(i);this.logger.log(3,"Char codes =  "+n.join(",")),Mr(e,t,this.cmdHistory)}return i}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;let n;const i={};16===e||24===e?(n=Math.floor((t-32)/2),i.background=xr[n],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));const r=e<=23?1:2;return this.channels[r].setBkgData(i),Mr(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Mr(e,t,n){n.a=e,n.b=t}function Or(e,t,n){return n.a===e&&n.b===t}class Nr{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Fr=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(e){return n(t,e)}function r(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function s(t,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let c="",d=!1,u=t,h=s,p=a,f=null,m="",g=!0,y="auto",v="start",b=50,_="middle",T=50,E="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(t){const i=function(t){return n(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");m=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return v},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return _},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return T},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return E},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class Br{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Ur(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class $r{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Gr(e,t,n,i){const r=i?e.split(i):[e];for(const e in r){if("string"!=typeof r[e])continue;const i=r[e].split(n);2===i.length&&t(i[0],i[1])}}const Hr=new Fr(0,0,""),zr="middle"===Hr.align?"middle":"center";function qr(e,t,n){const i=e;function r(){const t=Ur(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=r(),s(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),s(),t.endTime=r(),s(),function(e,t){const i=new $r;Gr(e,(function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",zr,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",zr,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",zr,"end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===Hr.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",zr);let s=i.get("position","auto");"auto"===s&&50===Hr.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function jr(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Yr{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Br,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;for(e=jr(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let i=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:e=n(),t.state){case"HEADER":/:/.test(e)?Gr(e,(function(e,t){}),/:/):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new Fr(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{qr(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Vr=/\r\n|\n\r|\n|\r/g,Kr=function(e,t,n=0){return e.slice(n,n+t.length)===t},Wr=function(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function Xr(e,t,n){return Wr(e.toString())+Wr(t.toString())+Wr(n)}const Zr="stpp.ttml.im1t",Qr=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Jr=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,es={left:"start",center:"center",right:"end",start:"start",end:"end"};function ts(e,t,n,i){const r=je(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map((e=>Pe(e))),a=function(e,t,n=1,i=!1){return Fi(e,t,1/n,i)}(t.baseTime,1,t.timescale);try{s.forEach((e=>n(function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},r=Object.keys(i).reduce(((e,t)=>(e[t]=n.getAttribute(`ttp:${t}`)||i[t],e)),{}),s="preserve"!==n.getAttribute("xml:space"),a=is(ns(n,"styling","style")),o=is(ns(n,"layout","region")),l=ns(n,"body","[begin]");return[].map.call(l,(e=>{const n=rs(e,s);if(!n||!e.hasAttribute("begin"))return null;const i=os(e.getAttribute("begin"),r),l=os(e.getAttribute("dur"),r);let c=os(e.getAttribute("end"),r);if(null===i)throw as(e);if(null===c){if(null===l)throw as(e);c=i+l}const d=new Fr(i-t,c-t,n);d.id=Xr(d.startTime,d.endTime,d.text);const u=function(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return s&&n.hasOwnProperty(s)&&(r=n[s]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(((n,s)=>{const a=ss(t,i,s)||ss(e,i,s)||ss(r,i,s);return a&&(n[s]=a),n}),{})}(o[e.getAttribute("region")],a[e.getAttribute("style")],a),{textAlign:h}=u;if(h){const e=es[h];e&&(d.lineAlign=e),d.align=h}return U(d,u),d})).filter((e=>null!==e))}(e,a))))}catch(e){i(e)}}function ns(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function is(e){return e.reduce(((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function rs(e,t){return[].slice.call(e.childNodes).reduce(((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?rs(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent}),"")}function ss(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function as(e){return new Error(`Could not parse ttml timestamp ${e}`)}function os(e,t){if(!e)return null;let n=Ur(e);return null===n&&(Qr.test(e)?n=function(e,t){const n=Qr.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}(e,t):Jr.test(e)&&(n=function(e,t){const n=Jr.exec(e),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),n}function ls(e,t){return!!e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}class cs{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(G.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.BUFFER_CODECS,this.onBufferCodecs,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(G.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.BUFFER_CODECS,this.onBufferCodecs,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter(((t,n)=>this.isLevelAllowed(t)&&n<=e));return this.clientRect=null,cs.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;let i=e.length-1;for(let a=0;a<e.length;a+=1){const o=e[a];if((o.width>=t||o.height>=n)&&(r=o,!(s=e[a+1])||r.width!==s.width||r.height!==s.height)){i=a;break}}var r,s;return i}}const ds="[eme]";class us{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=us.CDMCleanupPromise?[us.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=V.debug.bind(V,ds),this.log=V.log.bind(V,ds),this.warn=V.warn.bind(V,ds),this.error=V.error.bind(V,ds),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(G.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(G.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(G.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(G.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===ce.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map((e=>e.audioCodec)).filter(n),r=t.map((e=>e.videoCodec)).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((t,n)=>{const s=e=>{const a=e.shift();this.getMediaKeysPromise(a,i,r).then((e=>t({keySystem:a,mediaKeys:e}))).catch((t=>{e.length?s(e):n(t instanceof hs?t:new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};s(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!=typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===ve&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=function(e,t,n,i){let r;switch(e){case ce.FAIRPLAY:r=["cenc","sinf"];break;case ce.WIDEVINE:case ce.PLAYREADY:r=["cenc"];break;case ce.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,n,i){return[{initDataTypes:e,persistentState:i.persistentState||"not-allowed",distinctiveIdentifier:i.distinctiveIdentifier||"not-allowed",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null}))),videoCapabilities:n.map((e=>({contentType:`video/mp4; codecs="${e}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null})))}]}(r,t,n,i)}(e,t,n,this.config.drmSystemOptions),r=this.keySystemAccessPromises[e];let s=null==r?void 0:r.keySystemAccess;if(!s){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),s=this.requestMediaKeySystemAccess(e,i);const t=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),s.then((n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const i=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),i.then((n=>n?this.setMediaKeysServerCertificate(t,e,n):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return s.then((()=>r.mediaKeys))}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Ne(e.keyId||[])}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return Ne(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${Ne((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,n)=>{const i=ye(this.config),r=e.map(fe).filter((e=>!!e&&-1!==i.indexOf(e)));return this.getKeySystemSelectionPromise(r).then((({keySystem:e})=>{const i=ge(e);i?t(i):n(new Error(`Unable to find format for key-system "${e}"`))})).catch(n)}))}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let r=this.keyIdToKeySessionPromise[n];return r||(r=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then((({keySystem:n,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(n,r).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:n,mediaKeys:r,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")}))))),r.catch((e=>this.handleError(e)))),r}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof hs?this.hls.trigger(G.ERROR,e.data):this.hls.trigger(G.ERROR,{type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=fe(e.keyFormat),n=t?[t]:ye(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=ye(this.config)),0===e.length)throw new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),null===n)return;let i,r;if("sinf"===t&&this.config.drmSystems[ce.FAIRPLAY]){const e=$e(new Uint8Array(n));try{const t=oe(JSON.parse(e).sinf),n=Ke(new Uint8Array(t));if(!n)return;i=n.subarray(8,24),r=ce.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},n=new DataView(e),i=n.getUint32(0);if(e.byteLength!==i&&i>44)return null;if(1886614376!==n.getUint32(4))return null;if(t.version=n.getUint32(8)>>>24,t.version>1)return null;t.systemId=Ne(new Uint8Array(e,12,16));const r=n.getUint32(28);if(0===t.version){if(i-32<r)return null;t.data=new Uint8Array(e,32,r)}else if(1===t.version){t.kids=[];for(let n=0;n<r;n++)t.kids.push(new Uint8Array(e,32+16*n,16))}return t}(n);if(null===e)return;0===e.version&&e.systemId===me&&e.data&&(i=e.data.subarray(8,24)),r=function(e){if(e===me)return ce.WIDEVINE}(e.systemId)}if(!r||!i)return;const s=Ne(i),{keyIdToKeySessionPromise:a,mediaKeySessions:o}=this;let l=a[s];for(let e=0;e<o.length;e++){const r=o[e],c=r.decryptdata;if(c.pssh||!c.keyId)continue;const d=Ne(c.keyId);if(s===d||-1!==c.uri.replace(/-/g,"").indexOf(s)){l=a[d],delete a[d],c.pssh=new Uint8Array(n),c.keyId=i,l=a[s]=l.then((()=>this.generateRequestWithPreferredKeySession(r,t,n,"encrypted-event-key-match")));break}}l||(l=a[s]=this.getKeySystemSelectionPromise([r]).then((({keySystem:e,mediaKeys:r})=>{var a;this.throwIfDestroyed();const o=new nt("ISO-23001-7",s,null!=(a=ge(e))?a:"");return o.pssh=new Uint8Array(n),o.keyId=i,this.attemptSetMediaKeys(e,r).then((()=>{this.throwIfDestroyed();const i=this.createMediaKeySessionContext({decryptdata:o,keySystem:e,mediaKeys:r});return this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-no-match")}))}))),l.catch((e=>this.handleError(e)))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(i),i.then((()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===n.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,n,i){var r,s;const a=null==(r=this.config.drmSystems)||null==(s=r[e.keySystem])?void 0:s.generateRequest;if(a)try{const i=a.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=e.decryptdata.pssh=i.initData?new Uint8Array(i.initData):null}catch(e){var o;if(this.warn(e.message),null!=(o=this.hls)&&o.config.debug)throw e}if(null===n)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${l} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new nr;e.mediaKeysSession.onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void c.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log(`"${i}" message event for session "${n.sessionId}" message size: ${r.byteLength}`),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch((e=>{this.handleError(e),c.emit("error",e)})):"license-release"===i?e.keySystem===ce.FAIRPLAY&&(this.updateKeySession(e,le("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${i}"`)},e.mediaKeysSession.onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void c.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const n=e.keyStatus;c.emit("keyStatus",n),"expired"===n&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};const d=new Promise(((e,t)=>{c.on("error",t),c.on("keyStatus",(n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)}))}));return e.mediaKeysSession.generateRequest(t,n).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)})).catch((e=>{throw new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>d)).catch((t=>{throw c.removeAllListeners(),this.removeSession(e),t})).then((()=>(c.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Ne("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Ne(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,n=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching serverCertificate for "${e}"`),new Promise(((r,s)=>{const a={responseType:"arraybuffer",url:i},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{r(e.data)},onError:(t,n,r,o)=>{s(new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:F({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,r)=>{s(new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};n.load(a,l,c)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise(((i,r)=>{e.setServerCertificate(n).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),i(e)})).catch((e=>{r(new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)})).catch((s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)})).then((n=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:n||i}))):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise(((i,r)=>{const s=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${s}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,s,e)}catch(e){this.error(e)}i(t)}else{const o=n.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new hs({type:H.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${s}). Status: ${a.status} (${a.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,s,e,t).then((({xhr:e,licenseChallenge:t})=>{e.send(t)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},nt.clearKeyUriToKeyIdMap();const n=t.length;us.CDMCleanupPromise=Promise.all(t.map((e=>this.removeSession(e))).concat(null==e?void 0:e.setMediaKeys(null).catch((t=>{this.log(`Could not clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)})))).then((()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch((e=>{this.log(`Could not remove session: ${e}`)})).then((()=>t.close())).catch((e=>{this.log(`Could not close session: ${e}`)}))}}}us.CDMCleanupPromise=void 0;class hs extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var ps="a",fs="av";class ms{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:"m",su:!this.initialized})}catch(e){V.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const t=e.frag,n=this.hls.levels[t.level],i=this.getObjectType(t),r={d:1e3*t.duration,ot:i};"v"!==i&&i!==ps&&i!=fs||(r.br=n.bitrate/1e3,r.tb=this.getTopBandwidth(i)/1e3,r.bl=this.getBufferLength(i)),this.apply(e,r)}catch(e){V.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||ms.uuid(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.registerListeners())}registerListeners(){const e=this.hls;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHED,this.onMediaDetached,this),e.on(G.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHED,this.onMediaDetached,this),e.off(G.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){U(t,this.createData());const n="i"===t.ot||"v"===t.ot||t.ot===fs;if(this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){const n=ms.toHeaders(t);if(!Object.keys(n).length)return;e.headers||(e.headers={}),U(e.headers,n)}else{const n=ms.toQuery(t);if(!n)return;e.url=ms.appendQueryToUri(e.url,n)}}getObjectType(e){const{type:t}=e;return"subtitle"===t?"tt":"initSegment"===e.sn?"i":"audio"===t?ps:"main"===t?this.hls.audioTracks.length?"v":fs:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===ps)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}for(const e of t)e.bitrate>n&&(n=e.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.hls.media,n=e===ps?this.audioBuffer:this.videoBuffer;return n&&t?1e3*Dn.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],n=e=>!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e,i=e=>Math.round(e),r=e=>100*i(e/100),s={br:i,d:i,bl:r,dl:r,mtp:r,nor:e=>encodeURIComponent(e),rtp:r,tb:i},a=Object.keys(e||{}).sort();for(const i of a){let r=e[i];if(!n(r))continue;if("v"===i&&1===r)continue;if("pr"==i&&1===r)continue;const a=s[i];a&&(r=a(r));const o=typeof r;let l;l="ot"===i||"sf"===i||"st"===i?`${i}=${r}`:"boolean"===o?i:"number"===o?`${i}=${r}`:`${i}=${JSON.stringify(r)}`,t.push(l)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),n={},i=["Object","Request","Session","Status"],r=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const n of t)r[null!=s[n]?s[n]:1][n]=e[n];for(let e=0;e<r.length;e++){const t=ms.serialize(r[e]);t&&(n[`CMCD-${i[e]}`]=t)}return n}static toQuery(e){return`CMCD=${encodeURIComponent(ms.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const n=e.includes("?")?"&":"?";return`${e}${n}${t}`}}function gs(e,t,n,i){e&&Object.keys(t).forEach((r=>{const s=e.filter((e=>e.groupId===r)).map((e=>{const s=U({},e);return s.details=void 0,s.attrs=new X(s.attrs),s.url=s.attrs.URI=ys(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s}));e.push(...s)}))}function ys(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const l=new self.URL(e);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach((e=>{e&&l.searchParams.set(e,s[e])})),l.href}const vs=/^age:\s*[\d.]+\s*$/im;class bs{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new J,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(!this.stats.aborted)return r(n,t.url)})).catch((e=>(n.open("GET",t.url,!0),r(n,t.url)))).then((()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)})).catch((e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,i)})):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=this.context.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=n.loadPolicy;if(i)for(const t in i)e.setRequestHeader(t,i[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&$(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,s="text"!==t.responseType;if(i>=200&&i<300&&(s&&t.response||null!==t.responseText)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const r=s?t.response:t.responseText,a="arraybuffer"===t.responseType?r.byteLength:r.length;if(n.loaded=n.total=a,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const o=this.callbacks.onProgress;if(o&&o(n,e,r,t),!this.callbacks)return;const l={url:t.responseURL,data:r,code:i};this.callbacks.onSuccess(l,n,e,t)}else{const s=r.loadPolicy.errorRetry;on(s,n.retry,!1,i)?this.retry(s):(V.error(`${i} while loading ${e.url}`),this.callbacks.onError({code:i,text:t.statusText},e,t,n))}}}loadtimeout(){var e;const t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(on(t,this.stats.retry,!0))this.retry(t);else{V.warn(`timeout while loading ${this.context.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=sn(e,n.retry),n.retry++,V.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&vs.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const _s=/(\d+)-(\d+)\/(\d+)/;class Ts{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||Es,this.controller=new self.AbortController,this.stats=new J}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=function(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(U({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}(e,this.controller.signal),s=n.onProgress,a="arraybuffer"===e.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=l&&$(l)?l:c,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(i,e,this.response)}),t.timeout),self.fetch(this.request).then((r=>{this.response=this.loader=r;const o=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(i,e,this.response)}),c-(o-i.loading.start)),!r.ok){const{status:e,statusText:t}=r;throw new ws(t||"fetch, bad network response",e,r)}return i.loading.first=o,i.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=_s.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if($(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}(r.headers)||i.total,s&&$(t.highWaterMark)?this.loadProgressively(r,i,e,t.highWaterMark,s):a?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((r=>{const{response:a}=this;self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=r[o];l&&(i.loaded=i.total=l);const c={url:a.url,data:r,code:a.status};s&&!$(t.highWaterMark)&&s(i,e,r,a),n.onSuccess(c,i,e,a)})).catch((t=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=t&&t.code||0,s=t?t.message:null;n.onError({code:r,text:s},e,t?t.details:null,i)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const s=new cr,a=e.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return s.dataLength&&r(t,n,s.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=a.value,c=l.length;return t.loaded+=c,c<i||s.dataLength?(s.push(l),s.dataLength>=i&&r(t,n,s.flush(),e)):r(t,n,l,e),o()})).catch((()=>Promise.reject()));return o()}}function Es(e,t){return new self.Request(e.url,t)}class ws extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const Ss=/\s/,xs={newCue(e,t,n,i){const r=[];let s,a,o,l,c;const d=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],o=!0,l=0,c="",!s.isEmpty()){var u;for(let e=0;e<s.chars.length;e++)Ss.test(s.chars[e].uchar)&&o?l++:(c+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const i=jr(c.trim()),p=Xr(t,n,i);null!=e&&null!=(u=e.cues)&&u.getCueById(p)||(a=new d(t,n,i),a.id=p,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return e&&r.length&&(r.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),r.forEach((t=>Ft(e,t)))),r}},ks=F(F({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:bs,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new lr(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(G.FRAG_LOADING,this.onFragLoading,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this),e.on(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(G.FRAG_LOADING,this.onFragLoading,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this),e.off(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;const i=t.frag;this.ignoreFragment(i)||(this.fragCurrent=i,this.partCurrent=null!=(n=t.part)?n:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,i){return e+n/t+(i?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{total:i,bwEstimate:r}=t.stats;$(i)&&$(r)&&(this.lastLevelLoadSec=8*i/r),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:i,media:r}=n;if(!e||!r)return;const s=performance.now(),a=t?t.stats:e.stats,o=t?t.duration:e.duration,l=s-a.loading.start;if(a.aborted||a.loaded&&a.loaded===a.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!i||r.paused||!r.playbackRate||!r.readyState)return;const c=n.mainForwardBufferInfo;if(null===c)return;const d=this.bwEstimator.getEstimateTTFB(),u=Math.abs(r.playbackRate);if(l<=Math.max(d,o/(2*u)*1e3))return;const h=c.len/u;if(h>=2*o/u)return;const p=a.loading.first?a.loading.first-a.loading.start:-1,f=a.loaded&&p>-1,m=this.bwEstimator.getEstimate(),{levels:g,minAutoLevel:y}=n,v=g[e.level],b=a.total||Math.max(a.loaded,Math.round(o*v.maxBitrate/8));let _=l-p;_<1&&f&&(_=Math.min(l,8*a.loaded/m));const T=f?1e3*a.loaded/_:0,E=T?(b-a.loaded)/T:8*b/m+d/1e3;if(E<=h)return;const w=T?8*T:m;let S,x=Number.POSITIVE_INFINITY;for(S=e.level-1;S>y;S--){const e=g[S].maxBitrate;if(x=this.getTimeToLoadFrag(d/1e3,w,o*e,!g[S].details),x<h)break}x>=E||x>10*o||(n.nextLoadLevel=S,f?this.bwEstimator.sample(l-Math.min(d,p),a.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),V.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${h.toFixed(3)} s\n      Estimated load time for current fragment: ${E.toFixed(3)} s\n      Estimated load time for down switch fragment: ${x.toFixed(3)} s\n      TTFB estimate: ${p}\n      Current BW estimate: ${$(m)?(m/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level ${S}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(G.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a}))}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Rt&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,r=this.hls.levels[t.level],s=(r.loaded?r.loaded.bytes:0)+i.loaded,a=(r.loaded?r.loaded.duration:0)+e;r.loaded={bytes:s,duration:a},r.realBitrate=Math.round(8*s/a)}if(t.bitrateTest){const e={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(G.FRAG_BUFFERED,e),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Rt||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;let n=this.getNextABRAutoLevel();if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,n)&&t[e].loadError<=t[n].loadError)return e}return-1!==e&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:r,minAutoLevel:s,media:a}=n,o=t?t.duration:e?e.duration:0,l=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,d=n.mainForwardBufferInfo,u=(d?d.len:0)/l;let h=this.findBestLevel(c,s,i,u,r.abrBandWidthFactor,r.abrBandWidthUpFactor);if(h>=0)return h;V.trace(`[abr] ${u?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let p=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay,f=r.abrBandWidthFactor,m=r.abrBandWidthUpFactor;if(!u){const e=this.bitrateTestDelay;e&&(p=(o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay)-e,V.trace(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),f=m=1)}return h=this.findBestLevel(c,s,i,u+p,f,m),Math.max(h,0)}findBestLevel(e,t,n,i,r,s){var a;const{fragCurrent:o,partCurrent:l,lastLoadedFragLevel:c}=this,{levels:d}=this.hls,u=d[c],h=!(null==u||null==(a=u.details)||!a.live),p=null==u?void 0:u.codecSet,f=l?l.duration:o?o.duration:0,m=this.bwEstimator.getEstimateTTFB()/1e3;let g=t,y=-1;for(let a=n;a>=t;a--){const t=d[a];if(!t||p&&t.codecSet!==p){t&&(g=Math.min(a,g),y=Math.max(a,y));continue}-1!==y&&V.trace(`[abr] Skipped level(s) ${g}-${y} with CODECS:"${d[y].attrs.CODECS}"; not compatible with "${u.attrs.CODECS}"`);const n=t.details,o=(l?null==n?void 0:n.partTarget:null==n?void 0:n.averagetargetduration)||f;let v;v=a<=c?r*e:s*e;const b=d[a].maxBitrate,_=this.getTimeToLoadFrag(m,v,b*o,void 0===n);if(V.trace(`[abr] level:${a} adjustedbw-bitrate:${Math.round(v-b)} avgDuration:${o.toFixed(1)} maxFetchDuration:${i.toFixed(1)} fetchDuration:${_.toFixed(1)}`),v>b&&(0===_||!$(_)||h&&!this.bitrateTestDelay||_<i))return a}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},bufferController:class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;V.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(G.MEDIA_ATTACHED,{media:e})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{V.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{V.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:e,_objectUrl:t}=this;e&&e.src!==t&&V.error(`Media element src was set while attaching MediaSource (${t} > ${e.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.BUFFER_RESET,this.onBufferReset,this),e.on(G.BUFFER_APPENDING,this.onBufferAppending,this),e.on(G.BUFFER_CODECS,this.onBufferCodecs,this),e.on(G.BUFFER_EOS,this.onBufferEos,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(G.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(G.FRAG_PARSED,this.onFragParsed,this),e.on(G.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.BUFFER_RESET,this.onBufferReset,this),e.off(G.BUFFER_APPENDING,this.onBufferAppending,this),e.off(G.BUFFER_CODECS,this.onBufferCodecs,this),e.off(G.BUFFER_EOS,this.onBufferEos,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(G.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(G.FRAG_PARSED,this.onFragParsed,this),e.off(G.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new fr(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,V.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media;if(n&&mr){const e=this.mediaSource=new mr;e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(e),this._objectUrl=n.src,n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(V.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){V.warn(`[buffer-controller]: onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):V.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(G.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){V.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}})),this._initSourceBuffer()}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length;Object.keys(t).forEach((e=>{if(n){const n=this.tracks[e];if(n&&"function"==typeof n.buffer.changeType){const{id:i,codec:r,levelCodec:s,container:a,metadata:o}=t[e],l=(n.levelCodec||n.codec).replace(gr,"$1"),c=(s||r).replace(gr,"$1");if(l!==c){const t=`${a};codecs=${s||r}`;this.appendChangeType(e,t),V.log(`[buffer-controller]: switching codec ${l} to ${c}`),this.tracks[e]={buffer:n.buffer,codec:r,container:a,levelCodec:s,metadata:o,id:i}}}}else this.pendingTracks[e]=t[e]})),n||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const i=this.sourceBuffer[e];i&&(V.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),i.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{V.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}};n.append(i,e)}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:r}=this,{data:s,type:a,frag:o,part:l,chunkMeta:c}=t,d=c.buffering[a],u=self.performance.now();d.start=u;const h=o.stats.buffering,p=l?l.stats.buffering:null;0===h.start&&(h.start=u),p&&0===p.start&&(p.start=u);const f=r.audio;let m=!1;"audio"===a&&"audio/mpeg"===(null==f?void 0:f.container)&&(m=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const g=o.start,y={execute:()=>{if(d.executeStart=self.performance.now(),m){const e=this.sourceBuffer[a];if(e){const t=g-e.timestampOffset;Math.abs(t)>=.1&&(V.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${g} (delta: ${t}) sn: ${o.sn})`),e.timestampOffset=g)}}this.appendExecutor(s,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();d.executeEnd=d.end=e,0===h.first&&(h.first=e),p&&0===p.first&&(p.first=e);const{sourceBuffer:t}=this,n={};for(const e in t)n[e]=Dn.getBuffered(t[e]);this.appendError=0,this.hls.trigger(G.BUFFER_APPENDED,{type:a,frag:o,part:l,chunkMeta:c,parent:o.type,timeRanges:n})},onError:e=>{V.error(`[buffer-controller]: Error encountered while trying to append to the ${a} SourceBuffer`,e);const t={type:H.MEDIA_ERROR,parent:o.type,details:z.BUFFER_APPEND_ERROR,frag:o,part:l,chunkMeta:c,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=z.BUFFER_FULL_ERROR:(this.appendError++,t.details=z.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(V.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),t.fatal=!0)),n.trigger(G.ERROR,t)}};i.append(y,a)}onBufferFlushing(e,t){const{operationQueue:n}=this,i=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(G.BUFFER_FLUSHED,{type:e})},onError:t=>{V.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach((e=>{n.append(i(e),e)}))}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s.audiovideo?r.push("audiovideo"):(s.audio&&r.push("audio"),s.video&&r.push("video")),0===r.length&&V.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers((()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(G.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})}),r)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce(((e,n)=>{const i=this.sourceBuffer[n];return!i||t.type&&t.type!==n||(i.ending=!0,i.ended||(i.ended=!0,V.log(`[buffer-controller]: ${n} sourceBuffer now EOS`))),e&&!(i&&!i.ended)}),!0)&&(V.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)}));const{mediaSource:e}=this;e&&"open"===e.readyState?(V.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()):e&&V.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:n,sourceBuffer:i}=this;if(!n||null===t)return;const r=this.getSourceBufferTypes();if(!r.length)return;const s=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!$(s)||s<0)return;const a=n.currentTime,o=t.levelTargetDuration,l=Math.max(s,o),c=Math.floor(a/o)*o-l;r.forEach((n=>{const r=i[n];if(r){const i=Dn.getBuffered(r);if(i.length>0&&c>i.start(0)){if(e.trigger(G.BACK_BUFFER_REACHED,{bufferEnd:c}),t.live)e.trigger(G.LIVE_BACK_BUFFER_REACHED,{bufferEnd:c});else if(r.ended&&i.end(i.length-1)-a<2*o)return void V.info(`[buffer-controller]: Cannot flush ${n} back buffer while SourceBuffer is in ended state`);e.trigger(G.BUFFER_FLUSHING,{startOffset:0,endOffset:c,type:n})}}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:i}=this,r=e.fragments[0].start+e.totalduration,s=n.duration,a=$(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(V.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=1/0,this.updateSeekableRange(e)):(r>a&&r>s||!$(s))&&(V.log(`[buffer-controller]: Updating Media Source duration to ${r.toFixed(3)}`),i.duration=r)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){const i=Math.max(0,n[0].start),r=Math.max(i,i+e.totalduration);t.setLiveSeekableRange(i,r)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&!e||2===i){this.createSourceBuffers(n),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(G.BUFFER_CREATED,{tracks:this.tracks}),e.forEach((e=>{t.executeNext(e)}));else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const i in e)if(!t[i]){const r=e[i];if(!r)throw Error(`source buffer exists for track ${i}, however track does not`);const s=r.levelCodec||r.codec,a=`${r.container};codecs=${s}`;V.log(`[buffer-controller]: creating sourceBuffer(${a})`);try{const e=t[i]=n.addSourceBuffer(a),o=i;this.addBufferListener(o,"updatestart",this._onSBUpdateStart),this.addBufferListener(o,"updateend",this._onSBUpdateEnd),this.addBufferListener(o,"error",this._onSBUpdateError),this.tracks[i]={buffer:e,codec:s,container:r.container,levelCodec:r.levelCodec,metadata:r.metadata,id:r.id}}catch(e){V.error(`[buffer-controller]: error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:a})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const n=new Error(`${e} SourceBuffer error`);V.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.BUFFER_APPENDING_ERROR,error:n,fatal:!1});const i=this.operationQueue.current(e);i&&i.onError(t)}removeExecutor(e,t,n){const{media:i,mediaSource:r,operationQueue:s,sourceBuffer:a}=this,o=a[e];if(!i||!r||!o)return V.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void s.shiftAndExecuteNext(e);const l=$(i.duration)?i.duration:1/0,c=$(r.duration)?r.duration:1/0,d=Math.max(0,t),u=Math.min(n,l,c);u>d&&!o.ending?(o.ended=!1,V.log(`[buffer-controller]: Removing [${d},${u}] from the ${e} SourceBuffer`),o.remove(d,u)):s.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:n,sourceBuffer:i}=this,r=i[t];if(!r)return V.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),void n.shiftAndExecuteNext(t);r.ended=!1,r.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return V.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map((e=>n.appendBlocker(e)));Promise.all(i).then((()=>{e(),t.forEach((e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const r=n.bind(this,e);this.listeners[e].push({event:t,listener:r}),i.addEventListener(t,r)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach((e=>{t.removeEventListener(e.event,e.listener)}))}},capLevelController:cs,errorController:class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=V.log.bind(V,"[info]:"),this.warn=V.warn.bind(V,"[warning]:"),this.error=V.error.bind(V,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(G.ERROR,this.onError,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(G.ERROR,this.onError,this),e.off(G.ERROR,this.onErrorOut,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(null==e?void 0:e.type)===Rt?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const r=this.hls,s=t.context;switch(t.details){case z.FRAG_LOAD_ERROR:case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_ERROR:case z.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case z.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:0,flags:0});case z.FRAG_GAP:case z.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case z.LEVEL_EMPTY_ERROR:case z.LEVEL_PARSING_ERROR:{var a,o;const e=t.parent===Rt?t.level:r.loadLevel;t.details===z.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(o=a.levelDetails)&&o.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case z.LEVEL_LOAD_ERROR:case z.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==s?void 0:s.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level)));case z.AUDIO_TRACK_LOAD_ERROR:case z.AUDIO_TRACK_LOAD_TIMEOUT:case z.SUBTITLE_LOAD_ERROR:case z.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const e=r.levels[r.loadLevel];if(e&&(s.type===Lt&&s.groupId===e.audioGroupId||s.type===At&&s.groupId===e.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case z.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=r.levels[r.loadLevel],n=null==e?void 0:e.attrs["HDCP-LEVEL"];n&&(t.errorAction={action:2,flags:2,hdcpLevel:n})}return;case z.BUFFER_ADD_CODEC_ERROR:case z.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(i=t.level)?i:r.loadLevel));case z.INTERNAL_EXCEPTION:case z.BUFFER_APPENDING_ERROR:case z.BUFFER_APPEND_ERROR:case z.BUFFER_FULL_ERROR:case z.LEVEL_SWITCH_ERROR:case z.BUFFER_STALLED_ERROR:case z.BUFFER_SEEK_OVER_HOLE:case z.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:0,flags:0})}if(t.type===H.KEY_SYSTEM_ERROR){const e=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,e))}}getPlaylistRetryOrSwitchAction(e,t){var n;const i=rn(this.hls.config.playlistLoadPolicy,e),r=this.playlistError++,s=null==(n=e.response)?void 0:n.code;if(on(i,r,nn(e),s))return{action:5,flags:0,retryConfig:i,retryCount:r};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=r),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=rn(e.details.startsWith("key")?s:r,e),o=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(i){var l;e.details!==z.FRAG_GAP&&i.fragmentError++;const t=null==(l=e.response)?void 0:l.code;if(on(a,o,nn(e),t))return{action:5,flags:0,retryConfig:a,retryCount:o}}const c=this.getLevelSwitchAction(e,n);return a&&(c.retryConfig=a,c.retryCount=o),c}getLevelSwitchAction(e,t){const n=this.hls;null==t&&(t=n.loadLevel);const i=this.hls.levels[t];if(i&&(i.loadError++,n.autoLevelEnabled)){var r,s;let t=-1;const{levels:a,loadLevel:o,minAutoLevel:l,maxAutoLevel:c}=n,d=null==(r=e.frag)?void 0:r.type,{type:u,groupId:h}=null!=(s=e.context)?s:{};for(let n=a.length;n--;){const r=(n+o)%a.length;if(r!==o&&r>=l&&r<=c&&0===a[r].loadError){const n=a[r];if(e.details===z.FRAG_GAP&&e.frag){const t=a[r].details;if(t){const n=cn(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(u===Lt&&h===n.audioGroupId||u===At&&h===n.textGroupId)continue;if(d===It&&i.audioGroupId===n.audioGroupId||d===Dt&&i.textGroupId===n.textGroupId)continue}t=r;break}}if(t>-1&&n.loadLevel!==t)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:t}}return{action:2,flags:1}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===z.FRAG_GAP||(t.fatal=!0)}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:r,nextAutoLevel:s}=n;switch(i){case 0:this.switchLevel(e,s);break;case 1:n.resolved||(n.resolved=this.redundantFailover(e));break;case 2:r&&(t.maxHdcpLevel=Vt[Vt.indexOf(r)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}n.resolved||this.switchLevel(e,s)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:n}=this,i=e.parent===Rt?e.level:t.loadLevel,r=t.levels[i],s=r.url.length,a=e.frag?e.frag.urlId:r.urlId;r.urlId!==a||e.frag&&!r.details||this.penalizeRendition(r,e);for(let o=1;o<s;o++){const l=(a+o)%s,c=n[l];if(!c||hn(c,e,n[a]))return this.warn(`Switching to Redundant Stream ${l+1}/${s}: "${r.url[l]}" after ${e.details}`),this.playlistError=0,t.levels.forEach((e=>{e.urlId=l})),t.nextLoadLevel=i,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:n}=this,i=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};i.lastErrorPerfMs=performance.now(),i.errors.push(t),i.details=e.details,n[e.urlId]=i}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(G.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;V.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(G.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ve,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:xs,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends ei{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Dt),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.ERROR,this.onError,this),e.on(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(G.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(G.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.ERROR,this.onError,this),e.off(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(G.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(G.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=zn,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=zn,!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let e=0;e<r.length;e++)if(a>=r[e].start&&a<=r[e].end){s=r[e];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}})),this.fragmentTracker.removeFragmentsInRange(n,e,Dt)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==Rt||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===Dt&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Hn&&(this.state=zn))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){dr(this.levels,t)?this.levels=t.map((e=>new Wt(e))):(this.tracksBuffered=[],this.levels=t.map((e=>{const t=new Wt(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Dt),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId)return void this.clearInterval();const n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{details:i,id:r}=t,{currentTrackId:s,levels:a}=this;if(!a.length)return;const o=a[s];if(r>=a.length||r!==s||!o)return;this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(i.live||null!=(n=o.details)&&n.live){const e=this.mainDetails;if(i.deltaUpdateFailed||!e)return;const t=e.fragments[0];o.details?(l=this.alignPlaylists(i,o.details),0===l&&t&&(l=t.start,Jt(i,l))):i.hasProgramDateTime&&e.hasProgramDateTime?(Fn(i,e),l=i.fragments[0].start):t&&(l=t.start,Jt(i,l))}o.details=i,this.levelLastLoaded=r,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(o.details,l),this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===zn&&(cn(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch((e=>{throw r.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((n=>{const i=performance.now();r.trigger(G.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=zn}))}}doTick(){if(this.media){if(this.state===zn){const{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;const{config:i}=this,r=this.getLoadPosition(),s=Dn.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,l=this.getFwdBufferInfo(this.media,Rt),c=n.details;if(o>this.getMaxBufferLength(null==l?void 0:l.len)+c.levelTargetDuration)return;const d=c.fragments,u=d.length,h=c.edge;let p=null;const f=this.fragPrevious;if(a<h){const e=i.maxFragLookUpTolerance,t=a>h-e?0:e;p=cn(f,d,Math.max(d[0].start,a),t),!p&&f&&f.start<d[0].start&&(p=d[0])}else p=d[u-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),"initSegment"!==p.sn){const e=d[p.sn-c.startSN-1];e&&e.cc===p.cc&&this.fragmentTracker.getState(e)===vn&&(p=e)}this.fragmentTracker.getState(p)===vn&&this.loadFragment(p,n,a)}}else this.state=zn}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new hr(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends pn{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(G.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.LEVEL_LOADING,this.onLevelLoading,this),e.off(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(G.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),pr(this.media.textTracks).forEach((e=>{Bt(e)})),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,details:i}=t,{trackId:r}=this,s=this.tracksInGroup[r];if(!s)return void this.warn(`Invalid subtitle track id ${n}`);const a=s.details;s.details=t.details,this.log(`subtitle track ${n} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.textGroupIds)return;const n=t.textGroupIds[t.urlId],i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){const e=this.tracks.filter((e=>!n||e.groupId===n));this.tracksInGroup=e;const t=this.findTrackId(null==i?void 0:i.name)||this.findTrackId();this.groupId=n||null;const r={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${n}" group-id`),this.hls.trigger(G.SUBTITLE_TRACKS_UPDATED,r),-1!==t&&this.setSubtitleTrack(t,i)}else this.shouldReloadPlaylist(i)&&this.setSubtitleTrack(this.trackId,i)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||e===i.name))return i.id}return-1}onError(e,t){!t.fatal&&t.context&&t.context.type===At&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(G.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:n}=this;if(!t)return;const i=pr(t.textTracks),r=i.filter((e=>e.groupId===this.groupId));if(-1===e)[].slice.call(i).forEach((e=>{e.mode="disabled"}));else{const e=r[n];e&&(e.mode="disabled")}const s=r[e];s&&(s.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var n;const i=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(n=i[e])&&n.details)||e<-1||e>=i.length)return;this.clearTimer();const r=i[e];if(this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:"")),this.trackId=e,r){const{id:e,groupId:n="",name:i,type:s,url:a}=r;this.hls.trigger(G.SUBTITLE_TRACK_SWITCH,{id:e,groupId:n,name:i,type:s,url:a});const o=this.switchParams(r.url,null==t?void 0:t.details);this.loadPlaylist(o)}else this.hls.trigger(G.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=pr(this.media.textTracks);for(let n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},timelineController:class{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const e=new Nr(this,"textTrack1"),t=new Nr(this,"textTrack2"),n=new Nr(this,"textTrack3"),i=new Nr(this,"textTrack4");this.cea608Parser1=new Pr(1,e,t),this.cea608Parser2=new Pr(3,n,i)}e.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(G.FRAG_LOADING,this.onFragLoading,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this),e.on(G.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(G.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(G.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(G.FRAG_LOADING,this.onFragLoading,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this),e.off(G.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(G.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(G.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,i,r){let s=!1;for(let e=r.length;e--;){const i=r[e],d=(a=i[0],o=i[1],l=t,c=n,Math.min(o,c)-Math.max(a,l));if(d>=0&&(i[0]=Math.min(i[0],t),i[1]=Math.max(i[1],n),s=!0,d/(n-t)>.5))return}var a,o,l,c;if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(G.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){const{unparsedVttFrags:s}=this;"main"===n&&(this.initPTS[t.cc]={baseTime:i,timescale:r}),s.length&&(this.unparsedVttFrags=[],s.forEach((e=>{this.onFragLoaded(G.FRAG_LOADED,e)})))}getExistingTrack(e){const{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){const i=t.textTracks[n];if(i[e])return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(e);if(a)n[e]=a,Bt(n[e]),Nt(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(G.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>{Bt(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)Bt(t[e])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some((e=>e.textCodec===Zr));if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(dr(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media?this.media.textTracks:null;this.tracks.forEach(((t,n)=>{let i;if(e&&n<e.length){let n=null;for(let i=0;i<e.length;i++)if(ls(e[i],t)){n=e[i];break}n&&(i=n)}if(i)Bt(i);else{const e=this._captionsOrSubtitlesFromCharacteristics(t);i=this.createTextTrack(e,t.name,t.lang),i&&(i.mode="disabled")}i&&(i.groupId=t.groupId,this.textTracks.push(i))}))}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(G.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:n,cea608Parser2:i,lastSn:r,lastPartIndex:s}=this;if(this.enabled&&n&&i&&t.frag.type===Rt){var a,o;const e=t.frag.sn,l=null!=(a=null==t||null==(o=t.part)?void 0:o.index)?a:-1;e===r+1||e===r&&l===s+1||(n.reset(),i.reset()),this.lastSn=e,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Dt)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Zr?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;ts(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),n.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{V.log(`Failed to parse IMSC1: ${t}`),n.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls;!function(e,t,n,i,r,s,a){const o=new Yr,l=Pe(new Uint8Array(e)).trim().replace(Vr,"\n").split("\n"),c=[],d=t?function(e,t=1){return Fi(e,9e4,1/t)}(t.baseTime,t.timescale):0;let u,h="00:00.000",p=0,f=0,m=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(p-d)/9e4;if(null!=s&&s.new&&(void 0!==f?a=n.ccOffset=s.start:function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(s=r)&&s.new;){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n}(n,i,o)),o){if(!t)return void(u=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const l=e.endTime-e.startTime,h=zi(9e4*(e.startTime+a-f),9e4*r)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+l,0);const m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=Xr(e.startTime,e.endTime,m)),e.endTime>0&&c.push(e)},o.onparsingerror=function(e){u=e},o.onflush=function(){u?a(u):s(c)},l.forEach((e=>{if(m){if(Kr(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach((e=>{Kr(e,"LOCAL:")?h=e.slice(6):Kr(e,"MPEGTS:")&&(p=parseInt(e.slice(7)))}));try{f=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!($(t)&&$(n)&&$(i)&&$(r)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*i,t+=36e5*r,t}(h)/1e3}catch(e){u=e}return}""===e&&(m=!1)}o.parse(e+"\n")})),o.flush()}(null!=(t=n.initSegment)&&t.data?Xe(n.initSegment.data,new Uint8Array(i)):i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(e=>{this._appendCues(e,n.level),o.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),V.log(`Failed to parse VTT cue: ${t}`),r&&a>n.cc||o.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||ts(t,this.initPTS[e.cc],(()=>{n.textCodec=Zr,this._parseIMSC1(e,t)}),(()=>{n.textCodec="wvtt"}))}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((e=>Ft(n,e)))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(G.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Dt&&this.onFragLoaded(G.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:r,samples:s}=t;if(r.type!==Rt||"NONE"!==this.closedCaptionsForLevel(r))for(let e=0;e<s.length;e++){const t=s[e].bytes;if(t){const r=this.extractCea608Data(t);n.addData(s[e].pts,r[0]),i.addData(s[e].pts,r[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:s}=this;if(s&&!(s.currentTime<n)){if(!r||"video"===r){const{captionsTracks:e}=this;Object.keys(e).forEach((i=>Ut(e[i],t,n)))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==i){const{textTracks:e}=this;Object.keys(e).forEach((n=>Ut(e[n],t,i)))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if((0!==r||0!==s)&&0!=(4&n)){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}},audioStreamController:class extends ei{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",It),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(G.ERROR,this.onError,this),e.on(G.BUFFER_RESET,this.onBufferReset,this),e.on(G.BUFFER_CREATED,this.onBufferCreated,this),e.on(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(G.ERROR,this.onError,this),e.off(G.BUFFER_RESET,this.onBufferReset,this),e.off(G.BUFFER_CREATED,this.onBufferCreated,this),e.off(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r}){if("main"===n){const e=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:r},this.log(`InitPTS for cc: ${e} found from main: ${i}`),this.videoTrackCC=e,this.state===Qn&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=Hn);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=zn):(this.loadedmetadata=!1,this.state=Vn),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case zn:this.doTickIdle();break;case Vn:{var e;const{levels:t,trackId:n}=this,i=null==t||null==(e=t[n])?void 0:e.details;if(i){if(this.waitForCdnTuneIn(i))break;this.state=Qn}break}case Yn:{var t;const e=performance.now(),n=this.retryDate;(!n||e>=n||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=zn);break}case Qn:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=jn;const e={frag:t,part:n,payload:i.flush(),networkDetails:null};this._handleFragmentLoadProgress(e),r&&super._handleFragmentLoadComplete(e)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),n=Dn.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole);dn(n.end,this.config.maxFragLookUpTolerance,t)<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=zn}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=zn)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,r=e.config;if(null==t||!t[i])return;if(!n&&(this.startFragRequested||!r.startFragPrefetch))return;const s=t[i],a=s.details;if(!a||a.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(a))return void(this.state=Vn);const o=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&o&&(this.bufferFlushed=!1,this.afterBufferFlushed(o,ee,It));const l=this.getFwdBufferInfo(o,It);if(null===l)return;const{bufferedTrack:c,switchingTrack:d}=this;if(!d&&this._streamEnded(l,a))return e.trigger(G.BUFFER_EOS,{type:"audio"}),void(this.state=Xn);const u=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Rt),h=l.len,p=this.getMaxBufferLength(null==u?void 0:u.len);if(h>=p&&!d)return;const f=a.fragments[0].start;let m=l.end;if(d&&n){const e=this.getLoadPosition();c&&d.attrs!==c.attrs&&(m=e),a.PTSKnown&&e<f&&(l.end>f||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=f+.05)}let g=this.getNextFragment(m,a),y=!1;if(g&&this.isLoopLoading(g,m)&&(y=!!g.gap,g=this.getNextFragmentLoopLoading(g,a,l,Rt,p)),!g)return void(this.bufferFlushed=!0);const v=u&&g.start>u.end+a.targetduration;if(v||(null==u||!u.len)&&l.len){const e=this.getAppendedFrag(g.start,Rt);if(null===e)return;if(y||(y=!!e.gap||!!v&&0===u.len),v&&!y||y&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(g,s,m)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map((e=>new Wt(e)))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=zn):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Hn),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(G.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:i}=this,{details:r,id:s}=t;if(!i)return void this.warn(`Audio tracks were reset while loading level ${s}`);this.log(`Track ${s} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=i[s];let o=0;if(r.live||null!=(n=a.details)&&n.live){const e=this.mainDetails;if(r.fragments[0]||(r.deltaUpdateFailed=!0),r.deltaUpdateFailed||!e)return;!a.details&&r.hasProgramDateTime&&e.hasProgramDateTime?(Fn(r,e),o=r.fragments[0].start):o=this.alignPlaylists(r,a.details)}a.details=r,this.levelLastLoaded=s,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(a.details,o),this.state!==Vn||this.waitForCdnTuneIn(r)||(this.state=zn),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const d=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let u=this.transmuxer;u||(u=this.transmuxer=new rr(this.hls,It,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[n.cc],p=null==(t=n.initSegment)?void 0:t.data;if(void 0!==h){const e=!1,t=i?i.index:-1,s=-1!==t,a=new Pn(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);u.push(r,p,d,"",n,i,c.totalduration,e,a,h)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new cr,complete:!1};e.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=Qn}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===It)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(G.AUDIO_TRACK_SWITCHED,F({},e)))}this.fragBufferedComplete(n,i)}else if(!this.loadedmetadata&&n.type===Rt){const e=this.videoBuffer||this.media;e&&Dn.getBuffered(e).length&&(this.loadedmetadata=!0)}}onError(e,t){var n;if(t.fatal)this.state=Zn;else switch(t.details){case z.FRAG_GAP:case z.FRAG_PARSING_ERROR:case z.FRAG_DECRYPT_ERROR:case z.FRAG_LOAD_ERROR:case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_ERROR:case z.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(It,t);break;case z.AUDIO_TRACK_LOAD_ERROR:case z.AUDIO_TRACK_LOAD_TIMEOUT:case z.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Vn||(null==(n=t.context)?void 0:n.type)!==Lt||(this.state=zn);break;case z.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case z.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===ee&&(this.bufferFlushed=!0,this.state===Xn&&(this.state=zn))}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:d}=c,{audio:u,text:h,id3:p,initSegment:f}=r;if(!this.fragContextChanged(o)&&d){if(this.state=Kn,this.switchingTrack&&u&&this.completeAudioSwitch(this.switchingTrack),null!=f&&f.tracks){const e=o.initSegment||o;this._bufferInitSegment(f.tracks,e,s),i.trigger(G.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:f.tracks})}if(u){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=u;l&&(l.elementaryStreams.audio={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(ee,e,t,n,i),this.bufferFragmentData(u,o,l,s)}if(null!=p&&null!=(t=p.samples)&&t.length){const e=U({id:n,frag:o,details:d},p);i.trigger(G.FRAG_PARSING_METADATA,e)}if(h){const e=U({id:n,frag:o,details:d},h);i.trigger(G.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n){if(this.state!==Kn)return;e.video&&delete e.video;const i=e.audio;if(!i)return;i.levelCodec=i.codec,i.id="audio",this.log(`Init audio buffer, container:${i.container}, codecs[parsed]=[${i.codec}]`),this.hls.trigger(G.BUFFER_CODECS,e);const r=i.initSegment;if(null!=r&&r.byteLength){const e={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:r};this.hls.trigger(G.BUFFER_APPENDING,e)}this.tick()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;this.fragCurrent=e,this.switchingTrack||i===vn||i===_n?"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Qn):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:n,bufferedTrack:i}=this,r=null==i?void 0:i.attrs,s=e.attrs;n&&r&&(r.CHANNELS!==s.CHANNELS||r.NAME!==s.NAME||r.LANGUAGE!==s.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(G.AUDIO_TRACK_SWITCHED,F({},e))}},audioTrackController:class extends pn{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(G.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.LEVEL_LOADING,this.onLevelLoading,this),e.off(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(G.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn(`Track with id:${n} and group:${i} not found in active group ${s.groupId}`);const a=s.details;s.details=t.details,this.log(`audio-track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.audioGroupIds)return;const n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;const e=this.tracks.filter((e=>!n||e.groupId===n));this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;const t={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group:${n}`),this.hls.trigger(G.AUDIO_TRACKS_UPDATED,t),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&t.context.type===Lt&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid id passed to audio-track controller");this.clearTimer();const n=this.currentTrack;t[this.trackId];const i=t[e],{groupId:r,name:s}=i;if(this.log(`Switching to audio-track ${e} "${s}" lang:${i.lang} group:${r}`),this.trackId=e,this.currentTrack=i,this.selectDefaultTrack=!1,this.hls.trigger(G.AUDIO_TRACK_SWITCHING,F({},i)),i.details&&!i.details.live)return;const a=this.switchParams(i.url,null==n?void 0:n.details);this.loadPlaylist(a)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{const t=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(G.ERROR,{type:H.MEDIA_ERROR,details:z.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!this.selectDefaultTrack||i.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===i.attrs["STABLE-RENDITION-ID"])return i.id;if(e.name===i.name&&e.lang===i.lang)return i.id}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,i=t.groupId;let r=t.url;if(e)try{r=e.addDirectives(r)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(G.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null})}}},emeController:us,cmcdController:ms,contentSteeringController:class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=V.log.bind(V,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(2===(null==n?void 0:n.action)&&1===n.flags){let e=this.pathwayPriority;const t=this.pathwayId;this.penalizedPathways[t]||(this.penalizedPathways[t]=performance.now()),!e&&this.levels&&(e=this.levels.reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])),e&&e.length>1&&(this.updatePathwayPriority(e),n.resolved=this.pathwayId!==t)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach((e=>{i-n[e]>3e5&&delete n[e]}));for(let i=0;i<e.length;i++){const r=e[i];if(n[r])continue;if(r===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(r),t.length>0){this.log(`Setting Pathway to "${r}"`),this.pathwayId=r,this.hls.trigger(G.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=s);break}}}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach((e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some((e=>e.pathwayId===r)))return;const o=this.getLevelsForPathway(s).map((e=>{const t=U({},e);t.details=void 0,t.url=ys(e.uri,e.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a);const s=new X(e.attrs);s["PATHWAY-ID"]=r;const o=s.AUDIO&&`${s.AUDIO}_clone_${r}`,l=s.SUBTITLES&&`${s.SUBTITLES}_clone_${r}`;o&&(n[s.AUDIO]=o,s.AUDIO=o),l&&(i[s.SUBTITLES]=l,s.SUBTITLES=l),t.attrs=s;const c=new Wt(t);return gn(c,"audio",o),gn(c,"text",l),c}));t.push(...o),gs(this.audioTracks,n,a,r),gs(this.subtitleTracks,i,a,r)}))}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log(`Loaded steering manifest: "${i}"`);const s=e.data;if(1!==s.VERSION)return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,r);else{const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,o,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout((()=>{this.loadSteeringManifest(e)}),t)}}});function Cs(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(Cs):Object.keys(e).reduce(((t,n)=>(t[n]=Cs(e[n]),t)),{}):e}class Ls{static get version(){return"1.4.10"}static isSupported(){return function(){const e=ct();if(!e)return!1;const t=ti(),n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!n&&!!i}()}static get Events(){return G}static get ErrorTypes(){return H}static get ErrorDetails(){return z}static get DefaultConfig(){return Ls.defaultConfig?Ls.defaultConfig:ks}static set DefaultConfig(e){Ls.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new nr,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function(e,t){if(self.console&&!0===e||"object"==typeof e){!function(e,...t){t.forEach((function(t){Y[t]=e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):q}(t)}))}(e,"debug","log","info","warn","error");try{Y.log('Debug logs enabled for "Hls instance" in hls.js version 1.4.10')}catch(e){Y=j}}else Y=j}(e.debug||!1);const t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Cs(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,s=void 0===t[r],a=[];i.forEach((i=>{const o=`${e}Loading${i}`,l=t[o];if(void 0!==l&&s){a.push(o);const e=n[r].default;switch(t[r]={default:e},i){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&V.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${r}": ${JSON.stringify(t[r])}`)})),F(F({},n),t)}(Ls.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&function(e){const t=e.loader;t!==Ts&&t!==bs?(V.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=Ts,e.progressive=!0,e.enableSoftwareAES=!0,V.log("[config]: Progressive streaming enabled, using FetchLoader"))}(t);const{abrController:n,bufferController:i,capLevelController:r,errorController:s,fpsController:a}=t,o=new s(this),l=this.abrController=new n(this),c=this.bufferController=new i(this),d=this.capLevelController=new r(this),u=new a(this),h=new Ot(this),p=new jt(this),f=t.contentSteeringController,m=f?new f(this):null,g=this.levelController=new mn(this,m),y=new En(this),v=new Rn(this.config),b=this.streamController=new ar(this,y,v);d.setStreamController(b),u.setStreamController(b);const _=[h,g,b];m&&_.splice(1,0,m),this.networkControllers=_;const T=[l,c,d,u,p,y];this.audioTrackController=this.createController(t.audioTrackController,_);const E=t.audioStreamController;E&&_.push(new E(this,y,v)),this.subtitleTrackController=this.createController(t.subtitleTrackController,_);const w=t.subtitleStreamController;w&&_.push(new w(this,y,v)),this.createController(t.timelineController,T),v.emeController=this.emeController=this.createController(t.emeController,T),this.cmcdController=this.createController(t.cmcdController,T),this.latencyController=this.createController(Yt,T),this.coreComponents=T,_.push(o);const S=o.onErrorOut;"function"==typeof S&&this.on(G.ERROR,S,o)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){V.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(G.ERROR,{type:H.OTHER_ERROR,details:z.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){V.log("destroy"),this.trigger(G.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){V.log("attachMedia"),this._media=e,this.trigger(G.MEDIA_ATTACHING,{media:e})}detachMedia(){V.log("detachMedia"),this.trigger(G.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=O.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});V.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(G.MANIFEST_LOADING,{url:e})}startLoad(e=-1){V.log(`startLoad(${e})`),this.networkControllers.forEach((t=>{t.startLoad(e)}))}stopLoad(){V.log("stopLoad"),this.networkControllers.forEach((e=>{e.stopLoad()}))}swapAudioCodec(){V.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){V.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){return this.levelController.levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){V.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){V.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){V.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){V.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){V.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(V.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Vt.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&e&&e.length?e.length-1:t,n)for(let t=i;t--;){const i=e[t].attrs["HDCP-LEVEL"];if(i&&i<=n)return t}return i}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Ls.defaultConfig=void 0;var As=n(443),Rs=n.n(As);n(251);const Is=Object.prototype.toString;function Ds(e){switch(Is.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Hs(e,Error)}}function Ps(e,t){return Is.call(e)===`[object ${t}]`}function Ms(e){return Ps(e,"ErrorEvent")}function Os(e){return Ps(e,"DOMError")}function Ns(e){return Ps(e,"String")}function Fs(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function Bs(e){return Ps(e,"Object")}function Us(e){return"undefined"!=typeof Event&&Hs(e,Event)}function $s(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function Gs(e){return"number"==typeof e&&e!=e}function Hs(e,t){try{return e instanceof t}catch(e){return!1}}var zs=n(235);const qs=(0,zs.Rf)();function js(e,t={}){try{let n=e;const i=5,r=[];let s=0,a=0;const o=" > ",l=o.length;let c;const d=Array.isArray(t)?t:t.keyAttrs,u=!Array.isArray(t)&&t.maxStringLength||80;for(;n&&s++<i&&(c=Ys(n,d),!("html"===c||s>1&&a+r.length*l+c.length>=u));)r.push(c),a+=c.length,n=n.parentNode;return r.reverse().join(o)}catch(e){return"<unknown>"}}function Ys(e,t){const n=e,i=[];let r,s,a,o,l;if(!n||!n.tagName)return"";i.push(n.tagName.toLowerCase());const c=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(c&&c.length)c.forEach((e=>{i.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&i.push(`#${n.id}`),r=n.className,r&&Ns(r))for(s=r.split(/\s+/),l=0;l<s.length;l++)i.push(`.${s[l]}`);const d=["aria-label","type","name","title","alt"];for(l=0;l<d.length;l++)a=d[l],o=n.getAttribute(a),o&&i.push(`[${a}="${o}"]`);return i.join("")}function Vs(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function Ks(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const i=e[t];try{n.push(String(i))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function Ws(e,t=[],n=!1){return t.some((t=>function(e,t,n=!1){return!!Ns(e)&&(Ps(t,"RegExp")?t.test(e):!!Ns(t)&&(n?e===t:e.includes(t)))}(e,t,n)))}function Xs(e,t,n){if(!(t in e))return;const i=e[t],r=n(i);if("function"==typeof r)try{Qs(r,i)}catch(e){}e[t]=r}function Zs(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}function Qs(e,t){const n=t.prototype||{};e.prototype=t.prototype=n,Zs(e,"__sentry_original__",t)}function Js(e){return e.__sentry_original__}function ea(e){if(Ds(e))return{message:e.message,name:e.name,stack:e.stack,...na(e)};if(Us(e)){const t={type:e.type,target:ta(e.target),currentTarget:ta(e.currentTarget),...na(e)};return"undefined"!=typeof CustomEvent&&Hs(e,CustomEvent)&&(t.detail=e.detail),t}return e}function ta(e){try{return"undefined"!=typeof Element&&Hs(e,Element)?js(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function na(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function ia(e){return ra(e,new Map)}function ra(e,t){if(Bs(e)){const n=t.get(e);if(void 0!==n)return n;const i={};t.set(e,i);for(const n of Object.keys(e))void 0!==e[n]&&(i[n]=ra(e[n],t));return i}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const i=[];return t.set(e,i),e.forEach((e=>{i.push(ra(e,t))})),i}return e}function sa(){const e=zs.n2,t=e.crypto||e.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");const n=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>16*Math.random();return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function aa(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function oa(e){const{message:t,event_id:n}=e;if(t)return t;const i=aa(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function la(e,t,n){const i=e.exception=e.exception||{},r=i.values=i.values||[],s=r[0]=r[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function ca(e,t){const n=aa(e);if(!n)return;const i=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...i,...t},t&&"data"in t){const e={...i&&i.data,...t.data};n.mechanism.data=e}}function da(e){if(e&&e.__sentry_captured__)return!0;try{Zs(e,"__sentry_captured__",!0)}catch(e){}return!1}function ua(e){return Array.isArray(e)?e:[e]}const ha=["debug","info","warn","error","log","assert","trace"];function pa(e){if(!("console"in zs.n2))return e();const t=zs.n2.console,n={};ha.forEach((e=>{const i=t[e]&&t[e].__sentry_original__;e in t&&i&&(n[e]=t[e],t[e]=i)}));try{return e()}finally{Object.keys(n).forEach((e=>{t[e]=n[e]}))}}function fa(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1}};return"undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?ha.forEach((n=>{t[n]=(...t)=>{e&&pa((()=>{zs.n2.console[n](`Sentry Logger [${n}]:`,...t)}))}})):ha.forEach((e=>{t[e]=()=>{}})),t}let ma;ma="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?(0,zs.YO)("logger",fa):fa();var ga=n(170);const ya="production";var va;function ba(e){return new Ta((t=>{t(e)}))}function _a(e){return new Ta(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"}(va||(va={}));class Ta{constructor(e){Ta.prototype.__init.call(this),Ta.prototype.__init2.call(this),Ta.prototype.__init3.call(this),Ta.prototype.__init4.call(this),this._state=va.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new Ta(((n,i)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){i(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){i(e)}else i(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new Ta(((t,n)=>{let i,r;return this.then((t=>{r=!1,i=t,e&&e()}),(t=>{r=!0,i=t,e&&e()})).then((()=>{r?n(i):t(i)}))}))}__init(){this._resolve=e=>{this._setResult(va.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(va.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===va.PENDING&&($s(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===va.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===va.RESOLVED&&e[1](this._value),this._state===va.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function Ea(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,ga.ph)(),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:sa()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}class wa{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=ka()}static clone(e){const t=new wa;return e&&(t._breadcrumbs=[...e._breadcrumbs],t._tags={...e._tags},t._extra={...e._extra},t._contexts={...e._contexts},t._user=e._user,t._level=e._level,t._span=e._span,t._session=e._session,t._transactionName=e._transactionName,t._fingerprint=e._fingerprint,t._eventProcessors=[...e._eventProcessors],t._requestSession=e._requestSession,t._attachments=[...e._attachments],t._sdkProcessingMetadata={...e._sdkProcessingMetadata},t._propagationContext={...e._propagationContext}),t}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&Ea(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if("function"==typeof e){const t=e(this);return t instanceof wa?t:this}return e instanceof wa?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Bs(e)&&(this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=ka(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const i={timestamp:(0,ga.yW)(),...e};return this._breadcrumbs=[...this._breadcrumbs,i].slice(-n),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,t={}){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};const t=this._span.transaction;if(t){e.sdkProcessingMetadata={dynamicSamplingContext:t.getDynamicSamplingContext(),...e.sdkProcessingMetadata};const n=t.name;n&&(e.tags={transaction:n,...e.tags})}}return this._applyFingerprint(e),e.breadcrumbs=[...e.breadcrumbs||[],...this._breadcrumbs],e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},this._notifyEventProcessors([...Sa(),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_notifyEventProcessors(e,t,n,i=0){return new Ta(((r,s)=>{const a=e[i];if(null===t||"function"!=typeof a)r(t);else{const o=a({...t},n);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&a.id&&null===o&&ma.log(`Event processor "${a.id}" dropped event`),$s(o)?o.then((t=>this._notifyEventProcessors(e,t,n,i+1).then(r))).then(null,s):this._notifyEventProcessors(e,o,n,i+1).then(r).then(null,s)}}))}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}_applyFingerprint(e){e.fingerprint=e.fingerprint?ua(e.fingerprint):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}function Sa(){return(0,zs.YO)("globalEventProcessors",(()=>[]))}function xa(e){Sa().push(e)}function ka(){return{traceId:sa(),spanId:sa().substring(16),sampled:!1}}const Ca=100;class La{constructor(e,t=new wa,n=4){this._version=n,this._stack=[{scope:t}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){this.getStackTop().client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=wa.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1||!this.getStack().pop())}withScope(e){const t=this.pushScope();try{e(t)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const n=this._lastEventId=t&&t.event_id?t.event_id:sa(),i=new Error("Sentry syntheticException");return this._withClient(((r,s)=>{r.captureException(e,{originalException:e,syntheticException:i,...t,event_id:n},s)})),n}captureMessage(e,t,n){const i=this._lastEventId=n&&n.event_id?n.event_id:sa(),r=new Error(e);return this._withClient(((s,a)=>{s.captureMessage(e,t,{originalException:e,syntheticException:r,...n,event_id:i},a)})),i}captureEvent(e,t){const n=t&&t.event_id?t.event_id:sa();return e.type||(this._lastEventId=n),this._withClient(((i,r)=>{i.captureEvent(e,{...t,event_id:n},r)})),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:n,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:r=null,maxBreadcrumbs:s=Ca}=i.getOptions&&i.getOptions()||{};if(s<=0)return;const a={timestamp:(0,ga.yW)(),...e},o=r?pa((()=>r(a,t))):a;null!==o&&(i.emit&&i.emit("beforeAddBreadcrumb",o,t),n.addBreadcrumb(o,s))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t)}configureScope(e){const{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){const t=Ra(this);try{e(this)}finally{Ra(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){const n=this._callExtensionMethod("startTransaction",e,t);return"undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__||n||console.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&function(e,t){let n={};"ok"===e.status&&(n={status:"exited"}),Ea(e,n)}(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:n}=this.getStackTop(),{release:i,environment:r=ya}=n&&n.getOptions()||{},{userAgent:s}=zs.n2.navigator||{},a=function(e){const t=(0,ga.ph)(),n={sid:sa(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return ia({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&Ea(n,e),n}({release:i,environment:r,user:t.getUser(),...s&&{userAgent:s},...e}),o=t.getSession&&t.getSession();return o&&"ok"===o.status&&Ea(o,{status:"exited"}),this.endSession(),t.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_withClient(e){const{scope:t,client:n}=this.getStackTop();n&&e(n,t)}_callExtensionMethod(e,...t){const n=Aa().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Aa(){return zs.n2.__SENTRY__=zs.n2.__SENTRY__||{extensions:{},hub:void 0},zs.n2}function Ra(e){const t=Aa(),n=Da(t);return Pa(t,e),n}function Ia(){const e=Aa();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return function(e=Aa()){return t=e,!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)&&!Da(e).isOlderThan(4)||Pa(e,new La),Da(e);var t}(e)}function Da(e){return(0,zs.YO)("hub",(()=>new La),e)}function Pa(e,t){return!!e&&((e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0)}const Ma=[];function Oa(e){const t=e.defaultIntegrations||[],n=e.integrations;let i;t.forEach((e=>{e.isDefaultInstance=!0})),i=Array.isArray(n)?[...t,...n]:"function"==typeof n?ua(n(t)):t;const r=function(e){const t={};return e.forEach((e=>{const{name:n}=e,i=t[n];i&&!i.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.keys(t).map((e=>t[e]))}(i),s=function(e,t){for(let t=0;t<e.length;t++)if(!0==("Debug"===e[t].name))return t;return-1}(r);if(-1!==s){const[e]=r.splice(s,1);r.push(e)}return r}function Na(e,t){t[e.name]=e,-1===Ma.indexOf(e.name)&&(e.setupOnce(xa,Ia),Ma.push(e.name),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`Integration installed: ${e.name}`))}const Fa=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],Ba=[/^.*healthcheck.*$/,/^.*healthy.*$/,/^.*live.*$/,/^.*ready.*$/,/^.*heartbeat.*$/,/^.*\/health$/,/^.*\/healthz$/];class Ua{static __initStatic(){this.id="InboundFilters"}constructor(e={}){this.name=Ua.id,this._options=e}setupOnce(e,t){const n=e=>{const n=t();if(n){const t=n.getIntegration(Ua);if(t){const i=n.getClient(),r=i?i.getOptions():{},s=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Fa],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:Ba],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(t._options,r);return function(e,t){return t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${oa(e)}`),!0):function(e,t){return!(e.type||!t||!t.length)&&function(e){if(e.message)return[e.message];if(e.exception){const{values:t}=e.exception;try{const{type:e="",value:n=""}=t&&t[t.length-1]||{};return[`${n}`,`${e}: ${n}`]}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error(`Cannot extract message for event ${oa(e)}`),[]}}return[]}(e).some((e=>Ws(e,t)))}(e,t.ignoreErrors)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${oa(e)}`),!0):function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&Ws(n,t)}(e,t.ignoreTransactions)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${oa(e)}`),!0):function(e,t){if(!t||!t.length)return!1;const n=$a(e);return!!n&&Ws(n,t)}(e,t.denyUrls)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${oa(e)}.\nUrl: ${$a(e)}`),!0):!function(e,t){if(!t||!t.length)return!0;const n=$a(e);return!n||Ws(n,t)}(e,t.allowUrls)&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${oa(e)}.\nUrl: ${$a(e)}`),!0)}(e,s)?null:e}}return e};n.id=this.name,e(n)}}function $a(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error(`Cannot extract url for event ${oa(e)}`),null}}let Ga;Ua.__initStatic();class Ha{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=Ha.id}setupOnce(){Ga=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Js(this)||this;return Ga.apply(t,e)}}catch(e){}}}Ha.__initStatic();const za=/\(error: (.*)\)/,qa=/captureMessage|captureException/;function ja(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0)=>{const i=[],r=e.split("\n");for(let e=n;e<r.length;e++){const n=r[e];if(n.length>1024)continue;const s=za.test(n)?n.replace(za,"$1"):n;if(!s.match(/\S*Error: /)){for(const e of t){const t=e(s);if(t){i.push(t);break}}if(i.length>=50)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),qa.test(t[t.length-1].function||"")&&(t.pop(),qa.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,50).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"})))}(i)}}const Ya="<anonymous>";function Va(e){try{return e&&"function"==typeof e&&e.name||Ya}catch(e){return Ya}}const Ka=(0,zs.Rf)();function Wa(){if(!("fetch"in Ka))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function Xa(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}const Za=(0,zs.Rf)(),Qa=(0,zs.Rf)(),Ja={},eo={};function to(e,t){Ja[e]=Ja[e]||[],Ja[e].push(t),function(e){if(!eo[e])switch(eo[e]=!0,e){case"console":"console"in Qa&&ha.forEach((function(e){e in Qa.console&&Xs(Qa.console,e,(function(t){return function(...n){no("console",{args:n,level:e}),t&&t.apply(Qa.console,n)}}))}));break;case"dom":!function(){if(!("document"in Qa))return;const e=no.bind(null,"dom"),t=lo(e,!0);Qa.document.addEventListener("click",t,!1),Qa.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=Qa[t]&&Qa[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(Xs(n,"addEventListener",(function(t){return function(n,i,r){if("click"===n||"keypress"==n)try{const i=this,s=i.__sentry_instrumentation_handlers__=i.__sentry_instrumentation_handlers__||{},a=s[n]=s[n]||{refCount:0};if(!a.handler){const i=lo(e);a.handler=i,t.call(this,n,i,r)}a.refCount++}catch(e){}return t.call(this,n,i,r)}})),Xs(n,"removeEventListener",(function(e){return function(t,n,i){if("click"===t||"keypress"==t)try{const n=this,r=n.__sentry_instrumentation_handlers__||{},s=r[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,i),s.handler=void 0,delete r[t]),0===Object.keys(r).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,i)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in Qa))return;const e=XMLHttpRequest.prototype;Xs(e,"open",(function(e){return function(...t){const n=t[1],i=this.__sentry_xhr_v2__={method:Ns(t[0])?t[0].toUpperCase():t[0],url:t[1],request_headers:{}};Ns(n)&&"POST"===i.method&&n.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const r=()=>{const e=this.__sentry_xhr_v2__;if(e&&4===this.readyState){try{e.status_code=this.status}catch(e){}no("xhr",{args:t,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?Xs(this,"onreadystatechange",(function(e){return function(...t){return r(),e.apply(this,t)}})):this.addEventListener("readystatechange",r),Xs(this,"setRequestHeader",(function(e){return function(...t){const[n,i]=t,r=this.__sentry_xhr_v2__;return r&&(r.request_headers[n.toLowerCase()]=i),e.apply(this,t)}})),e.apply(this,t)}})),Xs(e,"send",(function(e){return function(...t){const n=this.__sentry_xhr_v2__;return n&&void 0!==t[0]&&(n.body=t[0]),no("xhr",{args:t,startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}}))}();break;case"fetch":(function(){if(!Wa())return!1;if(Xa(Ka.fetch))return!0;let e=!1;const t=Ka.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=Xa(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e})()&&Xs(Qa,"fetch",(function(e){return function(...t){const{method:n,url:i}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:ro(t),method:io(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:ro(t),method:io(t,"method")?String(t.method).toUpperCase():"GET"}}(t),r={args:t,fetchData:{method:n,url:i},startTimestamp:Date.now()};return no("fetch",{...r}),e.apply(Qa,t).then((e=>(no("fetch",{...r,endTimestamp:Date.now(),response:e}),e)),(e=>{throw no("fetch",{...r,endTimestamp:Date.now(),error:e}),e}))}}));break;case"history":!function(){if(!function(){const e=Za.chrome,t=e&&e.app&&e.app.runtime,n="history"in Za&&!!Za.history.pushState&&!!Za.history.replaceState;return!t&&n}())return;const e=Qa.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=so,t=String(n);so=t,no("history",{from:e,to:t})}return e.apply(this,t)}}Qa.onpopstate=function(...t){const n=Qa.location.href,i=so;if(so=n,no("history",{from:i,to:n}),e)try{return e.apply(this,t)}catch(e){}},Xs(Qa.history,"pushState",t),Xs(Qa.history,"replaceState",t)}();break;case"error":co=Qa.onerror,Qa.onerror=function(e,t,n,i,r){return no("error",{column:i,error:r,line:n,msg:e,url:t}),!(!co||co.__SENTRY_LOADER__)&&co.apply(this,arguments)},Qa.onerror.__SENTRY_INSTRUMENTED__=!0;break;case"unhandledrejection":uo=Qa.onunhandledrejection,Qa.onunhandledrejection=function(e){return no("unhandledrejection",e),!(uo&&!uo.__SENTRY_LOADER__)||uo.apply(this,arguments)},Qa.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0;break;default:("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("unknown instrumentation type:",e)}}(e)}function no(e,t){if(e&&Ja[e])for(const n of Ja[e]||[])try{n(t)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Va(n)}\nError:`,t)}}function io(e,t){return!!e&&"object"==typeof e&&!!e[t]}function ro(e){return"string"==typeof e?e:e?io(e,"url")?e.url:e.toString?e.toString():"":""}let so,ao,oo;function lo(e,t=!1){return n=>{if(!n||oo===n)return;if(function(e){if("keypress"!==e.type)return!1;try{const t=e.target;if(!t||!t.tagName)return!0;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return!1}catch(e){}return!0}(n))return;const i="keypress"===n.type?"input":n.type;(void 0===ao||function(e,t){if(!e)return!0;if(e.type!==t.type)return!0;try{if(e.target!==t.target)return!0}catch(e){}return!1}(oo,n))&&(e({event:n,name:i,global:t}),oo=n),clearTimeout(ao),ao=Qa.setTimeout((()=>{ao=void 0}),1e3)}}let co=null,uo=null;const ho=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function po(e,t=!1){const{host:n,path:i,pass:r,port:s,projectId:a,protocol:o,publicKey:l}=e;return`${o}://${l}${t&&r?`:${r}`:""}@${n}${s?`:${s}`:""}/${i?`${i}/`:i}${a}`}function fo(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function mo(e,t=100,n=1/0){try{return yo("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function go(e,t=3,n=102400){const i=mo(e,t);return r=i,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(r))>n?go(e,t-1,n):i;var r}function yo(e,t,i=1/0,r=1/0,s=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[a,o]=s;if(null==t||["number","boolean","string"].includes(typeof t)&&!Gs(t))return t;const l=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if(void 0!==n.g&&t===n.g)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(Bs(i=t)&&"nativeEvent"in i&&"preventDefault"in i&&"stopPropagation"in i)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${Va(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var i}(e,t);if(!l.startsWith("[object "))return l;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:i;if(0===c)return l.replace("object ","");if(a(t))return"[Circular ~]";const d=t;if(d&&"function"==typeof d.toJSON)try{return yo("",d.toJSON(),c-1,r,s)}catch(e){}const u=Array.isArray(t)?[]:{};let h=0;const p=ea(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(h>=r){u[e]="[MaxProperties ~]";break}const t=p[e];u[e]=yo(e,t,c-1,r,s),h++}return o(t),u}function vo(e,t=[]){return[e,t]}function bo(e,t){const[n,i]=e;return[n,[...i,t]]}function _o(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function To(e,t){return(t||new TextEncoder).encode(e)}function Eo(e,t){const[n,i]=e;let r=JSON.stringify(n);function s(e){"string"==typeof r?r="string"==typeof e?r+e:[To(r,t),e]:r.push("string"==typeof e?To(e,t):e)}for(const e of i){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(mo(n))}s(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let i=0;for(const t of e)n.set(t,i),i+=t.length;return n}(r)}function wo(e,t){const n="string"==typeof e.data?To(e.data,t):e.data;return[ia({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const So={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function xo(e){return So[e]}function ko(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}class Co extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}function Lo(e,t={}){const n="string"==typeof t?t:t.tunnel,i="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){return`${function(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){return n={sentry_key:e.publicKey,sentry_version:"7",...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}(e,i)}`}function Ao(e,t,n){const i=t.getOptions(),{publicKey:r}=t.getDsn()||{},{segment:s}=n&&n.getUser()||{},a=ia({environment:i.environment||ya,release:i.release,user_segment:s,public_key:r,trace_id:e});return t.emit&&t.emit("createDsc",a),a}const Ro=new WeakMap,Io="Not capturing exception because it's already been captured.";function Do(e){return void 0===e.type}function Po(e){return"transaction"===e.type}const Mo="7.61.1";var Oo=n(518);function No(e,t){const n=Bo(e,t),i={type:t&&t.name,value:$o(t)};return n.length&&(i.stacktrace={frames:n}),void 0===i.type&&""===i.value&&(i.value="Unrecoverable error caught"),i}function Fo(e,t){return{exception:{values:[No(e,t)]}}}function Bo(e,t){const n=t.stacktrace||t.stack||"",i=function(e){if(e){if("number"==typeof e.framesToPop)return e.framesToPop;if(Uo.test(e.message))return 1}return 0}(t);try{return e(n,i)}catch(e){}return[]}const Uo=/Minified React error #\d+;/i;function $o(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Go(e,t,n,i,r){let s;if(Ms(t)&&t.error)return Fo(e,t.error);if(Os(t)||Ps(t,"DOMException")){const r=t;if("stack"in t)s=Fo(e,t);else{const t=r.name||(Os(r)?"DOMError":"DOMException"),a=r.message?`${t}: ${r.message}`:t;s=Ho(e,a,n,i),la(s,a)}return"code"in r&&(s.tags={...s.tags,"DOMException.code":`${r.code}`}),s}return Ds(t)?Fo(e,t):Bs(t)||Us(t)?(s=function(e,t,n,i){const r=Ia().getClient(),s=r&&r.getOptions().normalizeDepth,a={exception:{values:[{type:Us(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:zo(t,{isUnhandledRejection:i})}]},extra:{__serialized__:go(t,s)}};if(n){const t=Bo(e,n);t.length&&(a.exception.values[0].stacktrace={frames:t})}return a}(e,t,n,r),ca(s,{synthetic:!0}),s):(s=Ho(e,t,n,i),la(s,`${t}`,void 0),ca(s,{synthetic:!0}),s)}function Ho(e,t,n,i){const r={message:t};if(i&&n){const i=Bo(e,n);i.length&&(r.exception={values:[{value:t,stacktrace:{frames:i}}]})}return r}function zo(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(ea(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return Vs(n[0],t);for(let e=n.length;e>0;e--){const i=n.slice(0,e).join(", ");if(!(i.length>t))return e===n.length?i:Vs(i,t)}return""}(e),i=t?"promise rejection":"exception";return Ms(e)?`Event \`ErrorEvent\` captured as ${i} with message \`${e.message}\``:Us(e)?`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function qo(e,t){return Ia().captureException(e,{captureContext:t})}function jo(e){Ia().withScope(e)}const Yo=zs.n2;let Vo=0;function Ko(){return Vo>0}function Wo(){Vo++,setTimeout((()=>{Vo--}))}function Xo(e,t={},n){if("function"!=typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if(Js(e))return e}catch(t){return e}const i=function(){const i=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const r=i.map((e=>Xo(e,t)));return e.apply(this,r)}catch(e){throw Wo(),jo((n=>{n.addEventProcessor((e=>(t.mechanism&&(la(e,void 0,void 0),ca(e,t.mechanism)),e.extra={...e.extra,arguments:i},e))),qo(e)})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t])}catch(e){}Qs(i,e),Zs(e,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get:()=>e.name})}catch(e){}return i}const Zo=["fatal","error","warning","log","info","debug"];function Qo(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}const Jo="Breadcrumbs";class el{static __initStatic(){this.id=Jo}constructor(e){this.name=el.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e}}setupOnce(){var e;this.options.console&&to("console",tl),this.options.dom&&to("dom",(e=this.options.dom,function(t){let n,i="object"==typeof e?e.serializeAttribute:void 0,r="object"==typeof e&&"number"==typeof e.maxStringLength?e.maxStringLength:void 0;r&&r>1024&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${r} was configured. Sentry will use 1024 instead.`),r=1024),"string"==typeof i&&(i=[i]);try{const e=t.event;n=function(e){return!!e&&!!e.target}(e)?js(e.target,{keyAttrs:i,maxStringLength:r}):js(e,{keyAttrs:i,maxStringLength:r})}catch(e){n="<unknown>"}0!==n.length&&Ia().addBreadcrumb({category:`ui.${t.name}`,message:n},{event:t.event,name:t.name,global:t.global})})),this.options.xhr&&to("xhr",nl),this.options.fetch&&to("fetch",il),this.options.history&&to("history",rl)}addSentryBreadcrumb(e){this.options.sentry&&Ia().addBreadcrumb({category:"sentry."+("transaction"===e.type?"transaction":"event"),event_id:e.event_id,level:e.level,message:oa(e)},{event:e})}}function tl(e){for(let t=0;t<e.args.length;t++)if("ref=Ref<"===e.args[t]){e.args[t+1]="viewRef";break}const t={category:"console",data:{arguments:e.args,logger:"console"},level:(n=e.level,"warn"===n?"warning":Zo.includes(n)?n:"log"),message:Ks(e.args," ")};var n;if("assert"===e.level){if(!1!==e.args[0])return;t.message=`Assertion failed: ${Ks(e.args.slice(1)," ")||"console.assert"}`,t.data.arguments=e.args.slice(1)}Ia().addBreadcrumb(t,{input:e.args,level:e.level})}function nl(e){const{startTimestamp:t,endTimestamp:n}=e,i=e.xhr.__sentry_xhr_v2__;if(!t||!n||!i)return;const{method:r,url:s,status_code:a,body:o}=i,l={method:r,url:s,status_code:a},c={xhr:e.xhr,input:o,startTimestamp:t,endTimestamp:n};Ia().addBreadcrumb({category:"xhr",data:l,type:"http"},c)}function il(e){const{startTimestamp:t,endTimestamp:n}=e;if(n&&(!e.fetchData.url.match(/sentry_key/)||"POST"!==e.fetchData.method))if(e.error){const i=e.fetchData,r={data:e.error,input:e.args,startTimestamp:t,endTimestamp:n};Ia().addBreadcrumb({category:"fetch",data:i,level:"error",type:"http"},r)}else{const i={...e.fetchData,status_code:e.response&&e.response.status},r={input:e.args,response:e.response,startTimestamp:t,endTimestamp:n};Ia().addBreadcrumb({category:"fetch",data:i,type:"http"},r)}}function rl(e){let t=e.from,n=e.to;const i=Qo(Yo.location.href);let r=Qo(t);const s=Qo(n);r.path||(r=i),i.protocol===s.protocol&&i.host===s.host&&(n=s.relative),i.protocol===r.protocol&&i.host===r.host&&(t=r.relative),Ia().addBreadcrumb({category:"navigation",data:{from:t,to:n}})}el.__initStatic();class sl extends class{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},e.dsn?this._dsn=function(e){const t="string"==typeof e?function(e){const t=ho.exec(e);if(!t)return void console.error(`Invalid Sentry Dsn: ${e}`);const[n,i,r="",s,a="",o]=t.slice(1);let l="",c=o;const d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){const e=c.match(/^\d+/);e&&(c=e[0])}return fo({host:s,pass:r,path:l,projectId:c,port:a,protocol:n,publicKey:i})}(e):fo(e);if(t&&function(e){if("undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__)return!0;const{port:t,projectId:n,protocol:i}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(ma.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(i)?t&&isNaN(parseInt(t,10))&&(ma.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(ma.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),1):(ma.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}(e.dsn):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("No DSN provided, client will not do anything."),this._dsn){const t=Lo(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if(da(e))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(Io));let i=t&&t.event_id;return this._process(this.eventFromException(e,t).then((e=>this._captureEvent(e,t,n))).then((e=>{i=e}))),i}captureMessage(e,t,n,i){let r=n&&n.event_id;const s=Fs(e)?this.eventFromMessage(String(e),t,n):this.eventFromException(e,n);return this._process(s.then((e=>this._captureEvent(e,n,i))).then((e=>{r=e}))),r}captureEvent(e,t,n){if(t&&t.originalException&&da(t.originalException))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(Io));let i=t&&t.event_id;return this._process(this._captureEvent(e,t,n).then((e=>{i=e}))),i}captureSession(e){this._isEnabled()?"string"!=typeof e.release?("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Ea(e,{init:!1})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("SDK not enabled, will not capture session.")}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e)))):ba(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,e)))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=function(e){const t={};return e.forEach((e=>{e&&Na(e,t)})),t}(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){Na(e,this._integrations)}sendEvent(e,t={}){if(this._dsn){let n=function(e,t,n,i){const r=ko(n),s=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const a=function(e,t,n,i){const r=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&{dsn:po(i)},...r&&{trace:ia({...r})}}}(e,r,i,t);return delete e.sdkProcessingMetadata,vo(a,[[{type:s},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=bo(n,wo(e,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(n);i&&i.then((t=>this.emit("afterSendEvent",e,t)),null)}}sendSession(e){if(this._dsn){const t=function(e,t,n,i){const r=ko(n);return vo({sent_at:(new Date).toISOString(),...r&&{sdk:r},...!!i&&{dsn:po(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}_updateSessionFromEvent(e,t){let n=!1,i=!1;const r=t.exception&&t.exception.values;if(r){i=!0;for(const e of r){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const s="ok"===e.status;(s&&0===e.errors||s&&n)&&(Ea(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Ta((t=>{let n=0;const i=setInterval((()=>{0==this._numProcessing?(clearInterval(i),t(!0)):(n+=1,e&&n>=e&&(clearInterval(i),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._dsn}_prepareEvent(e,t,n){const i=this.getOptions(),r=Object.keys(this._integrations);return!t.integrations&&r.length>0&&(t.integrations=r),function(e,t,n,i){const{normalizeDepth:r=3,normalizeMaxBreadth:s=1e3}=e,a={...t,event_id:t.event_id||n.event_id||sa(),timestamp:t.timestamp||(0,ga.yW)()},o=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:i,dist:r,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:ya),void 0===e.release&&void 0!==i&&(e.release=i),void 0===e.dist&&void 0!==r&&(e.dist=r),e.message&&(e.message=Vs(e.message,s));const a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=Vs(a.value,s));const o=e.request;o&&o.url&&(o.url=Vs(o.url,s))}(a,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(a,o),void 0===t.type&&function(e,t){const n=zs.n2._sentryDebugIds;if(!n)return;let i;const r=Ro.get(t);r?i=r:(i=new Map,Ro.set(t,i));const s=Object.keys(n).reduce(((e,r)=>{let s;const a=i.get(r);a?s=a:(s=t(r),i.set(r,s));for(let t=s.length-1;t>=0;t--){const i=s[t];if(i.filename){e[i.filename]=n[r];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=s[e.filename])}))}))}catch(e){}}(a,e.stackParser);let l=i;n.captureContext&&(l=wa.clone(l).update(n.captureContext));let c=ba(a);if(l){if(l.getAttachments){const e=[...n.attachments||[],...l.getAttachments()];e.length&&(n.attachments=e)}c=l.applyToEvent(a,n)}return c.then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"==typeof r&&r>0?function(e,t,n){if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:mo(e.data,t,n)}})))},...e.user&&{user:mo(e.user,t,n)},...e.contexts&&{contexts:mo(e.contexts,t,n)},...e.extra&&{extra:mo(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=mo(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map((e=>(e.data&&(e.data=mo(e.data,t,n)),e)))),i}(e,r,s):e)))}(i,e,t,n).then((e=>{if(null===e)return e;const{propagationContext:t}=e.sdkProcessingMetadata||{};if((!e.contexts||!e.contexts.trace)&&t){const{traceId:i,spanId:r,parentSpanId:s,dsc:a}=t;e.contexts={trace:{trace_id:i,span_id:r,parent_span_id:s},...e.contexts};const o=a||Ao(i,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:o,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const t=e;"log"===t.logLevel?ma.log(t.message):ma.warn(t)}}))}_processEvent(e,t,n){const i=this.getOptions(),{sampleRate:r}=i;if(!this._isEnabled())return _a(new Co("SDK not enabled, will not capture event.","log"));const s=Po(e),a=Do(e),o=e.type||"error",l=`before send for type \`${o}\``;if(a&&"number"==typeof r&&Math.random()>r)return this.recordDroppedEvent("sample_rate","error",e),_a(new Co(`Discarding event because it's not included in the random sample (sampling rate = ${r})`,"log"));const c="replay_event"===o?"replay":o;return this._prepareEvent(e,t,n).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",c,e),new Co("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const r=function(e,t,n){const{beforeSend:i,beforeSendTransaction:r}=e;return Do(t)&&i?i(t,n):Po(t)&&r?r(t,n):t}(i,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if($s(e))return e.then((e=>{if(!Bs(e)&&null!==e)throw new Co(n);return e}),(e=>{throw new Co(`${t} rejected with ${e}`)}));if(!Bs(e)&&null!==e)throw new Co(n);return e}(r,l)})).then((i=>{if(null===i)throw this.recordDroppedEvent("before_send",c,e),new Co(`${l} returned \`null\`, will not send event.`,"log");const r=n&&n.getSession();!s&&r&&this._updateSessionFromEvent(r,i);const a=i.transaction_info;if(s&&a&&i.transaction!==e.transaction){const e="custom";i.transaction_info={...a,source:e}}return this.sendEvent(i,t),i})).then(null,(e=>{if(e instanceof Co)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new Co(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_sendEnvelope(e){if(this._transport&&this._dsn)return this.emit("beforeEnvelope",e),this._transport.send(e).then(null,(e=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error("Error while sending event:",e)}));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,i]=t.split(":");return{reason:n,category:i,quantity:e[t]}}))}}{constructor(e){const t=Yo.SENTRY_SDK_SOURCE||(0,Oo.S)();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${t}:@sentry/browser`,version:Mo}],version:Mo},super(e),e.sendClientReports&&Yo.document&&Yo.document.addEventListener("visibilitychange",(()=>{"hidden"===Yo.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return function(e,t,n,i){const r=Go(e,t,n&&n.syntheticException||void 0,i);return ca(r),r.level="error",n&&n.event_id&&(r.event_id=n.event_id),ba(r)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",i,r){const s=Ho(e,t,i&&i.syntheticException||void 0,r);return s.level=n,i&&i.event_id&&(s.event_id=i.event_id),ba(s)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}sendEvent(e,t){const n=this.getIntegrationById(Jo);n&&n.addSentryBreadcrumb&&n.addSentryBreadcrumb(e),super.sendEvent(e,t)}captureUserFeedback(e){if(!this._isEnabled())return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("SDK not enabled, will not capture user feedback."));const t=function(e,{metadata:t,tunnel:n,dsn:i}){const r={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!i&&{dsn:po(i)}},s=function(e){return[{type:"user_report"},e]}(e);return vo(r,[s])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){const e=this._clearOutcomes();if(0===e.length)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("No outcomes to send"));if(!this._dsn)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("No dsn provided, will not send outcomes"));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("Sending outcomes:",e);const t=(n=e,vo((i=this._options.tunnel&&po(this._dsn))?{dsn:i}:{},[[{type:"client_report"},{timestamp:(0,ga.yW)(),discarded_events:n}]]));var n,i;this._sendEnvelope(t)}}class al{static __initStatic(){this.id="GlobalHandlers"}constructor(e){this.name=al.id,this._options={onerror:!0,onunhandledrejection:!0,...e},this._installFunc={onerror:ol,onunhandledrejection:ll}}setupOnce(){Error.stackTraceLimit=50;const e=this._options;for(const n in e){const i=this._installFunc[n];i&&e[n]&&(t=n,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`Global Handler attached: ${t}`),i(),this._installFunc[n]=void 0)}var t}}function ol(){to("error",(e=>{const[t,n,i]=ul();if(!t.getIntegration(al))return;const{msg:r,url:s,line:a,column:o,error:l}=e;if(Ko()||l&&l.__sentry_own_request__)return;const c=void 0===l&&Ns(r)?function(e,t,n,i){let r=Ms(e)?e.message:e,s="Error";const a=r.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);return a&&(s=a[1],r=a[2]),cl({exception:{values:[{type:s,value:r}]}},t,n,i)}(r,s,a,o):cl(Go(n,l||r,void 0,i,!1),s,a,o);c.level="error",dl(t,l,c,"onerror")}))}function ll(){to("unhandledrejection",(e=>{const[t,n,i]=ul();if(!t.getIntegration(al))return;let r=e;try{"reason"in e?r=e.reason:"detail"in e&&"reason"in e.detail&&(r=e.detail.reason)}catch(e){}if(Ko()||r&&r.__sentry_own_request__)return!0;const s=Fs(r)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(r)}`}]}}:Go(n,r,void 0,i,!0);s.level="error",dl(t,r,s,"onunhandledrejection")}))}function cl(e,t,n,i){const r=e.exception=e.exception||{},s=r.values=r.values||[],a=s[0]=s[0]||{},o=a.stacktrace=a.stacktrace||{},l=o.frames=o.frames||[],c=isNaN(parseInt(i,10))?void 0:i,d=isNaN(parseInt(n,10))?void 0:n,u=Ns(t)&&t.length>0?t:function(){try{return qs.document.location.href}catch(e){return""}}();return 0===l.length&&l.push({colno:c,filename:u,function:"?",in_app:!0,lineno:d}),e}function dl(e,t,n,i){ca(n,{handled:!1,type:i}),e.captureEvent(n,{originalException:t})}function ul(){const e=Ia(),t=e.getClient(),n=t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[e,n.stackParser,n.attachStacktrace]}al.__initStatic();const hl=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class pl{static __initStatic(){this.id="TryCatch"}constructor(e){this.name=pl.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e}}setupOnce(){this._options.setTimeout&&Xs(Yo,"setTimeout",fl),this._options.setInterval&&Xs(Yo,"setInterval",fl),this._options.requestAnimationFrame&&Xs(Yo,"requestAnimationFrame",ml),this._options.XMLHttpRequest&&"XMLHttpRequest"in Yo&&Xs(XMLHttpRequest.prototype,"send",gl);const e=this._options.eventTarget;e&&(Array.isArray(e)?e:hl).forEach(yl)}}function fl(e){return function(...t){const n=t[0];return t[0]=Xo(n,{mechanism:{data:{function:Va(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}}function ml(e){return function(t){return e.apply(this,[Xo(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Va(e)},handled:!0,type:"instrument"}})])}}function gl(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&Xs(n,e,(function(t){const n={mechanism:{data:{function:e,handler:Va(t)},handled:!0,type:"instrument"}},i=Js(t);return i&&(n.mechanism.data.handler=Va(i)),Xo(t,n)}))})),e.apply(this,t)}}function yl(e){const t=Yo,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(Xs(n,"addEventListener",(function(t){return function(n,i,r){try{"function"==typeof i.handleEvent&&(i.handleEvent=Xo(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Va(i),target:e},handled:!0,type:"instrument"}}))}catch(e){}return t.apply(this,[n,Xo(i,{mechanism:{data:{function:"addEventListener",handler:Va(i),target:e},handled:!0,type:"instrument"}}),r])}})),Xs(n,"removeEventListener",(function(e){return function(t,n,i){const r=n;try{const n=r&&r.__sentry_wrapped__;n&&e.call(this,t,n,i)}catch(e){}return e.call(this,t,r,i)}})))}function vl(e,t,n=250,i,r,s,a){if(!(s.exception&&s.exception.values&&a&&Hs(a.originalException,Error)))return;const o=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var l,c;o&&(s.exception.values=(l=bl(e,t,r,a.originalException,i,s.exception.values,o,0),c=n,l.map((e=>(e.value&&(e.value=Vs(e.value,c)),e)))))}function bl(e,t,n,i,r,s,a,o){if(s.length>=n+1)return s;let l=[...s];if(Hs(i[r],Error)){_l(a,o);const s=e(t,i[r]),c=l.length;Tl(s,r,c,o),l=bl(e,t,n,i[r],r,[s,...l],s,c)}return Array.isArray(i.errors)&&i.errors.forEach(((i,s)=>{if(Hs(i,Error)){_l(a,o);const c=e(t,i),d=l.length;Tl(c,`errors[${s}]`,d,o),l=bl(e,t,n,i,r,[c,...l],c,d)}})),l}function _l(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,is_exception_group:!0,exception_id:t}}function Tl(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}pl.__initStatic();class El{static __initStatic(){this.id="LinkedErrors"}constructor(e={}){this.name=El.id,this._key=e.key||"cause",this._limit=e.limit||5}setupOnce(e,t){e(((e,n)=>{const i=t(),r=i.getClient(),s=i.getIntegration(El);if(!r||!s)return e;const a=r.getOptions();return vl(No,a.stackParser,a.maxValueLength,s._key,s._limit,e,n),e}))}}El.__initStatic();class wl{static __initStatic(){this.id="HttpContext"}constructor(){this.name=wl.id}setupOnce(){xa((e=>{if(Ia().getIntegration(wl)){if(!Yo.navigator&&!Yo.location&&!Yo.document)return e;const t=e.request&&e.request.url||Yo.location&&Yo.location.href,{referrer:n}=Yo.document||{},{userAgent:i}=Yo.navigator||{},r={...e.request&&e.request.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},s={...e.request,...t&&{url:t},headers:r};return{...e,request:s}}return e}))}}wl.__initStatic();class Sl{static __initStatic(){this.id="Dedupe"}constructor(){this.name=Sl.id}setupOnce(e,t){const n=e=>{if(e.type)return e;const n=t().getIntegration(Sl);if(n){try{if(function(e,t){return!!t&&(!!function(e,t){const n=e.message,i=t.message;return!(!n&&!i)&&(!(n&&!i||!n&&i)&&(n===i&&(!!kl(e,t)&&!!xl(e,t))))}(e,t)||!!function(e,t){const n=Cl(t),i=Cl(e);return!(!n||!i)&&(n.type===i.type&&n.value===i.value&&(!!kl(e,t)&&!!xl(e,t)))}(e,t))}(e,n._previousEvent))return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(t){return n._previousEvent=e}return n._previousEvent=e}return e};n.id=this.name,e(n)}}function xl(e,t){let n=Ll(e),i=Ll(t);if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;if(i.length!==n.length)return!1;for(let e=0;e<i.length;e++){const t=i[e],r=n[e];if(t.filename!==r.filename||t.lineno!==r.lineno||t.colno!==r.colno||t.function!==r.function)return!1}return!0}function kl(e,t){let n=e.fingerprint,i=t.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;try{return!(n.join("")!==i.join(""))}catch(e){return!1}}function Cl(e){return e.exception&&e.exception.values&&e.exception.values[0]}function Ll(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}Sl.__initStatic();const Al="?";function Rl(e,t,n,i){const r={filename:e,function:t,in_app:!0};return void 0!==n&&(r.lineno=n),void 0!==i&&(r.colno=i),r}const Il=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Dl=/\((\S*)(?::(\d+))(?::(\d+))\)/,Pl=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Ml=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ol=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Nl=ja([30,e=>{const t=Il.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){const e=Dl.exec(t[2]);e&&(t[2]=e[1],t[3]=e[2],t[4]=e[3])}const[e,n]=Fl(t[1]||Al,t[2]);return Rl(n,e,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,e=>{const t=Pl.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=Ml.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||Al;return[n,e]=Fl(n,e),Rl(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],[40,e=>{const t=Ol.exec(e);return t?Rl(t[2],t[1]||Al,+t[3],t[4]?+t[4]:void 0):void 0}]),Fl=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),i=-1!==e.indexOf("safari-web-extension");return n||i?[-1!==e.indexOf("@")?e.split("@")[0]:Al,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};function Bl(e,t,n=function(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(i){if(!(void 0===e||t.length<e))return _a(new Co("Not adding Promise because buffer limit was reached."));const r=i();return-1===t.indexOf(r)&&t.push(r),r.then((()=>n(r))).then(null,(()=>n(r).then(null,(()=>{})))),r},drain:function(e){return new Ta(((n,i)=>{let r=t.length;if(!r)return n(!0);const s=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{ba(e).then((()=>{--r||(clearTimeout(s),n(!0))}),i)}))}))}}}(e.bufferSize||30)){let i={};function r(r){const s=[];if(_o(r,((t,n)=>{const r=xo(n);if(function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(i,r)){const i=Ul(t,n);e.recordDroppedEvent("ratelimit_backoff",r,i)}else s.push(t)})),0===s.length)return ba();const a=vo(r[0],s),o=t=>{_o(a,((n,i)=>{const r=Ul(n,i);e.recordDroppedEvent(t,xo(i),r)}))};return n.add((()=>t({body:Eo(a,e.textEncoder)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),i=function(e,{statusCode:t,headers:n},i=Date.now()){const r={...e},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(const e of s.trim().split(",")){const[t,n]=e.split(":",2),s=parseInt(t,10),a=1e3*(isNaN(s)?60:s);if(n)for(const e of n.split(";"))r[e]=i+a;else r.all=i+a}else a?r.all=i+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const i=Date.parse(`${e}`);return isNaN(i)?6e4:i-t}(a,i):429===t&&(r.all=i+6e4);return r}(i,e),e)),(e=>{throw o("network_error"),e})))).then((e=>e),(e=>{if(e instanceof Co)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error("Skipped sending event because buffer is full."),o("queue_overflow"),ba();throw e}))}return r.__sentry__baseTransport__=!0,{send:r,flush:e=>n.drain(e)}}function Ul(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}let $l;function Gl(e,t=function(){if($l)return $l;if(Xa(Yo.fetch))return $l=Yo.fetch.bind(Yo);const e=Yo.document;let t=Yo.fetch;if(e&&"function"==typeof e.createElement)try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const i=n.contentWindow;i&&i.fetch&&(t=i.fetch),e.head.removeChild(n)}catch(e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return $l=t.bind(Yo)}()){let n=0,i=0;return Bl(e,(function(r){const s=r.body.length;n+=s,i++;const a={body:r.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};try{return t(e.url,a).then((e=>(n-=s,i--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return $l=void 0,n-=s,i--,_a(e)}}))}function Hl(e){return Bl(e,(function(t){return new Ta(((n,i)=>{const r=new XMLHttpRequest;r.onerror=i,r.onreadystatechange=()=>{4===r.readyState&&n({statusCode:r.status,headers:{"x-sentry-rate-limits":r.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":r.getResponseHeader("Retry-After")}})},r.open("POST",e.url);for(const t in e.headers)Object.prototype.hasOwnProperty.call(e.headers,t)&&r.setRequestHeader(t,e.headers[t]);r.send(t.body)}))}))}const zl=[new Ua,new Ha,new pl,new el,new al,new El,new Sl,new wl];function ql(e){e.startSession({ignoreDuration:!0}),e.captureSession()}const jl="baggage",Yl=/^sentry-/;function Vl(e){if(e)return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce(((e,[t,n],i)=>{const r=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,s=0===i?r:`${e},${r}`;return s.length>8192?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):s}),"")}(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`sentry-${t}`]=n),e)),{}))}function Kl(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(e[t]=n,e)),{})}const Wl=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Xl(e=sa(),t=sa().substring(16),n){let i="";return void 0!==n&&(i=n?"-1":"-0"),`${e}-${t}${i}`}class Zl{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class Ql{constructor(e){if(this.traceId=sa(),this.spanId=sa().substring(16),this.startTimestamp=(0,ga.ph)(),this.tags={},this.data={},this.instrumenter="sentry",!e)return this;e.traceId&&(this.traceId=e.traceId),e.spanId&&(this.spanId=e.spanId),e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.data&&(this.data=e.data),e.tags&&(this.tags=e.tags),e.status&&(this.status=e.status),e.startTimestamp&&(this.startTimestamp=e.startTimestamp),e.endTimestamp&&(this.endTimestamp=e.endTimestamp),e.instrumenter&&(this.instrumenter=e.instrumenter)}startChild(e){const t=new Ql({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t),t.transaction=this.transaction,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&t.transaction){const n=`[Tracing] Starting '${e&&e.op||"< unknown op >"}' span on transaction '${t.transaction.name||"< unknown name >"}' (${t.transaction.spanId}).`;t.transaction.metadata.spanMetadata[t.spanId]={logMessage:n},ma.log(n)}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);const t=function(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(e);return"unknown_error"!==t&&this.setStatus(t),this}isSuccess(){return"ok"===this.status}finish(e){if(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:e}=this.transaction.metadata.spanMetadata[this.spanId];e&&ma.log(e.replace("Starting","Finishing"))}this.endTimestamp="number"==typeof e?e:(0,ga.ph)()}toTraceparent(){return Xl(this.traceId,this.spanId,this.sampled)}toContext(){return ia({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return ia({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return ia({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}class Jl extends Ql{constructor(e,t){super(e),this._measurements={},this._contexts={},this._hub=t||Ia(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const n=this.metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}setName(e,t="custom"){this._name=e,this.metadata.source=t}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new Zl(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this.metadata={...this.metadata,...e}}finish(e){if(void 0!==this.endTimestamp)return;this.name||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this.sampled)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(t&&t.recordDroppedEvent("sample_rate","transaction"));const n=this.spanRecorder?this.spanRecorder.spans.filter((e=>e!==this&&e.endTimestamp)):[];this._trimEnd&&n.length>0&&(this.endTimestamp=n.reduce(((e,t)=>e.endTimestamp&&t.endTimestamp?e.endTimestamp>t.endTimestamp?e:t:e)).endTimestamp);const i=this.metadata,r={contexts:{...this._contexts,trace:this.getTraceContext()},spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...i,dynamicSamplingContext:this.getDynamicSamplingContext()},...i.source&&{transaction_info:{source:i.source}}};return Object.keys(this._measurements).length>0&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),r.measurements=this._measurements),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(r)}toContext(){return ia({...super.toContext(),name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||Ia(),t=e.getClient();if(!t)return{};const n=e.getScope(),i=Ao(this.traceId,t,n),r=this.metadata.sampleRate;void 0!==r&&(i.sample_rate=`${r}`);const s=this.metadata.source;return s&&"url"!==s&&(i.transaction=this.name),void 0!==this.sampled&&(i.sampled=String(this.sampled)),i}setHub(e){this._hub=e}}const ec={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},tc=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class nc extends Zl{constructor(e,t,n,i){super(i),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){e.spanId!==this.transactionSpanId&&(e.finish=t=>{e.endTimestamp="number"==typeof t?t:(0,ga.ph)(),this._popActivity(e.spanId)},void 0===e.endTimestamp&&this._pushActivity(e.spanId)),super.add(e)}}class ic extends Jl{constructor(e,t,n=ec.idleTimeout,i=ec.finalTimeout,r=ec.heartbeatInterval,s=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=i,this._heartbeatInterval=r,this._onScope=s,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=tc[4],s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),t.configureScope((e=>e.setSpan(this)))),this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=tc[3],this.finish())}),this._finalTimeout)}finish(e=(0,ga.ph)()){if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setTag("finishReason",this._finishReason),this.spanRecorder){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] finishing IdleTransaction",new Date(1e3*e).toISOString(),this.op);for(const t of this._beforeFinishCallbacks)t(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter((t=>{if(t.spanId===this.spanId)return!0;t.endTimestamp||(t.endTimestamp=e,t.setStatus("cancelled"),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));const n=t.startTimestamp<e,i=(this._finalTimeout+this._idleTimeout)/1e3,r=t.endTimestamp-this.startTimestamp<i;if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const e=JSON.stringify(t,void 0,2);n?r||ma.log("[Tracing] discarding Span since it finished after Transaction final timeout",e):ma.log("[Tracing] discarding Span since it happened after Transaction was finished",e)}return n&&r})),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] flushing IdleTransaction")}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] No active IdleTransaction");if(this._onScope){const e=this._idleHub.getScope();e.getTransaction()===this&&e.setSpan(void 0)}return super.finish(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new nc(t,n,this.spanId,e),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=tc[5],this.finish(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=tc[1],this.finish(e))}),this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] popActivity ${e}`),delete this.activities[e],("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const e=(0,ga.ph)();this._idleTimeoutCanceledPermanently?(this._finishReason=tc[5],this.finish(e)):this._restartIdleTimeout(e+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=tc[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function rc(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=Ia().getClient(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function sc(e){return(e||Ia()).getScope().getTransaction()}let ac=!1;function oc(){const e=sc();if(e){const t="internal_error";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}function lc(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function cc(e,t,n){if(!rc(t))return e.sampled=!1,e;if(void 0!==e.sampled)return e.setMetadata({sampleRate:Number(e.sampled)}),e;let i;return"function"==typeof t.tracesSampler?(i=t.tracesSampler(n),e.setMetadata({sampleRate:Number(i)})):void 0!==n.parentSampled?i=n.parentSampled:void 0!==t.tracesSampleRate?(i=t.tracesSampleRate,e.setMetadata({sampleRate:Number(i)})):(i=1,e.setMetadata({sampleRate:i})),(Gs(r=i)||"number"!=typeof r&&"boolean"!=typeof r?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(r)} of type ${JSON.stringify(typeof r)}.`),0):!(r<0||r>1)||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${r}.`),0))?i?(e.sampled=Math.random()<i,e.sampled?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] starting ${e.op} transaction - ${e.name}`),e):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(i)})`),e)):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),e.sampled=!1,e):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e);var r}function dc(e,t){const n=this.getClient(),i=n&&n.getOptions()||{},r=i.instrumenter||"sentry",s=e.instrumenter||"sentry";r!==s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${r}\` instrumenter.\nThe transaction will not be sampled. Please use the ${r} instrumentation to start transactions.`),e.sampled=!1);let a=new Jl(e,this);return a=cc(a,i,{parentSampled:e.parentSampled,transactionContext:e,...t}),a.sampled&&a.initSpanRecorder(i._experiments&&i._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",a),a}function uc(e,t,n,i,r,s,a){const o=e.getClient(),l=o&&o.getOptions()||{};let c=new ic(t,e,n,i,a,r);return c=cc(c,l,{parentSampled:t.parentSampled,transactionContext:t,...s}),c.sampled&&c.initSpanRecorder(l._experiments&&l._experiments.maxSpans),o&&o.emit&&o.emit("startTransaction",c),c}oc.tag="sentry_tracingErrorCallback";const hc=zs.n2,pc=(e,t,n)=>{let i,r;return s=>{t.value>=0&&(s||n)&&(r=t.value-(i||0),(r||void 0===i)&&(i=t.value,t.delta=r,e(t)))}},fc=()=>hc.__WEB_VITALS_POLYFILL__?hc.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const e=hc.performance.timing,t=hc.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(const t in e)"navigationStart"!==t&&"toJSON"!==t&&(n[t]=Math.max(e[t]-e.navigationStart,0));return n})()):hc.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],mc=()=>{const e=fc();return e&&e.activationStart||0},gc=(e,t)=>{const n=fc();let i="navigate";return n&&(i=hc.document.prerendering||mc()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:i}},yc=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const i=new PerformanceObserver((e=>{t(e.getEntries())}));return i.observe(Object.assign({type:e,buffered:!0},n||{})),i}}catch(e){}},vc=(e,t)=>{const n=i=>{"pagehide"!==i.type&&"hidden"!==hc.document.visibilityState||(e(i),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)};let bc=-1;const _c=()=>(bc<0&&(bc="hidden"!==hc.document.visibilityState||hc.document.prerendering?1/0:0,vc((({timeStamp:e})=>{bc=e}),!0)),{get firstHiddenTime(){return bc}}),Tc={};function Ec(e){return"number"==typeof e&&isFinite(e)}function wc(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}function Sc(e){return e/1e3}function xc(){return hc&&hc.addEventListener&&hc.performance}let kc,Cc,Lc=0,Ac={};function Rc(){const e=xc();if(e&&ga.Z1){e.mark&&hc.performance.mark("sentry-tracing-init"),(e=>{const t=_c(),n=gc("FID");let i;const r=e=>{e.startTime<t.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),i(!0))},s=e=>{e.forEach(r)},a=yc("first-input",s);i=pc((e=>{const t=e.entries.pop();if(!t)return;const n=Sc(ga.Z1),i=Sc(t.startTime);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding FID"),Ac.fid={value:e.value,unit:"millisecond"},Ac["mark.fid"]={value:n+i,unit:"second"}}),n),a&&vc((()=>{s(a.takeRecords()),a.disconnect()}),!0)})();const t=(e=>{const t=gc("CLS",0);let n,i=0,r=[];const s=e=>{e.forEach((e=>{if(!e.hadRecentInput){const s=r[0],a=r[r.length-1];i&&0!==r.length&&e.startTime-a.startTime<1e3&&e.startTime-s.startTime<5e3?(i+=e.value,r.push(e)):(i=e.value,r=[e]),i>t.value&&(t.value=i,t.entries=r,n&&n())}}))},a=yc("layout-shift",s);if(a){n=pc((e=>{const t=e.entries.pop();t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding CLS"),Ac.cls={value:e.value,unit:""},Cc=t)}),t);const e=()=>{s(a.takeRecords()),n(!0)};return vc(e),e}})(),n=(e=>{const t=_c(),n=gc("LCP");let i;const r=e=>{const r=e[e.length-1];if(r){const e=Math.max(r.startTime-mc(),0);e<t.firstHiddenTime&&(n.value=e,n.entries=[r],i())}},s=yc("largest-contentful-paint",r);if(s){i=pc((e=>{const t=e.entries.pop();t&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding LCP"),Ac.lcp={value:e.value,unit:"millisecond"},kc=t)}),n);const e=()=>{Tc[n.id]||(r(s.takeRecords()),s.disconnect(),Tc[n.id]=!0,i(!0))};return["keydown","click"].forEach((t=>{addEventListener(t,e,{once:!0,capture:!0})})),vc(e,!0),e}})();return()=>{t&&t(),n&&n()}}return()=>{}}function Ic(e,t,n,i,r,s){const a=s?t[s]:t[`${n}End`],o=t[`${n}Start`];o&&a&&wc(e,{op:"browser",description:r||n,startTimestamp:i+Sc(o),endTimestamp:i+Sc(a)})}const Dc=["localhost",/^\/(?!\/)/],Pc={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:Dc,tracePropagationTargets:Dc};function Mc(e){const t=e.data.url,n=new PerformanceObserver((i=>{i.getEntries().forEach((i=>{"fetch"!==i.initiatorType&&"xmlhttprequest"!==i.initiatorType||!i.name.endsWith(t)||(function(e){const{name:t,version:n}=function(e){let t="unknown",n="unknown",i="";for(const r of e){if("/"===r){[t,n]=e.split("/");break}if(!isNaN(Number(r))){t="h"===i?"http":i,n=e.split(i)[1];break}i+=r}return i===e&&(t=i),{name:t,version:n}}(e.nextHopProtocol),i=[];return i.push(["network.protocol.version",n],["network.protocol.name",t]),ga.Z1?[...i,["http.request.redirect_start",Oc(e.redirectStart)],["http.request.fetch_start",Oc(e.fetchStart)],["http.request.domain_lookup_start",Oc(e.domainLookupStart)],["http.request.domain_lookup_end",Oc(e.domainLookupEnd)],["http.request.connect_start",Oc(e.connectStart)],["http.request.secure_connection_start",Oc(e.secureConnectionStart)],["http.request.connection_end",Oc(e.connectEnd)],["http.request.request_start",Oc(e.requestStart)],["http.request.response_start",Oc(e.responseStart)],["http.request.response_end",Oc(e.responseEnd)]]:i}(i).forEach((t=>e.setData(...t))),n.disconnect())}))}));n.observe({entryTypes:["resource"]})}function Oc(e){return((ga.Z1||performance.timeOrigin)+e)/1e3}function Nc(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(jl,n)}catch(e){}}const Fc={...ec,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){if(!hc||!hc.location)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Could not initialize routing instrumentation due to invalid location"));let i,r=hc.location.href;t&&(i=e({name:hc.location.pathname,startTimestamp:ga.Z1?ga.Z1/1e3:void 0,op:"pageload",metadata:{source:"url"}})),n&&to("history",(({to:t,from:n})=>{void 0===n&&r&&-1!==r.indexOf(t)?r=void 0:n!==t&&(r=void 0,i&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.finish()),i=e({name:hc.location.pathname,op:"navigation",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...Pc};class Bc{constructor(e){this.name="BrowserTracing",this._hasSetTracePropagationTargets=!1,function(){const e=Aa();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=dc),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=lc),ac||(ac=!0,to("error",oc),to("unhandledrejection",oc)))}(),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&(this._hasSetTracePropagationTargets=!(!e||!e.tracePropagationTargets&&!e.tracingOrigins)),this.options={...Fc,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=Rc(),this.options.enableLongTask&&yc("longtask",(e=>{for(const t of e){const e=sc();if(!e)return;const n=Sc(ga.Z1+t.startTime),i=Sc(t.duration);e.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:n,endTimestamp:n+i})}})),this.options._experiments.enableInteractions&&yc("event",(e=>{for(const t of e){const e=sc();if(!e)return;if("click"===t.name){const n=Sc(ga.Z1+t.startTime),i=Sc(t.duration);e.startChild({description:js(t.target),op:`ui.interaction.${t.name}`,startTimestamp:n,endTimestamp:n+i})}}}),{durationThreshold:0})}setupOnce(e,t){this._getCurrentHub=t;const n=t().getClient(),i=n&&n.getOptions(),{routingInstrumentation:r,startTransactionOnLocationChange:s,startTransactionOnPageLoad:a,markBackgroundTransactions:o,traceFetch:l,traceXHR:c,shouldCreateSpanForRequest:d,enableHTTPTimings:u,_experiments:h}=this.options,p=i&&i.tracePropagationTargets,f=p||this.options.tracePropagationTargets;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this._hasSetTracePropagationTargets&&p&&ma.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),r((e=>{const n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n}),a,s),o&&(hc&&hc.document?hc.document.addEventListener("visibilitychange",(()=>{const e=sc();if(hc.document.hidden&&e){const t="cancelled";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${e.op}`),e.status||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.finish()}})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("[Tracing] Could not set up background tab detection due to lack of global document")),h.enableInteractions&&this._registerInteractionListener(),function(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:i,tracingOrigins:r,shouldCreateSpanForRequest:s,enableHTTPTimings:a}={traceFetch:Pc.traceFetch,traceXHR:Pc.traceXHR,...e},o="function"==typeof s?s:e=>!0,l=e=>function(e,t){return Ws(e,t||Dc)}(e,i||r),c={};t&&to("fetch",(e=>{const t=function(e,t,n,i){if(!rc()||!e.fetchData)return;const r=t(e.fetchData.url);if(e.endTimestamp&&r){const t=e.fetchData.__span;if(!t)return;const n=i[t];if(n){if(e.response){n.setHttpStatus(e.response.status);const t=e.response&&e.response.headers&&e.response.headers.get("content-length"),i=parseInt(t);i>0&&n.setData("http.response_content_length",i)}else e.error&&n.setStatus("internal_error");n.finish(),delete i[t]}return}const s=Ia(),a=s.getScope(),o=s.getClient(),l=a.getSpan(),{method:c,url:d}=e.fetchData,u=r&&l?l.startChild({data:{url:d,type:"fetch","http.method":c},description:`${c} ${d}`,op:"http.client"}):void 0;if(u&&(e.fetchData.__span=u.spanId,i[u.spanId]=u),n(e.fetchData.url)&&o){const t=e.args[0];e.args[1]=e.args[1]||{};const n=e.args[1];n.headers=function(e,t,n,i,r){const s=r||n.getSpan(),a=s&&s.transaction,{traceId:o,sampled:l,dsc:c}=n.getPropagationContext(),d=s?s.toTraceparent():Xl(o,void 0,l),u=Vl(a?a.getDynamicSamplingContext():c||Ao(o,t,n)),h="undefined"!=typeof Request&&Hs(e,Request)?e.headers:i.headers;if(h){if("undefined"!=typeof Headers&&Hs(h,Headers)){const e=new Headers(h);return e.append("sentry-trace",d),u&&e.append(jl,u),e}if(Array.isArray(h)){const e=[...h,["sentry-trace",d]];return u&&e.push([jl,u]),e}{const e="baggage"in h?h.baggage:void 0,t=[];return Array.isArray(e)?t.push(...e):e&&t.push(e),u&&t.push(u),{...h,"sentry-trace":d,baggage:t.length>0?t.join(","):void 0}}}return{"sentry-trace":d,baggage:u}}(t,o,a,n,u)}return u}(e,o,l,c);a&&t&&Mc(t)})),n&&to("xhr",(e=>{const t=function(e,t,n,i){const r=e.xhr,s=r&&r.__sentry_xhr_v2__;if(!rc()||r&&r.__sentry_own_request__||!r||!s)return;const a=t(s.url);if(e.endTimestamp&&a){const e=r.__sentry_xhr_span_id__;if(!e)return;const t=i[e];return void(t&&(t.setHttpStatus(s.status_code),t.finish(),delete i[e]))}const o=Ia(),l=o.getScope(),c=l.getSpan(),d=a&&c?c.startChild({data:{...s.data,type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client"}):void 0;if(d&&(r.__sentry_xhr_span_id__=d.spanId,i[r.__sentry_xhr_span_id__]=d),r.setRequestHeader&&n(s.url))if(d){const e=d&&d.transaction,t=Vl(e&&e.getDynamicSamplingContext());Nc(r,d.toTraceparent(),t)}else{const e=o.getClient(),{traceId:t,sampled:n,dsc:i}=l.getPropagationContext();Nc(r,Xl(t,void 0,n),Vl(i||(e?Ao(t,e,l):void 0)))}return d}(e,o,l,c);a&&t&&Mc(t)}))}({traceFetch:l,traceXHR:c,tracePropagationTargets:f,shouldCreateSpanForRequest:d,enableHTTPTimings:u})}_createRouteTransaction(e){if(!this._getCurrentHub)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`));const t=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:i,finalTimeout:r,heartbeatInterval:s}=this.options,a="pageload"===e.op,o=a?Uc("sentry-trace"):"",l=a?Uc("baggage"):"",{traceparentData:c,dynamicSamplingContext:d,propagationContext:u}=function(e,t){const n=function(e){if(!e)return;const t=e.match(Wl);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}(e),i=function(e){if(!Ns(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce(((e,t)=>({...e,...Kl(t)})),{});else{if(!e)return;t=Kl(e)}const n=Object.entries(t).reduce(((e,[t,n])=>(t.match(Yl)&&(e[t.slice("sentry-".length)]=n),e)),{});return Object.keys(n).length>0?n:void 0}(t),{traceId:r,parentSpanId:s,parentSampled:a}=n||{},o={traceId:r||sa(),spanId:sa().substring(16),sampled:void 0!==a&&a};return s&&(o.parentSpanId=s),i&&(o.dsc=i),{traceparentData:n,dynamicSamplingContext:i,propagationContext:o}}(o,l),h={...e,...c,metadata:{...e.metadata,dynamicSamplingContext:c&&!d?{}:d},trimEnd:!0},p="function"==typeof n?n(h):h,f=void 0===p?{...h,sampled:!1}:p;f.metadata=f.name!==h.name?{...f.metadata,source:"custom"}:f.metadata,this._latestRouteName=f.name,this._latestRouteSource=f.metadata&&f.metadata.source,!1===f.sampled&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Will not send ${f.op} transaction because of beforeNavigate.`),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Tracing] Starting ${f.op} transaction on scope`);const{location:m}=hc,g=uc(t,f,i,r,!0,{location:m},s),y=t.getScope();return a&&c?y.setPropagationContext(u):y.setPropagationContext({traceId:g.traceId,spanId:g.spanId,parentSpanId:g.parentSpanId,sampled:!!g.sampled}),g.registerBeforeFinishCallback((e=>{this._collectWebVitals(),function(e){const t=xc();if(!t||!hc.performance.getEntries||!ga.Z1)return;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Tracing] Adding & adjusting spans using Performance API");const n=Sc(ga.Z1),i=t.getEntries();let r,s;if(i.slice(Lc).forEach((t=>{const i=Sc(t.startTime),a=Sc(t.duration);if(!("navigation"===e.op&&n+i<e.startTimestamp))switch(t.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((i=>{Ic(e,t,i,n)})),Ic(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),Ic(e,t,"fetch",n,"cache","domainLookupStart"),Ic(e,t,"domainLookup",n,"DNS"),function(e,t,n){wc(e,{op:"browser",description:"request",startTimestamp:n+Sc(t.requestStart),endTimestamp:n+Sc(t.responseEnd)}),wc(e,{op:"browser",description:"response",startTimestamp:n+Sc(t.responseStart),endTimestamp:n+Sc(t.responseEnd)})}(e,t,n)}(e,t,n),r=n+Sc(t.responseStart),s=n+Sc(t.requestStart);break;case"mark":case"paint":case"measure":{!function(e,t,n,i,r){const s=r+n,a=s+i;wc(e,{description:t.name,endTimestamp:a,op:t.entryType,startTimestamp:s})}(e,t,i,a,n);const r=_c(),s=t.startTime<r.firstHiddenTime;"first-paint"===t.name&&s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding FP"),Ac.fp={value:t.startTime,unit:"millisecond"}),"first-contentful-paint"===t.name&&s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding FCP"),Ac.fcp={value:t.startTime,unit:"millisecond"});break}case"resource":{const r=t.name.replace(hc.location.origin,"");!function(e,t,n,i,r,s){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const a={};"transferSize"in t&&(a["http.response_transfer_size"]=t.transferSize),"encodedBodySize"in t&&(a["http.response_content_length"]=t.encodedBodySize),"decodedBodySize"in t&&(a["http.decoded_response_content_length"]=t.decodedBodySize),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus);const o=s+i;wc(e,{description:n,endTimestamp:o+r,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",startTimestamp:o,data:a})}(e,t,r,i,a,n);break}}})),Lc=Math.max(i.length-1,0),function(e){const t=hc.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),Ec(n.rtt)&&(Ac["connection.rtt"]={value:n.rtt,unit:"millisecond"})),Ec(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),Ec(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===e.op){"number"==typeof r&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding TTFB"),Ac.ttfb={value:1e3*(r-e.startTimestamp),unit:"millisecond"},"number"==typeof s&&s<=r&&(Ac["ttfb.requestTime"]={value:1e3*(r-s),unit:"millisecond"})),["fcp","fp","lcp"].forEach((t=>{if(!Ac[t]||n>=e.startTimestamp)return;const i=Ac[t].value,r=n+Sc(i),s=Math.abs(1e3*(r-e.startTimestamp)),a=s-i;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log(`[Measurements] Normalized ${t} from ${i} to ${s} (${a})`),Ac[t].value=s}));const t=Ac["mark.fid"];t&&Ac.fid&&(wc(e,{description:"first input delay",endTimestamp:t.value+Sc(Ac.fid.value),op:"ui.action",startTimestamp:t.value}),delete Ac["mark.fid"]),"fcp"in Ac||delete Ac.cls,Object.keys(Ac).forEach((t=>{e.setMeasurement(t,Ac[t].value,Ac[t].unit)})),function(e){kc&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding LCP Data"),kc.element&&e.setTag("lcp.element",js(kc.element)),kc.id&&e.setTag("lcp.id",kc.id),kc.url&&e.setTag("lcp.url",kc.url.trim().slice(0,200)),e.setTag("lcp.size",kc.size)),Cc&&Cc.sources&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.log("[Measurements] Adding CLS Data"),Cc.sources.forEach(((t,n)=>e.setTag(`cls.source.${n+1}`,js(t.node)))))}(e)}kc=void 0,Cc=void 0,Ac={}}(e)})),g}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:t,finalTimeout:n,heartbeatInterval:i}=this.options,r="ui.action.click",s=sc();if(s&&s.op&&["navigation","pageload"].includes(s.op))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`[Tracing] Did not create ${r} transaction because a pageload or navigation transaction is in progress.`));if(e&&(e.setFinishReason("interactionInterrupted"),e.finish(),e=void 0),!this._getCurrentHub)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`[Tracing] Did not create ${r} transaction because _getCurrentHub is invalid.`));if(!this._latestRouteName)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn(`[Tracing] Did not create ${r} transaction because _latestRouteName is missing.`));const a=this._getCurrentHub(),{location:o}=hc,l={name:this._latestRouteName,op:r,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=uc(a,l,t,n,!0,{location:o},i)};["click"].forEach((e=>{addEventListener(e,t,{once:!1,capture:!0})}))}}function Uc(e){const t=(n=`meta[name=${e}]`,qs.document&&qs.document.querySelector?qs.document.querySelector(n):null);var n;return t?t.getAttribute("content"):void 0}function $c(e,t){if(e){if("string"==typeof e)return Gc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gc(e,t):void 0}}function Gc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Hc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hc(Object(n),!0).forEach((function(t){qc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jc(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.indexOf("?");if(n>=0){return t&&(n+=1),e.slice(n)}return""}(e,!0),i={targetContent:"",newContent:""};if(n){var r=Yc(n),s=Yc(t),a=zc(zc({},r),s);i.targetContent=n,i.newContent=function(e){var t=new URLSearchParams;for(var n in e)e.hasOwnProperty(n)&&t.append(n,e[n]);return t.toString()}(a)}else i.targetContent=e,i.newContent="".concat(e,"?").concat(t);return i}function Yc(e){var t,n,i,r={},s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=$c(e))){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}(new URLSearchParams(e).entries());try{for(s.s();!(t=s.n()).done;){var a=(n=t.value,i=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return s}}(n,i)||$c(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],l=a[1];r[o]=l}}catch(e){s.e(e)}finally{s.f()}return r}function Vc(e){return Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vc(e)}function Kc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(s.push(i.value),!t||s.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return s}}(e,t)||id(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wc(e){return function(e){if(Array.isArray(e))return rd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||id(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xc(Object(n),!0).forEach((function(t){Qc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jc(){Jc=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=t&&t.prototype instanceof u?t:u,s=Object.create(r.prototype),a=new w(i||[]);return s._invoke=function(e,t,n){var i="suspendedStart";return function(r,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw s;return{value:void 0,done:!0}}for(n.method=r,n.arg=s;;){var a=n.delegate;if(a){var o=_(a,n);if(o){if(o===d)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=c(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),s}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function u(){}function h(){}function p(){}var f={};o(f,r,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(S([])));g&&g!==t&&n.call(g,r)&&(f=g);var y=p.prototype=u.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function i(r,s,a,o){var l=c(e[r],e,s);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==Vc(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,o)}),(function(e){i("throw",e,a,o)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return i("throw",e,a,o)}))}o(l.arg)}var r;this._invoke=function(e,n){function s(){return new t((function(t,r){i(e,n,t,r)}))}return r=r?r.then(s,s):s()}}function _(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=c(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function S(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:x}}function x(){return{value:void 0,done:!0}}return h.prototype=p,o(y,"constructor",p),o(p,"constructor",h),h.displayName=o(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,o(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),o(b.prototype,s,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,i,r,s){void 0===s&&(s=Promise);var a=new b(l(t,n,i,r),s);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),o(y,a,"Generator"),o(y,r,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=S,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=n.call(s,"catchLoc"),l=n.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function ed(e,t,n,i,r,s,a){try{var o=e[s](a),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(i,r)}function td(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var s=e.apply(t,n);function a(e){ed(s,i,r,a,o,"next",e)}function o(e){ed(s,i,r,a,o,"throw",e)}a(void 0)}))}}function nd(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=id(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function id(e,t){if(e){if("string"==typeof e)return rd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rd(e,t):void 0}}function rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}window.pandaLoad=window.pandaLoad||{};try{!function(e={}){void 0===e.defaultIntegrations&&(e.defaultIntegrations=zl),void 0===e.release&&("string"==typeof __SENTRY_RELEASE__&&(e.release=__SENTRY_RELEASE__),Yo.SENTRY_RELEASE&&Yo.SENTRY_RELEASE.id&&(e.release=Yo.SENTRY_RELEASE.id)),void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0);const t={...e,stackParser:(n=e.stackParser||Nl,Array.isArray(n)?ja(...n):n),integrations:Oa(e),transport:e.transport||(Wa()?Gl:Hl)};var n;!function(e,t){!0===t.debug&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?ma.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const n=Ia();n.getScope().update(t.initialScope);const i=new e(t);n.bindClient(i)}(sl,t),e.autoSessionTracking&&function(){if(void 0===Yo.document)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&ma.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));const e=Ia();e.captureSession&&(ql(e),to("history",(({from:e,to:t})=>{void 0!==e&&e!==t&&ql(Ia())})))}()}({dsn:"https://2352194d4d5041f997f5c3204c13c862@o1279024.ingest.sentry.io/6479348",release:"player@1420",integrations:[new Bc],tracesSampleRate:0,beforeSend:function(e,t){if(t.originalException){var n=t.originalException.message;return n&&["this.enter is not a function","Not 2xx response","Failed to fetch","The play() request was interrupted by a call to pause(). https://goo.gl/LdLk22","The play() request was interrupted by a new load request. https://goo.gl/LdLk22","play() failed because the user didn't interact with the document first","The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.","play() can only be initiated by a user gesture.","Load failed","play() can only be initiated by a user gesture.","play() failed because the user didn't interact with the document first. https://goo.gl/xX8pDD","AbortError: The operation was aborted.","NetworkError when attempting to fetch resource.","fetch(...).then(...).then(...).catch(...).finally is not a function","Failed to execute 'exitFullscreen' on 'Document': Document not active","Permissions check failed","fullscreen error","The play method is not allowed by the user agent or the platform","The play() request was interrupted because video-only","The operation was aborted","AbortError:","Failed to execute 'requestPictureInPicture","Cannot read properties of null (reading 'trigger')","Fullscreen request denied","Not in fullscreen mode","not granted","The play() request was interrupted",'Blocked a frame with origin "null" from accessing a cross-origin frame'].find((function(e){return-1!==n.indexOf(e)}))?null:e}}})}catch(e){}var sd,ad;function od(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}function ld(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=Number(e.charCodeAt(n)).toString(16);t.push(r)}return t.join("")}void 0!==document.hidden?(sd="hidden",ad="visibilitychange"):void 0!==document.msHidden?(sd="msHidden",ad="msvisibilitychange"):void 0!==document.webkitHidden&&(sd="webkitHidden",ad="webkitvisibilitychange");var cd=new URL(location.href),dd="https://api-v2.pandavideo.com.br",ud="https://subtitles.tv.pandavideo.com.br",hd="https://config.tv.pandavideo.com.br",pd="https://thumbs.tv.pandavideo.com.br",fd={status:"offline",id:null},md=null,gd=Ls&&Ls.isSupported(),yd=[".cdn1.pandavideo.com",".b-cdn.net"],vd=["fragLoadError","fragLoadTimeOut","fragParsingError"],bd=!1,_d=!1,Td=0,Ed=0,wd=!1,Sd=cd.searchParams.get("v"),xd=!1,kd=cd.searchParams.get("l"),Cd=cd.searchParams.get("c"),Ld=cd.searchParams.get("j"),Ad=!1,Rd="true"===cd.searchParams.get("isLive");Sd&&-1!==Sd.indexOf(ld("live"))&&(Rd=!0),Sd&&-1!==Sd.indexOf(ld("comp"))&&(Ad=Sd,Sd=null);var Id=!1,Dd=!1,Pd=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Md="true"===cd.searchParams.get("isDashboard"),Od=cd.searchParams.get("title"),Nd=cd.searchParams.get("refreshConfig"),Fd=!document[sd],Bd="false"!==cd.searchParams.get("preload"),Ud=!0;"false"===cd.searchParams.get("preloadUserAgentChecker")&&(Ud=!1),Ud&&["Kwai_Pro"].some((function(e){return-1!==navigator.userAgent.indexOf(e)}))&&(Bd=!1),Fd||(Bd=!1),/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);var $d,Gd=/(iPhone|iPod|iPad)/i.test(navigator.platform),Hd=navigator.brave||!1,zd=!1,qd=cd.searchParams.get("watermark"),jd=cd.searchParams.get("drm_group_id"),Yd=!1,Vd=null,Kd=!1,Wd="NOT_LIVE",Xd=!1,Zd=(cd.searchParams.get("liveBadge"),[]),Qd=document.querySelector(":root"),Jd=!1,eu=!1,tu=!1,nu=!1,iu="https://hit-video.pandavideo.com:6443",ru=od(),su=[],au=function(){var e=location.host,t="pt";try{e.match(/.com$/)&&(t="en")}catch(e){}return t}(),ou=n(500),lu={},cu=nd(ou.keys());try{for(cu.s();!($d=cu.n()).done;){var du=$d.value,uu=du.match(/([A-Za-z0-9-_]+)\./i);if(uu&&uu.length>1){var hu=Kc(uu,2)[1];lu[hu]=ou(du)}}}catch(e){cu.e(e)}finally{cu.f()}var pu,fu={fullscreen:{enabled:!0,fallback:!0,iosNative:!0},hideControls:!0,captions:{active:!1,language:"",update:!0},controls:["play-large","play","progress","current-time","duration","mute","volume","settings","pip","airplay","fullscreen"],keyboard:{focused:!0,global:!1},i18n:lu[au],iconUrl:"./icons/plyr.svg",thumbnail:{enabled:!1,pic_num:0,width:300,height:168,col:6,row:6,offsetX:0,offsetY:0,urls:[]}},mu=(cd.host,(pu=new RegExp("^player-(.+).tv.pandavideo.com")).test(cd.host)?pu.exec(cd.host)[1]:null);mu&&(kd=mu);var gu,yu,vu="";try{gu=localStorage.getItem("playerUser")}catch(e){}if(gu)vu=gu;else{vu="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}));try{localStorage.setItem("playerUser",vu)}catch(e){}}function bu(){return'<div style="position:relative;width:100%;height:100%"><iframe src="./live_chat.html?c='.concat(Cd,"&l=").concat(kd,'" style="border:none;position:absolute;top:0;left:0;" width="100%" height="100%" fetchpriority="high"></iframe></<div>')}function _u(){try{Gh(document.getElementById("copy-paste"),"disabled"),document.getElementById("report-close-dialog-btn").onclick=wu,document.getElementById("radio-section").addEventListener("click",(function(e){e.target&&e.target.matches("input[type='radio']")&&("report-other"===document.querySelector('input[name="issue-reported"]:checked').value?(Gh(document.getElementById("other-input-wrapper"),"disabled"),document.getElementById("other-input").focus()):$h(document.getElementById("other-input-wrapper"),"disabled"))})),document.getElementById("report-second-step-btn").onclick=td(Jc().mark((function e(){var t,n,i,r;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,$h(document.getElementById("report-first-step"),"disabled"),Gh(document.getElementById("report-second-step"),"disabled"),t=document.querySelector('input[name="issue-reported"]:checked').value,n=xu(t),i="player-"+t,e.next=8,Tu();case 8:r=e.sent,n.latencies=r,jo((function(e){var t;e.setTag("section","".concat(i)),e.setLevel("error"),t={category:"user/player info",message:"".concat(JSON.stringify(n)),level:"info"},Ia().addBreadcrumb(t),qo(new Error("USER PLAYER REPORT"))})),Su(),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})))}catch(e){Su()}}function Tu(){return Eu.apply(this,arguments)}function Eu(){return Eu=td(Jc().mark((function e(){var t,n,i,r,s;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=["BR","RJ"],i=Jc().mark((function e(){var n,i,a;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s[r],i=(new Date).valueOf(),a="https://edgezone-"+n.toLowerCase()+".bunnyinfra.net/500b.jpg",e.next=5,fetch(a).then(function(){var e=td(Jc().mark((function e(r){return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(new Date).valueOf(),e.next=3,fetch(a).then(function(){var e=td(Jc().mark((function e(r){var s,a;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(new Date).valueOf(),a=s-i,e.next=4,fetch("https://video-91.bunnycdn.com/.metrics/track-performance?zone="+n+"&latency="+a);case 4:t.push({zone:n.toLowerCase(),latency:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}));case 5:case"end":return e.stop()}}),e)})),r=0,s=n;case 4:if(!(r<s.length)){e.next=9;break}return e.delegateYield(i(),"t0",6);case 6:r++,e.next=4;break;case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),Eu.apply(this,arguments)}function wu(){try{$h(document.getElementById("copy-paste"),"disabled"),Gh(document.getElementById("report-first-step"),"disabled"),$h(document.getElementById("report-second-step"),"disabled"),$h(document.getElementById("report-third-step"),"disabled"),$h(document.getElementById("other-input-wrapper"),"disabled"),document.getElementById("other-input-wrapper").value="",document.getElementById("report-not-loading").checked=!0}catch(e){console.log("e",e)}}function Su(){try{document.getElementById("report-ok-btn").onclick=wu,$h(document.getElementById("report-second-step"),"disabled"),Gh(document.getElementById("report-third-step"),"disabled")}catch(e){}}function xu(e){var t={timestamp:(new Date).toISOString()};if(t.option=e,"report-other"===e)try{var n=document.getElementById("other-input").value;t.reasoning=n}catch(e){}try{t.autoplay=window.player.autoplay}catch(e){}try{t.videoId=Sd}catch(e){}try{t.libraryId=kd}catch(e){}try{t.currentTime=window.player.currentTime}catch(e){}try{t.duration=window.player.duration}catch(e){}try{t.volume=window.player.volume}catch(e){}try{t.config=JSON.stringify(window.player_configs)}catch(e){}try{t.playerUser=localStorage.getItem("playerUser")}catch(e){}return t}function ku(e){e&&window.player_configs.troubleshootDialog&&(e.addEventListener("contextmenu",Cu,!1),e.addEventListener("click",Lu,!1))}function Cu(e){if(!e.target.closest("#report-problem-dialog")&&!e.target.closest("#content-ai-dialog")){e.preventDefault();var t=document.getElementById("context-menu");t&&(Gh(t,"disabled"),window.innerWidth-e.clientX<175?t.style.left=e.clientX-175+"px":t.style.left=e.clientX+"px",window.innerHeight-e.clientY<75?t.style.top=e.clientY-75+"px":t.style.top=e.clientY+"px")}}function Lu(){$h(document.getElementById("context-menu"),"disabled")}if(function(){if(!Sd&&Cd&&kd){var e=bu();document.write(e)}else{var t="https://b-"+kd+".tv.pandavideo.com.br/"+Sd+"/playlist.m3u8";qd&&(_d=!0,t+=".beta?watermark="+qd),Rd&&(t+=".live",Md&&(t+="?live_without_cdn=1")),"true"===Nd&&(t+="".concat(-1===t.indexOf("?")?"?":"&","nocache=").concat((new Date).getTime()));var n='src="'+t+'"';(Ld||Ad)&&(n="");var i="true"===cd.searchParams.get("autoplay"),r='\n        <div class="container" id="video-container">\n            '.concat(Pd?"":'<video controls crossorigin preload="auto" '.concat(i?"autoplay muted":"",' playsinline ><source type="application/x-mpegURL" ').concat(n,"></video>"),'\n            \x3c!-- Loading indicator --\x3e\n            <div id="error-indicator" class="disabled">\n            </div>\n            <div class="loading-icon">\n                <svg x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve">\n                    <path fill="#9e9e9e"\n                        d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">\n                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s"\n                            from="0 50 50" to="360 50 50" repeatCount="indefinite" />\n                    </path>\n                </svg>\n            </div>\n            \n            \x3c!-- Live --\x3e\n            <div class="live-offline-badge disabled">\n\n                <img src="icons/panda-icon.svg" alt="">\n                <p id="live-subtitle">AGUARDANDO LIVE STREAM</p>\n                <p id="live-title"></p>\n            </div>\n            <div class="live-thumb disabled">\n                <img src="#" alt="Live Offline">\n            </div>\n        </div>\n    ');if(document.write(r),document.addEventListener("DOMContentLoaded",(function(){Ld||Ad||(window.pandatag?window.pandatag("videoHtmlLoaded",!0):window.pandaLoad.videoHtmlLoaded=!0)})),Pd){var s=(new DOMParser).parseFromString('<video controls crossorigin preload="auto" '.concat(i?"autoplay muted":"",' playsinline ><source type="application/x-mpegURL" ').concat(n,"></video>"),"text/html").body.firstChild,a=document.getElementById("video-container");a.insertBefore(s,a.getElementsByTagName("div")[0])}!function(){!function(){try{var e=document.getElementById("context-menu");e&&e.remove()}catch(e){}}();try{if(!od()){var e=document.createElement("div");e.id="context-menu",$h(e,"disabled"),e.innerHTML='<ul> <li> <a href="'.concat(lu[au].aboutPandaLink,'" target="_blank" id="about-panda">').concat(lu[au].aboutPanda,'</a> </li><li> <button id="report-problem">').concat(lu[au].reportModalTitle,"</button> </li></ul>"),document.getElementById("video-container").insertAdjacentElement("beforeend",e),document.getElementById("report-problem").onclick=function(){window.postMessage({type:"pause"},"*"),_u(),Lu()}}}catch(e){}}()}}(),!function(){try{return window.self!==window.top}catch(e){return!0}}()){var Au=document.getElementById("video-container");Au&&($h(Au,"in-page-container"),document.getElementById("body").style.backgroundColor="#000")}function Ru(e,t){var n=document.getElementsByClassName("plyr__controls")[0];if(player_configs.controls.includes("fullscreen")&&t){var i=n.childNodes;n.insertBefore(e,i[i.length-1])}else n.appendChild(e)}function Iu(){var e=document.querySelector(".small-muted-icon");e&&$h(e,"disabled")}function Du(){var e=document.querySelector(".panda-muted-indicator-item");if(e){if(nu=!0,player_configs.mutedIndicatorClickRestart){var t=0;try{t=parseInt(localStorage.getItem("panda_video:"+Sd))}catch(e){}isNaN(t)&&(t=0),window.postMessage({type:"currentTime",parameter:t},"*")}window.postMessage({type:"increaseVolume",parameter:1},"*"),window.postMessage({type:"play"},"*"),e.style.display="none";try{Fh({mutedIndicator:!0})}catch(e){}var n=document.getElementById("wrapper-progress");n&&Gh(n,"disabled"),player_configs.playOpensFullscreenNative?window.player.fullscreen.enter():player_configs.playOpensFullscreen&&window.parent.postMessage({message:"panda_open_window_fullscreen",video:Sd},"*")}}function Pu(){var e=window.player_configs.mutedIndicatorTextTop,t=window.player_configs.mutedIndicatorTextBottom;if(0!==document.getElementsByClassName("plyr--full-ui").length){var n=document.getElementsByClassName("plyr--full-ui")[0],i=document.createElement("button"),r='<svg class="impact" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200" xml:space="preserve"><style>.fg-color{fill:var(--muted-indicator-text)}.bg-color{fill:var(--muted-indicator-background)}.line,.volume,.wave{transform:scale(1);transform-box:fill-box;transform-origin:center;}</style><filter id="panda-muted-indicator-impact-wrapper-highlight"><feDropShadow dx="0" dy="0" stdDeviation="1" flood-color="var(--muted-indicator-text)"/></filter><g class="adjustable fg" style="--darkreader-inline-fill:#ffffff"><path class="volume fg-color" d="M169.8 85.5h-23c-1.9 0-3.1 1.2-3.1 3.1v26.5c0 1.9 1.2 3.1 3.1 3.1h23l19.3 18.4V68.7c.3 0-19.3 16.8-19.3 16.8z"/><path class="wave fg-color" d="M205.9 127.8c-1.2-1.2-.9-3.4.3-5 9.6-12.1 9.6-29.3 0-41.1-1.2-1.6-1.2-3.7-.3-5 1.2-1.2 3.7-.9 5 .9 11.5 14.3 11.5 34.9 0 48.9-1.4 2.6-3.8 2.6-5 1.3z"/><path class="wave fg-color" d="M223.9 138.4c-1.2-1.2-.9-3.4.3-5 14.6-17.1 14.6-42.3 0-59.4-1.2-1.6-1.6-3.7-.3-5 1.2-1.2 3.4-.9 5 .9 16.5 19.3 16.5 48.2 0 67.5-1.5 2.2-3.8 2.6-5 1z"/><path class="wave fg-color" d="M241.6 149.3c-1.2-1.2-.9-3.4.3-5 21.2-24 21.2-60.1 0-84-1.2-1.2-1.6-3.1-.3-4.4 1.2-1.2 3.4-.9 5 .6 23.3 26.1 23.3 66 0 92.1-1.2 1.9-3.7 2.2-5 .7z"/><path class="line bg-color" d="M274 141.2c-.3-1.6-1.2-3.1-2.8-4L135.6 50.6c-.9-.6-2.2-.9-3.4-.9-2.2 0-4 .9-5.3 2.8-.9 1.6-1.2 3.1-.9 4.7.3 1.6 1.2 3.1 2.8 4l135.4 86.2c.9.6 2.2.9 3.4.9 2.2 0 4-.9 5.3-2.8 1.1-.9 1.4-2.7 1.1-4.3z"/><path class="line fg-color" d="M267.8 145.9c-.6 0-1.2-.3-1.6-.6L130.9 58.4c-1.6-.9-1.9-2.8-.9-4 .9-1.6 2.8-1.9 4-.9l135.4 86.2c1.6.9 1.9 2.8.9 4.4-.7.8-1.5 1.8-2.5 1.8z"/></g></svg>';r+='<svg class="blink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200" xml:space="preserve"><style>.fg-color{fill:var(--muted-indicator-text)}.bg-color{fill:var(--muted-indicator-background)}.line,.volume,.wave{transform:scale(1);transform-box:fill-box;transform-origin:center;}</style><g class="adjustable fg" style="--darkreader-inline-fill:#ffffff"><path class="volume fg-color" d="M189.1 68.7c.2 0-5.4 4.8-10.6 9.3l10.6 6.8V68.7z"/><path class="volume fg-color" d="M146.8 85.5c-1.9 0-3.1 1.2-3.1 3.1v26.5c0 1.9 1.2 3.1 3.1 3.1h23l19.3 18.4v-37L167 85.5h-20.2z"/><path class="wave blink_impact_1 fg-color" d="M206.2 122.8c-1.2 1.6-1.5 3.8-.3 5 1.2 1.3 3.6 1.3 5-1.3 2.4-2.9 4.3-6.1 5.7-9.4l-5.3-3.4c-1.2 3.2-2.9 6.3-5.1 9.1z"/><path class="wave blink_impact_1 fg-color" d="M210.9 77.6c-1.3-1.8-3.8-2.1-5-.9-.9 1.3-.9 3.4.3 5 4.4 5.4 6.7 11.9 7.1 18.5l6.1 3.9c.5-9.3-2.3-18.8-8.5-26.5z"/><path class="wave blink_impact_2 fg-color" d="M224.2 133.4c-1.2 1.6-1.5 3.8-.3 5 1.2 1.6 3.5 1.2 5-1 2.3-2.7 4.3-5.6 6-8.7l-5.2-3.3c-1.5 2.8-3.4 5.5-5.5 8z"/><path class="wave blink_impact_2 fg-color" d="M228.9 69.9c-1.6-1.8-3.8-2.1-5-.9-1.3 1.3-.9 3.4.3 5 9.6 11.2 12.9 25.9 9.9 39.5l5.5 3.5c4.2-16.1.6-33.9-10.7-47.1z"/><path class="wave blink_impact_3 fg-color" d="M241.9 144.3c-1.2 1.6-1.5 3.8-.3 5 1.3 1.5 3.8 1.2 5-.7 2.4-2.6 4.5-5.4 6.4-8.4l-5.4-3.4c-1.7 2.6-3.6 5.1-5.7 7.5z"/><path class="wave blink_impact_3 fg-color" d="M246.6 56.5c-1.6-1.5-3.8-1.8-5-.6-1.3 1.3-.9 3.2.3 4.4 16.2 18.3 20 43.8 11.4 65.5l5.5 3.5c9.9-24 5.9-52.6-12.2-72.8z"/><path class="line fg-color" d="m269.4 139.7-11.9-7.6-5.4-3.5-13.4-8.5-5.4-3.4-14.1-9-5.8-3.7-24.2-15.4-13.2-8.4-42-26.7c-1.2-1-3.1-.7-4 .9-1 1.2-.7 3.1.9 4l40.3 25.9 17.9 11.5 23.2 14.9 5.4 3.4 13.4 8.6 5.2 3.4 12.9 8.3 5.4 3.5 11.7 7.5c.4.3 1 .6 1.6.6 1 0 1.8-1 2.5-1.8.9-1.7.6-3.6-1-4.5z"/></g></svg>',(e.length>18||t.length>18)&&$h(i,"panda-muted-indicator-impact-wrapper-big-text"),r='<span class="panda-muted-indicator-impact-wrapper-canvas"></span>'+r,e&&(r='<span class="text top">'+e+"</span>"+r),t&&(r=r+'<span class="text bottom">'+t+"</span>"),i.innerHTML=r,$h(i,"panda-muted-indicator-impact-wrapper"),$h(i,"panda-muted-indicator-item"),$h(i,"animate"),$h(i,player_configs.mutedIndicatorSize);var s=player_configs.controls.filter((function(e){return"play-large"!==e}));Gd&&s.length&&player.on("controlsshown",(function(){nu||Du()})),i.onclick=function(){Du()};var a=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');a&&$h(a,"disabled");var o=function(e){return 100*e/(1e3*d)+"%"},l=function(e,t){return"IMPACT_"+e+"{0%{opacity:0;transform:scale(4);}"+o(850*t/1e3)+"{opacity:1;}"+o(t)+",100%{opacity:1;transform:scale(1);}}"},c=window.player_configs.mutedIndicatorLoop,d=window.player_configs.mutedIndicatorLoopDuration,u=document.createElement("style"),h="        @keyframes BLINK_IMPACT{0%,100%{opacity:0;}33%,66%{opacity:1;}}        @keyframes HIGHLIGHT{0%,100%{filter:url(#panda-muted-indicator-impact-wrapper-highlight);}}        @keyframes OPACITY_0{0%,100%{opacity:0;}}        @keyframes OPACITY_1{0%,100%{opacity:1;}}        @keyframes SVG_WRAPPER{0%{width:100%;max-width:100%;}100%{width:var(--size-width);max-width:400px;}}        @keyframes IMPACT{0%{opacity:0;transform:scale(3);}85%{opacity:1;}100%{transform:scale(1);}}        @keyframes IMPACT_CENTER{0%{opacity:0;transform:translate(-50%, -50%) scale(3);}85%{opacity:1;}100%{transform:translate(-50%, -50%) scale(1);}}        button.panda-muted-indicator-impact-wrapper.animate svg.impact {            animation: SVG_WRAPPER 750ms cubic-bezier(.76,.05,.86,.06), OPACITY_0 10s linear infinite 850ms;        }        button.panda-muted-indicator-impact-wrapper.animate .text.bottom {            animation: IMPACT 262ms cubic-bezier(.76,.05,.86,.06);        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.fg-color {            animation: HIGHLIGHT 262ms cubic-bezier(.76,.05,.86,.06), IMPACT 262ms cubic-bezier(.76,.05,.86,.06) 131ms;        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.bg-color {            animation: IMPACT 314ms cubic-bezier(.76,.05,.86,.06) 236ms;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .wave {            animation: IMPACT 314ms cubic-bezier(.76,.05,.86,.06) 340ms;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.impact .volume {            animation: IMPACT 288ms cubic-bezier(.76,.05,.86,.06) 471ms, OPACITY_0 471ms cubic-bezier(.76,.05,.86,.06) 0s;        }        button.panda-muted-indicator-impact-wrapper.animate .panda-muted-indicator-impact-wrapper-canvas {            animation: IMPACT_CENTER 471ms cubic-bezier(.76,.05,.86,.06) 602ms, OPACITY_0 602ms cubic-bezier(.76,.05,.86,.06) 0s;        }        button.panda-muted-indicator-impact-wrapper.animate .text.top {            animation: IMPACT 250ms linear 550ms, OPACITY_0 550ms cubic-bezier(.76,.05,.86,.06) 0s;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .line,        button.panda-muted-indicator-impact-wrapper.animate svg.blink .volume {            animation: OPACITY_0 850ms linear 0s;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_1 {            animation: BLINK_IMPACT 2s infinite 950ms, OPACITY_0 850ms linear 0s;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_2 {            animation: BLINK_IMPACT 2s infinite 1250ms, OPACITY_0 850ms linear 0s;            opacity: 0;        }        button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_3 {            animation: BLINK_IMPACT 2s infinite 1550ms, OPACITY_0 850ms linear 0s;            opacity: 0;        }    ";c&&(h="            @keyframes BLINK_IMPACT{0%,100%{opacity:0;}33%,66%{opacity:1;}}            @keyframes HIGHLIGHT{0%{filter:url(#panda-muted-indicator-impact-wrapper-highlight);}"+o(315)+",100%{filter:initial;}}            @keyframes OPACITY_0{"+o(850)+","+o(9150)+"{opacity:0;}}            @keyframes OPACITY_1{"+o(850)+","+o(9150)+"{opacity:1;}}            @keyframes SVG_WRAPPER{0%{width:100%;}"+o(470)+",100%{width:var(--size-width);}}            @keyframes "+l("P2",262)+"            @keyframes "+l("LINE_FG",262)+"            @keyframes "+l("LINE_BG",314)+"            @keyframes "+l("BLINK",314)+"            @keyframes "+l("VOLUME",288)+"            @keyframes IMPACT_CANVAS{0%{opacity:0;transform:translate(-50%,-50%) scale(4);}"+o(850*471/1e3)+"{opacity:1;}"+o(471)+",100%{opacity:1;transform:translate(-50%,-50%) scale(1);}}            @keyframes "+l("P1",250)+"                        button.panda-muted-indicator-impact-wrapper.animate svg.impact {                animation: SVG_WRAPPER "+d+"s cubic-bezier(.76, .05, .86, .06) infinite, OPACITY_0 "+d+"s linear infinite 850ms;            }            button.panda-muted-indicator-impact-wrapper.animate .text.bottom {                animation: IMPACT_P2 "+d+"s cubic-bezier(.76,.05,.86,.06) infinite;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.fg-color {                animation: HIGHLIGHT "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 131ms, IMPACT_LINE_FG "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 131ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .line.bg-color {                animation: IMPACT_LINE_BG "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 236ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .wave {                animation: IMPACT_BLINK "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 340ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.impact .volume {                animation: IMPACT_VOLUME "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 471ms, OPACITY_0 "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 0s;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate .panda-muted-indicator-impact-wrapper-canvas {                animation: IMPACT_CANVAS "+d+"s cubic-bezier(.76,.05,.86,.06) infinite 602ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate .text.top {                animation: IMPACT_P1 "+d+"s linear infinite 550ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .line,            button.panda-muted-indicator-impact-wrapper.animate svg.blink .volume {                animation: OPACITY_1 "+d+"s linear infinite 425ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_1 {                animation: BLINK_IMPACT 2s linear infinite 950ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_2 {                animation: BLINK_IMPACT 2s linear infinite 1250ms;                opacity: 0;            }            button.panda-muted-indicator-impact-wrapper.animate svg.blink .blink_impact_3 {                animation: BLINK_IMPACT 2s linear infinite 1550ms;                opacity: 0;            }        "),u.innerHTML=h,document.getElementsByTagName("head")[0].appendChild(u),n.appendChild(i),nu=!1}}function Mu(){var e=window.player_configs.mutedIndicatorTextTop,t=window.player_configs.mutedIndicatorTextBottom;if(0!==document.getElementsByClassName("plyr--full-ui").length){var n=document.getElementsByClassName("plyr--full-ui")[0],i=document.createElement("button"),r='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="7.999 9.062 46.75 32.563" enable-background="new 7.999 9.062 46.75 32.563" xml:space="preserve"> <style>@keyframes BLINK{0%{opacity: 0;}33%{opacity: 1;}66%{opacity: 1;}100%{opacity: 0;}}.blink_1{animation: BLINK 2s infinite; opacity: 0;}.blink_2{animation: BLINK 2s infinite .3s; opacity: 0;}.blink_3{animation: BLINK 2s infinite .6s; opacity: 0;}</style><style class="darkreader darkreader--sync" media="screen"></style> <g class="adjustable fg" style="fill: rgb(255, 255, 255); --darkreader-inline-fill:#ffffff;" data-darkreader-inline-fill=""> <path d="M53.249,39.616c-0.186,0-0.371-0.051-0.537-0.157l-43.5-27.75c-0.466-0.297-0.603-0.916-0.306-1.381c0.298-0.466,0.917-0.601,1.381-0.306l43.5,27.75c0.467,0.297,0.604,0.916,0.307,1.381C53.901,39.453,53.579,39.616,53.249,39.616z"></path> <path class="blink_3" d="M48.896,33.467l1.699,1.085c3.497-7.791,2.073-17.271-4.313-23.659c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414C50.581,18.019,51.913,26.463,48.896,33.467z"></path> <path class="blink_3" d="M46.926,36.956c-0.612,0.863-1.286,1.695-2.059,2.469c-0.392,0.391-0.392,1.023,0,1.414c0.194,0.195,0.45,0.293,0.707,0.293c0.256,0,0.512-0.098,0.706-0.293c0.878-0.878,1.642-1.824,2.333-2.807L46.926,36.956z"></path> <path class="blink_2" d="M42.543,29.415l1.777,1.135c1.545-5.315,0.229-11.293-3.953-15.476c-0.392-0.391-1.023-0.391-1.414,0c-0.392,0.391-0.392,1.023,0,1.414C42.454,19.987,43.639,24.925,42.543,29.415z"></path> <path class="blink_2" d="M41,33.174c-0.563,0.94-1.235,1.837-2.047,2.646c-0.391,0.392-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293s0.512-0.098,0.707-0.293c0.916-0.914,1.676-1.924,2.317-2.984L41,33.174z"></path> <path class="blink_1" d="M35.771,25.094l2.003,1.277c0.012-0.203,0.029-0.404,0.029-0.609c0-3.079-1.2-5.974-3.381-8.153c-0.391-0.391-1.022-0.391-1.414,0c-0.391,0.391-0.391,1.023,0,1.414C34.652,20.666,35.613,22.802,35.771,25.094z"></path> <path class="blink_1" d="M35.084,29.401c-0.474,1.145-1.172,2.197-2.076,3.1c-0.391,0.391-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293c0.257,0,0.513-0.098,0.707-0.293c1.008-1.006,1.795-2.17,2.361-3.43L35.084,29.401z"></path> <polygon points="28.124,20.215 28.124,14.991 24.635,17.99 "></polygon> <path d="M20.921,20.366h-6.423c-0.553,0-1,0.508-1,1.135v8.229c0,0.627,0.447,1.135,1,1.135h7.375l6.25,5.875V24.96L20.921,20.366z"></path> </g> </svg>';(e.length>18||t.length>18)&&$h(i,"panda-muted-indicator-big-text"),r=e?"<span>"+e+"</span>"+r:"<span> </span>"+r,t?r=r+"<span>"+t+"</span>":r+="<span> </span>",i.innerHTML=r,$h(i,"panda-muted-indicator"),$h(i,"panda-muted-indicator-item"),$h(i,player_configs.mutedIndicatorSize);var s=player_configs.controls.filter((function(e){return"play-large"!==e}));Gd&&s.length&&player.on("controlsshown",(function(){nu||Du()})),i.onclick=function(){Du()};var a=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');a&&$h(a,"disabled"),n.appendChild(i),nu=!1}}function Ou(){var e=document.getElementById("custom_muted_indicator_iframe");e&&e.remove(),player_configs.customMutedIndicatorData.deleted&&(player_configs.mutedIndicatorAnimation="default",Nu());var t=document.getElementsByClassName("plyr--full-ui")[0],n=document.createElement("iframe");n.id="custom_muted_indicator_iframe",$h(n,"panda-muted-indicator-custom"),$h(n,"panda-muted-indicator-item"),n.onload=function(){ku(n.contentWindow.document.body);var e=document.getElementById("custom_muted_indicator_iframe"),t=/<script>(.|\n)*?<\/script>/gm;if(player_configs.customMutedIndicatorData.script){var i=player_configs.customMutedIndicatorData.script.match(t),r=player_configs.customMutedIndicatorData.script.replace(t,"");if(i&&i.length){var s=i[0].replace("<script>","").replace("<\/script>",""),a=document.createElement("script");a.type="text/javascript",a.innerHTML=s,e.contentWindow.document.body.innerHTML="".concat(r),e.contentWindow.document.body.appendChild(a)}else e.contentWindow.document.body.innerHTML="".concat(r);var o=document.createElement("script");o.type="text/javascript",o.innerHTML="document.getElementsByTagName('body')[0].onclick = function(){\n            window.parent.postMessage({\n                type: 'muted_indicator_play',\n            }, '*')\n        }",e.contentWindow.document.body.appendChild(o),e.contentWindow.document.body.style="padding:0;margin:0;overflow:hidden;"}};var i=player_configs.controls.filter((function(e){return"play-large"!==e}));Gd&&i.length&&player.on("controlsshown",(function(){nu||Du()})),n.onclick=function(){Du()};var r=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');r&&$h(r,"disabled"),t.appendChild(n),nu=!1}function Nu(){if(""!==player_configs.mutedIndicatorBackgroundColor)Qd.style.setProperty("--muted-indicator-background",player_configs.mutedIndicatorBackgroundColor);else{var e=(t=player_configs.primaryColor.replace("#","").replace("%23","").substring(0,6).match(/.{1,2}/g),[parseInt(t[0],16),parseInt(t[1],16),parseInt(t[2],16)]);e.push(player_configs.mutedIndicatorOpacity),Qd.style.setProperty("--muted-indicator-background","rgba(".concat(e.join(","),")"))}var t;""!==player_configs.mutedIndicatorTextColor?Qd.style.setProperty("--muted-indicator-text",player_configs.mutedIndicatorTextColor):Qd.style.setProperty("--muted-indicator-text",player_configs.controlsColor),Qd.style.setProperty("--muted-indicator-border-size",player_configs.mutedIndicatorBorderSize+"px"),{default:Mu,impact:Pu,custom:Ou}[window.player_configs.mutedIndicatorAnimation]()}function Fu(){var e;Ld?(e=!1,fetch(dd+"/sharelock?j="+Ld,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(t){t&&t.status?(Sd=t.video_external_id,e=!0):(Sd="cd676325-3f2d-4ad5-b95c-c2a683d7b0cc",kd="vz-ded14ebd-85a")})).catch((function(e){Sd="cd676325-3f2d-4ad5-b95c-c2a683d7b0cc",kd="vz-ded14ebd-85a"})).finally((function(){document.querySelector("video > source").src="https://b-".concat(kd,".tv.pandavideo.com.br/").concat(Sd,"/playlist.m3u8").concat(e?"?sharelock="+Ld+"version"+Date.now():""),window.pandatag("videoHtmlLoaded",!0),rh()}))):Ad?fetch("".concat(hd,"/").concat(kd,"/comparison/").concat(Ad,".json"),{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){if("COMPLETED"===e.status)Sd=e.winner_video_id;else{var t=e.videos,n=Math.floor(window.crypto.getRandomValues(new Uint32Array(1))[0]/(Math.pow(2,32)-1)*t.length);Sd=t[n]}})).catch((function(e){Sd="cd676325-3f2d-4ad5-b95c-c2a683d7b0cc",kd="vz-ded14ebd-85a"})).finally((function(){document.querySelector("video > source").src="https://b-"+kd+".tv.pandavideo.com.br/"+Sd+"/playlist.m3u8",window.pandatag("videoHtmlLoaded",!0),rh()})):rh();var t=hd+"/"+kd+"/config.json";"true"===Nd&&(t+="?date="+(new Date).getTime()),fetch(t,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){var t=e;Object.keys(player_configs).forEach((function(e){if(Object.keys(t).includes(e)){if("controls"===e){var n=t.controls.findIndex((function(e){return"volume"===e}));-1!==n&&t.controls.splice(n,0,"mute")}"fbPixel"===e&&"string"==typeof t.fbPixel&&(t.fbPixel=t.fbPixel?[t.fbPixel]:[]),player_configs[e]=t[e]}}))})).finally((function(){pandatag("applyColors",(function(){cd.searchParams.get("color")&&("#"===cd.searchParams.get("color").charAt(0)?player_configs.primaryColor=cd.searchParams.get("color"):player_configs.primaryColor="#"+cd.searchParams.get("color")),Qd.style.setProperty("--plyr-color-main",player_configs.primaryColor),Qd.style.setProperty("--plyr-captions-text-color",player_configs.captionsColor),Qd.style.setProperty("--plyr-captions-background",player_configs.captionsBackgroundColor),Qd.style.setProperty("--plyr-video-control-color",player_configs.controlsColor),Qd.style.setProperty("--plyr-video-control-color-hover",player_configs.controlsColor),Qd.style.setProperty("--plyr-menu-color",player_configs.menuColor),Qd.style.setProperty("--live-indicator-color",player_configs.liveColor)})),pandatag("setupControls",(function(){if("online"===Wd){var e=["current-time","duration","captions","rewind","fast-forward"];Xd||e.push("progress"),tu||e.push("settings");var t=player_configs.controls.filter((function(t){return!e.includes(t)}));player_configs.controls=t}if(player_configs.alternativeProgress){var n=["progress"];player_configs.controls=player_configs.controls.filter((function(e){return!n.includes(e)}))}fu.controls=player_configs.controls})),pandatag("configLibraryLoaded",!0)}))}function Bu(){var e="https://config-live.tv.pandavideo.com.br/"+kd+"/"+Sd+"-live.json?nocache="+Date.now();fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){if(fd.status=e.chat_status,fd.id=e.chat_id,Cd=fd.id,Wd=e.status,Xd=!!e.active_dvr,$h(document.getElementsByClassName("loading-icon")[0],"disabled"),e.thumb){var t=document.getElementsByClassName("live-thumb")[0];t.getElementsByTagName("img")[0].src=pd+"/"+kd+"/"+e.thumb,Gh(t,"disabled")}else{var n=document.getElementsByClassName("live-offline-badge")[0],i=document.getElementById("live-subtitle");i&&(i.innerHTML=lu[au].waitingForLive),document.getElementById("live-title").innerHTML=e.title,Gh(n,"disabled")}"online"===e.status?function t(){var n="https://b-"+kd+".tv.pandavideo.com.br/"+Sd+"/playlist.m3u8.live?nocache="+(new Date).getTime()+(Md?"&live_without_cdn=1":"");fetch(n,{method:"GET"}).then((function(t){if(!t.ok)throw new Error("Not 2xx response");window.player_configs.muted=!0,window.player_configs.autoplay=!0,window.player_configs.saveProgress=!1;var n=document.getElementsByClassName("live-thumb")[0];n&&$h(n,"disabled");var i=document.getElementsByClassName("live-offline-badge")[0];i&&$h(i,"disabled"),e.bitrate&&(tu=!0,Zd=e.bitrate.map((function(e){return parseInt(e.replace("p",""))}))),Fu()})).catch((function(e){try{qo(new Error("live_debug_exception_1"),{tags:{m3u8:n,is_live:!0,video_id:Sd,library_id:kd}})}catch(e){}setTimeout(t,2e3)}))}():"finished"===e.status||"finished_imported"===e.status?($h(document.getElementsByClassName("live-thumb")[0],"disabled"),$h(document.getElementsByClassName("live-offline-badge")[0],"disabled"),Fu()):setTimeout(Bu,5e3)})).catch((function(e){try{qo(new Error("live_debug_exception_2"),{tags:{config:m3u8Url,is_live:!0,video_id:Sd,library_id:kd}})}catch(e){}setTimeout(Bu,5e3)}))}function Uu(e){var t=[];t=e?document.getElementById(e)?[document.getElementById(e)]:document.getElementsByClassName(e):document.getElementsByClassName("cta-element");for(var n=0;n<t.length;n++)t[n]&&t[n].parentNode&&t[n].parentNode.removeChild(t[n])}function $u(){var e=document.getElementsByClassName("plyr--html5")[0];Uu("pause-cta");var t,n=nd(player_configs.ctas.filter((function(e){return"pause"===e.type})));try{var i=function(){var n=t.value,i=document.createElement("div");$h(i,"pause-cta"),$h(i,"cta-overlay"),$h(i,"disabled"),$h(i,"cta-element"),i.style="z-index: 5;",i.id=n.id;var r=document.createElement("iframe");if(r.id="".concat(n.id,"_iframe"),r.onload=function(){ku(r.contentWindow.document.body);var e=document.getElementById("".concat(n.id,"_iframe")),t=/<script>(.|\n)*?<\/script>/gm,i=n.script.match(t),s=n.script.replace(t,"");if(i&&i.length){var a=i[0].replace("<script>","").replace("<\/script>",""),o=document.createElement("script");o.type="text/javascript",o.innerHTML=a,e.contentWindow.document.body.innerHTML="".concat(s),e.contentWindow.document.body.appendChild(o)}else e.contentWindow.document.body.innerHTML="".concat(s);e.contentWindow.document.body.style="padding:0;margin:0"},i.appendChild(r),n.skipButton){var s=document.createElement("button");s.style="z-index: 6;",s.innerHTML=lu[au].keepWatching,$h(s,"cta-skip-button"),s.onclick=function(){window.postMessage({type:"play"},"*")},i.appendChild(s)}var a=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');a&&(a.style.zIndex=10),$h(i,"disabled"),e.appendChild(i)};for(n.s();!(t=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}function Gu(){var e=document.getElementsByClassName("plyr--html5")[0];Uu("end-cta");var t=player_configs.ctas.find((function(e){return"end"===e.type}));if(t){var n=document.createElement("div");n.id="end-cta",$h(n,"cta-overlay"),$h(n,"disabled"),$h(n,"cta-element"),n.style="z-index: 5;";var i=document.createElement("iframe");i.id="".concat(t.id,"_iframe"),i.onload=function(){ku(i.contentWindow.document.body);var e=document.getElementById("".concat(t.id,"_iframe")),n=/<script>(.|\n)*?<\/script>/gm,r=t.script.match(n),s=t.script.replace(n,"");if(r&&r.length){var a=r[0].replace("<script>","").replace("<\/script>",""),o=document.createElement("script");o.type="text/javascript",o.innerText=a,e.contentWindow.document.body.innerHTML="".concat(s),e.contentWindow.document.body.appendChild(o)}else e.contentWindow.document.body.innerHTML="".concat(s);e.contentWindow.document.body.style="padding:0;margin:0"},n.appendChild(i);var r=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');r&&(r.style.zIndex=10),$h(n,"disabled"),e.appendChild(n),window.onEnd=function(){Gh(n,"disabled")}}}function Hu(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),i=Math.floor(e-3600*t-60*n);return t<10&&(t="0"+t),n<10&&(n="0"+n),i<10&&(i="0"+i),"00"==t?n+":"+i:t+":"+n+":"+i}function zu(){var e=document.getElementById("bookmarks-container");e&&e.parentNode.removeChild(e);var t='<svg style="width:24px;height:24px" fill="white" viewBox="0 0 24 24"><path fill="white" d="M7,5H21V7H7V5M7,13V11H21V13H7M4,4.5A1.5,1.5 0 0,1 5.5,6A1.5,1.5 0 0,1 4,7.5A1.5,1.5 0 0,1 2.5,6A1.5,1.5 0 0,1 4,4.5M4,10.5A1.5,1.5 0 0,1 5.5,12A1.5,1.5 0 0,1 4,13.5A1.5,1.5 0 0,1 2.5,12A1.5,1.5 0 0,1 4,10.5M7,19V17H21V19H7M4,16.5A1.5,1.5 0 0,1 5.5,18A1.5,1.5 0 0,1 4,19.5A1.5,1.5 0 0,1 2.5,18A1.5,1.5 0 0,1 4,16.5Z" /></svg>',n=document.createElement("div");n.id="bookmarks-container",$h(n,"panda-bookmarks-div");var i=document.createElement("div");$h(i,"panda-bookmarks-list-wrapper"),$h(i,"disabled"),i.innerHTML='<div class="panda-bookmarks-list-title">'.concat(lu[au].chapters,"</div>");var r=document.createElement("ul");$h(r,"panda-bookmarks-list"),player_configs.bookMarks.sort((function(e,t){return e.time-t.time})).forEach((function(e,t){var n=document.createElement("li"),i=document.createElement("span"),s="index"===window.player_configs.bookmarksLabel?t+1:Hu(e.time);i.innerHTML="<strong>"+s+"</strong> "+e.title,n.appendChild(i),n.onclick=function(){window.postMessage({type:"currentTime",parameter:e.time},"*"),window.postMessage({type:"play"},"*")},r.appendChild(n)}));var s=document.createElement("button");s.setAttribute("class","panda-bookmarks-button"),t=t.replace(/white/gm,"var(--plyr-video-control-color)"),s.innerHTML=t,i.appendChild(r),n.appendChild(s);var a=document.querySelector(".plyr__menu button");a&&(a.onclick=function(e){$h(i,"disabled"),Gh(s,"active-bookmark"),Jd=!1}),s.onclick=function(){(Jd=!Jd)?(Gh(i,"disabled"),$h(s,"active-bookmark")):($h(i,"disabled"),Gh(s,"active-bookmark"))},document.addEventListener("click",(function(e){s.contains(e.target)||($h(i,"disabled"),Gh(s,"active-bookmark"),Jd=!1)})),n.appendChild(i);var o=player_configs.bookMarks.sort((function(e,t){return e.time-t.time})),l=o.map((function(e,t){var n=o[t+1];return{start:e.time,title:e.title,end:n?n.time:2147483647}}));window.pb.ev_config.chapters=l,window.pb.reloadChapters(),Ru(n,1)}function qu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return e.replace(new RegExp("(.{1,".concat(t,"})(\\s+|$)"),"g"),"$1\n")}function ju(e){var t=e.split(":");if(t.length<2)return null;var n=parseInt(t[0],10),i=parseInt(t[1],10),r=parseFloat(t[2]);return 2==t.length&&(n=0,i=parseInt(t[0],10),r=parseFloat(t[1])),3600*n+60*i+r}function Yu(){try{var e=document.getElementById("content-ai-dialog");e&&e.remove()}catch(e){}}function Vu(){Yu();try{var e=function(e){var n=r[e];document.getElementById("question-enunciate").textContent=n.enunciate;var i=document.getElementById("answer-options");i.innerHTML="",n.options.forEach((function(n,r){var a=document.createElement("li");if(a.textContent=n.text,null!==s[e]){var o=s[e];a.classList.add("answered"),r===o.userSelected?a.style.border=o.isCorrect?"2px solid green":"2px solid red":r===o.correctOption?a.style.border="2px solid green":(a.style.opacity="0.6",a.style.pointerEvents="none"),a.style.cursor="default"}else a.addEventListener("click",(function(){return t(r)}));i.appendChild(a)})),document.getElementById("questions-indicator").textContent="".concat(e+1,"/").concat(r.length)},t=function(t){var n=r[i].options.findIndex((function(e){return e.correct})),a=r[i].options[t].correct;!function(e,t,n){var i=r[e].options.findIndex((function(e){return e.correct}));s[e]={userSelected:t,correctOption:i,isCorrect:n}}(i,t,a),e(i),window.parent.postMessage({message:"panda_ai_quiz",video:Sd,question_index:i+1,total_questions:r.length,user_selected_answer:t+1,correct_answer:n+1,is_correct:a},"*")},n=document.createElement("div");n.id="content-ai-dialog",n.innerHTML='<div id="modal-ai">\n            <header>\n                <p class="title-ai-text">'.concat(lu[au].questions,'</p>\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <p id="question-enunciate"></p>\n                <ul id="answer-options"></ul>\n            </div>\n            <div id="questions-footer">\n                <button id="questions-prev-button"><</button>\n                <span id="questions-indicator"></span>\n                <button id="questions-next-button">></button>\n            </div>\n        </div>'),document.getElementById("video-container").insertAdjacentElement("afterbegin",n),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Yu()}));var i=0,r=player_configs.ai.questions_data,s=new Array(r.length).fill(null),a=document.getElementById("questions-prev-button"),o=document.getElementById("questions-next-button");a.addEventListener("click",(function(){i>0&&(i--,e(i))})),o.addEventListener("click",(function(){i<r.length-1&&(i++,e(i))})),e(i)}catch(e){console.log(e,"err")}}function Ku(){Yu();var e,t,n,i=(e=player_configs.ai.mindmap_data,t="mindmap ".concat(e.theme,"\n"),n=0,function e(i,r){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a="N".concat(n++),o=i.text?i.text:"Node ".concat(a);if(o=qu(o),s||(t+="".concat(r).concat(a,'("').concat(o,'")\n')),i.children){var l=r+"    ";i.children.forEach((function(n){t+="".concat(r,"    ").concat(a," --\x3e "),e(n,l)}))}}(e,"",!0),t);try{var r=document.createElement("div"),s='<div id="abstract-footer">\n            <div></div>\n            <button id="mindmap-download-button">'.concat(lu[au].download_button,"</button>\n        </div>");r.id="content-ai-dialog",r.innerHTML='<div id="modal-ai">\n            <header>\n                <p class="title-ai-text">'.concat(lu[au].mindmap,'</p>\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <pre id="mindmap-container" class="mermaid"></pre>\n            </div>\n            ').concat(player_configs.ai.pdf_generated?s:"","\n        </div>"),document.getElementById("video-container").insertAdjacentElement("afterbegin",r);var a=document.getElementById("mindmap-container");a.textContent=i,window.mermaid.run({querySelector:"#mindmap-container"}),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Yu()}));var o=Panzoom(a,{maxScale:5});o.pan(0,0),a.parentElement.addEventListener("wheel",o.zoomWithWheel),player_configs.ai.pdf_generated&&document.getElementById("mindmap-download-button").addEventListener("click",(function(){var e="".concat(hd,"/").concat(kd,"/").concat(Sd,"/mindmap.pdf");fetch(e).then((function(e){return e.blob()})).then((function(e){var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="mindmap.pdf",document.body.appendChild(n),n.click(),n.remove()})).catch((function(e){console.error("Error while trying to download ebook pdf: ",e)}))})),setTimeout((function(){document.querySelectorAll(".mermaid .mindmap-node").forEach((function(e,t){e.setAttribute("data-nodeid","N".concat(t)),e.addEventListener("click",(function(){var e=function(e,t){var n=null;function i(e){var t=1;if(e.children&&e.children.length>0){var n,r=nd(e.children);try{for(r.s();!(n=r.n()).done;)t+=i(n.value)}catch(e){r.e(e)}finally{r.f()}}return t}return function t(r,s){if("N".concat(s)===e)return n=r.time,!0;if(r.children&&r.children.length>0){var a,o=s+1,l=nd(r.children);try{for(l.s();!(a=l.n()).done;){var c=a.value;if(t(c,o))return!0;o+=i(c)}}catch(e){l.e(e)}finally{l.f()}}return!1}(t,0),n}(this.getAttribute("data-nodeid"),player_configs.ai.mindmap_data);window.postMessage({type:"currentTime",parameter:ju(e)},"*"),window.postMessage({type:"play"},"*"),Yu()}))}))}),1e3)}catch(e){console.log("err",e)}}function Wu(){Yu();try{var e=player_configs.ai.abstract_data,t=document.createElement("div");t.id="content-ai-dialog",t.innerHTML='<div id="modal-ai">\n            <header>\n                <p class="title-ai-text">'.concat(lu[au].abstract,'</p>\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <div id="abstract-content">\n                    ').concat((n=e,n.replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/^\- (.+)$/gm,"<li>$1</li>").split(/\n/).join("").replace(/<\/li><li>/g,"</li>\n<li>").replace(/<li>(.+?)<\/li>/g,"<ul><li>$1</li></ul>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a target=_blank href="$2">$1</a>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>")),'\n                </div>\n            </div>\n            <div id="abstract-footer">\n                <button id="abstract-copy-button">').concat(lu[au].copy_button,'</button>\n                <button id="abstract-download-button">').concat(lu[au].download_button,"</button>\n            </div>\n        </div>"),document.getElementById("video-container").insertAdjacentElement("afterbegin",t),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Yu()})),document.getElementById("abstract-copy-button").addEventListener("click",(function(){navigator.clipboard.writeText(e)})),document.getElementById("abstract-download-button").addEventListener("click",(function(){if(player_configs.ai.pdf_generated){var t="".concat(hd,"/").concat(kd,"/").concat(Sd,"/abstract.pdf");fetch(t).then((function(e){return e.blob()})).then((function(e){var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="abstract.pdf",document.body.appendChild(n),n.click(),n.remove()})).catch((function(e){console.error("Error while trying to download ebook pdf: ",e)}))}else!function(e){var t=new jspdf.jsPDF,n=10,i=function(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.setFontSize(i),t.splitTextToSize(e,180).forEach((function(e){n>280&&(t.addPage(),n=10),r?t.text("• ".concat(e),10,n):t.text(e,10,n),n+=i+2}))};e.split("\n").forEach((function(e){e.startsWith("# ")?i(e.substring(2),22):e.startsWith("## ")?i(e.substring(3),18):e.startsWith("### ")?i(e.substring(4),14):e.startsWith("- ")?i(e.substring(2),12,!0):i(e,12)})),t.save("".concat(Sd,"_ebook.pdf"))}(e)}))}catch(e){console.log(e,"err")}var n}function Xu(e){var t,n=[],i="",r="",s=nd(e.split("\n"));try{for(s.s();!(t=s.n()).done;){var a=t.value,o=(a=a.replace(/\r/g,"").trim()).match(/^\d+$/),l=a.match(/^((\d{2}:)?\d{2}:\d{2}\.\d{3}) --> ((\d{2}:)?\d{2}:\d{2}\.\d{3})$/);!o&&l?(""!==i&&(n.push({text:i,time:r}),i="",r=""),r=l[1]):o||""===a||a.toUpperCase().match(/WEBVTT|X-TIMESTAMP/)||(i+=a+" ")}}catch(e){s.e(e)}finally{s.f()}return""!==i&&n.push({text:i.trim(),time:r}),n}function Zu(){return Zu=td(Jc().mark((function e(){var t,n,i;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=player_configs.subtitles.map((function(e){var t="".concat(ud,"/").concat(kd,"/").concat(Sd,"/").concat(e.srclang,".vtt");return fetch(t).then((function(t){if(!t.ok)throw new Error("Error downloading subtitles for ".concat(e.srclang));return t.text()})).then((function(e){return Xu(e)}))})),n=[],e.next=4,Promise.all(t);case 4:(i=e.sent)&&i.length&&i.forEach((function(e){return n=[].concat(Wc(n),Wc(e))})),n&&n.length&&(player_configs.subtitles_search=n);case 7:case"end":return e.stop()}}),e)}))),Zu.apply(this,arguments)}function Qu(){var e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path fill="white" d="M 21 3 C 11.601563 3 4 10.601563 4 20 C 4 29.398438 11.601563 37 21 37 C 24.355469 37 27.460938 36.015625 30.09375 34.34375 L 42.375 46.625 L 46.625 42.375 L 34.5 30.28125 C 36.679688 27.421875 38 23.878906 38 20 C 38 10.601563 30.398438 3 21 3 Z M 21 7 C 28.199219 7 34 12.800781 34 20 C 34 27.199219 28.199219 33 21 33 C 13.800781 33 8 27.199219 8 20 C 8 12.800781 13.800781 7 21 7 Z"></path></svg>',n=document.createElement("button");n.setAttribute("class","panda-smart-search plyr__control plyr__controls__item"),n.setAttribute("type","button"),n.onclick=function(e){(function(){Yu(),function(){Zu.apply(this,arguments)}();try{var e,t=document.createElement("div");t.id="content-ai-dialog",t.innerHTML='<div id="modal-ai" class="smart-search">\n            <header>\n                <input id="input-smart-search" placeholder="'.concat(lu[au].smart_search_placeholder,'" />\n                <button class="close-ai-button">x</button>\n            </header>\n            <div id="content-ai">\n                <div id="search-content">\n                    <ul>\n                    </ul>\n                </div>\n            </div>\n        </div>'),document.getElementById("video-container").insertAdjacentElement("afterbegin",t),document.getElementsByClassName("close-ai-button")[0].addEventListener("click",(function(){Yu()})),document.getElementById("input-smart-search").addEventListener("input",(function(t){clearTimeout(e);var i=t.target.value.trim();(i.length>=2||!i.length)&&(e=setTimeout((function(){n(i)}),300))}));var n=function(e){var t=player_configs.subtitles_search;if(t&&(!t||t.length)){var n=new Fuse(t,{includeScore:!0,minMatchCharLength:2,threshold:.3,limit:20,keys:[{name:"text",getFn:function(e){return e.text.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}}]}),i=document.querySelector("#search-content > ul"),r="",s=e?n.search(e):[];s&&s.length&&s.forEach((function(e){var t=e.item;r+="<li class=item-smart-search data-time=".concat(t.time,">\n                        <p>").concat(t.text,"</p>\n                        <span>").concat(Hu(ju(t.time)),"</span>\n                    </li>")})),i.innerHTML=r,window.parent.postMessage({message:"panda_smart_search",video:Sd,query:e},"*")}};document.querySelector("#search-content").addEventListener("click",(function(e){if(e.target.classList.contains("item-smart-search")||e.target.closest(".item-smart-search")){var t=e.target.closest(".item-smart-search").getAttribute("data-time");window.postMessage({type:"currentTime",parameter:ju(t)},"*"),window.postMessage({type:"play"},"*"),Yu()}}))}catch(e){console.log(e,"err")}})(),e.stopPropagation()},t=t.replace(/white/gm,"var(--plyr-video-control-color)"),n.innerHTML="\n        ".concat(t,"\n    "),Ru(n,1),(e=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0",document.head.appendChild(e)}function Ju(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=document.querySelector("#video-container"),n=t.getBoundingClientRect().height,i=document.querySelector(".live-chat-container");i.style.height="".concat(n*e,"px")}function eh(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=document.querySelector(".panda-live-chat.plyr__control.plyr__controls__item");t.classList[e]("new-message-badge")}function th(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"show",t=document.querySelector("#video-container"),n=window.innerWidth<830,i={show:"table",hide:"none"};(n||"show"===e&&!n)&&(t.style.display=i[e])}function nh(e){var t=e.currentTarget.getAttribute("data-ai"),n={mindmap:Ku,questions:Vu,abstract:Wu};n[t]&&n[t]()}function ih(e){e||document.write("Unauthorized"),fetch("https://config-drm.tv.pandavideo.com.br/"+kd+"/"+e+"-drm.json?nocache="+Date.now(),{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(t){var n;pandaLoad.setupThumb();var i=lu[au].watermark_question;t&&null!==(n=t.config_player)&&void 0!==n&&n.watermark_question&&(i=t.config_player.watermark_question);var r=document.querySelector("video");$h(r,"blur");var s=document.getElementsByClassName("loading-icon")[0];$h(s,"disabled");var a="<form class=container-drm><h2 id=drm-question "+(player_configs.controlsColor?'style="color: '+player_configs.controlsColor+'"':"")+">"+i.replace(/<\/?[^>]+(>|$)/g,"")+"</h2><input id=drm-answer /><button id=drm-button "+(player_configs.primaryColor?'style="background-color: '+player_configs.primaryColor+'"':"")+'><div class="drm-search-icon"><svg viewBox="-112 0 512 512" '+(player_configs.controlsColor?'fill="'+player_configs.controlsColor+'"':"")+' ><path d="M64 352L160 256 64 160 96 128 224 256 96 384 64 352Z" /></svg></div><div class="drm-loading-icon disabled"><svg x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve"><path '+(player_configs.controlsColor?'fill="'+player_configs.controlsColor+'"':"")+' d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="360 50 50" repeatCount="indefinite" /></path></svg></div></button></form>';!function(e,t){var n=document.createElement("div");for(n.innerHTML=t;n.children.length>0;)e.appendChild(n.children[0])}(document.getElementById("video-container"),a);var o,l=document.querySelector("form");function c(t){var n=document.getElementById("drm-answer"),i=document.getElementsByClassName("drm-search-icon")[0],a=document.getElementsByClassName("drm-loading-icon")[0];t.preventDefault(),Gh(a,"disabled"),$h(i,"disabled"),fetch(dd+"/drm/token/?jwt=1&key="+n.value.trim()+"&drm_group_id="+e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(t){qd=t.jwt,Gh(a,"disabled"),l.remove(),Gh(s,"disabled"),Gh(r,"blur");try{localStorage.setItem(e,n.value.trim())}catch(e){}var i=document.querySelector("video > source"),o="https://b-".concat(kd,".tv.pandavideo.com.br/").concat(Sd,"/playlist.m3u8?watermark=").concat(qd);i.src=o,window.pandatag("videoHtmlLoaded",!0),rh()})).catch((function(t){$h(a,"disabled"),Gh(i,"disabled"),n.focus();try{localStorage.removeItem(e)}catch(e){}}))}l.onsubmit=c.bind(l);try{o=localStorage.getItem(e)}catch(e){}o&&(document.getElementById("drm-answer").value=o,c({preventDefault:function(){}})),setTimeout((function(){document.getElementById("drm-answer").focus()}),500)}))}function rh(){var e;fh(),e=hd+"/"+kd+"/"+Sd+".json","true"===Nd&&(e+="?date="+(new Date).getTime()),fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){var t,n;e.ai&&(player_configs.ai=e.ai,function(){var e=hd+"/"+kd+"/"+Sd+"-ai.json";"true"===Nd&&(e+="?date="+(new Date).getTime()),fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){e.mindmap&&(player_configs.ai.mindmap_data=e.mindmap),e.questions&&(player_configs.ai.questions_data=e.questions),e.abstract&&(player_configs.ai.abstract_data=e.abstract)}))}(e.profile)),e.subtitles&&(player_configs.subtitles=e.subtitles),e.bookMarks&&(player_configs.bookMarks=e.bookMarks),e.ctas&&(player_configs.ctas=e.ctas),e.profile?(window.player_configs.profile=e.profile,t=e.profile,n=hd+"/"+kd+"/profiles/"+t+".json","true"===Nd&&(n+="?date="+(new Date).getTime()),fetch(n,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];if("controls"===i){if(!e[i])continue;var r=e.controls.findIndex((function(e){return"volume"===e}));-1!==r&&e.controls.splice(r,0,"mute");var s=e.controls.findIndex((function(e){return"current-time"===e}));-1!==s&&e.controls.splice(s+1,0,"duration"),player_configs[i]=e[i]}else"vsl"===i||"colors"===i||"saveProgress"===i||"general"===i?null!=e[i]&&null!=e[i]&&(""==e[i].fbPixel&&delete e[i].fbPixel,""==e[i].gtagIds&&delete e[i].gtagIds,Object.hasOwnProperty.call(e[i],"trialWarning")&&delete e[i].trialWarning,window.player_configs=Zc(Zc({},window.player_configs),e[i])):"hideControlsOnStart"===i&&(window.player_configs.hideControlsOnStart=e[i]);window.player_configs.autoplay&&(document.querySelector("video").autoplay=!0),window.player_configs.mutedIndicatorIcon&&(player_configs.muted=!0)}})).catch((function(e){console.log("Error: falied to fetch video profile",e)})).finally((function(){pandatag("configProfileLoaded",!0),function(e){if(e){var t=hd+"/"+kd+"/tmi/"+e+".json";"true"===Nd&&(t+="?date="+(new Date).getTime()),fetch(t,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error("Not 2xx response")})).then((function(e){player_configs.customMutedIndicatorData=e})).catch((function(e){console.log("Error: falied to fetch video muted indicator")})).finally((function(){pandatag("configMutedIndicatorLoaded",!0)}))}else pandatag("configMutedIndicatorLoaded",!0)}(player_configs.customMutedIndicatorId)}))):(pandatag("configMutedIndicatorLoaded",!0),pandatag("configProfileLoaded",!0)),pandatag("setupThumb",(function(){var t=document.querySelector("video"),n=cd.searchParams.get("thumbnail");n?t.setAttribute("poster",n):e.thumb&&""!==e.thumb?Nd?t.setAttribute("poster",pd+"/"+kd+"/"+e.thumb+"?date="+(new Date).getTime()):t.setAttribute("poster",pd+"/"+kd+"/"+e.thumb):(t.setAttribute("poster","https://b-"+kd+".tv.pandavideo.com.br/"+Sd+"/thumbnail.jpg"),setTimeout((function(){var e=document.querySelector(".plyr__poster");e&&$h(e,"thumbnail-blur")}),0))})),e.defaultSubtitle&&(player_configs.defaultSubtitle=e.defaultSubtitle),e.customPixels&&(player_configs.customPixels=e.customPixels)})).catch((function(){pandatag("configProfileLoaded",!0),pandatag("configMutedIndicatorLoaded",!0),pandatag("setupThumb",(function(){if("online"!==Wd){var e=document.querySelector("video"),t=cd.searchParams.get("thumbnail");if(t)return void e.setAttribute("data-poster",t);e.setAttribute("data-poster","https://b-"+kd+".tv.pandavideo.com.br/"+Sd+"/thumbnail.jpg")}setTimeout((function(){var e=document.querySelector(".plyr__poster");e&&$h(e,"thumbnail-blur")}),0)}))})).finally((function(){pandatag("configVideoLoaded",!0)})),Oh()}function sh(){return ah.apply(this,arguments)}function ah(){return(ah=td(Jc().mark((function e(){var t;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=cast.framework.CastContext.getInstance().getCurrentSession()){e.next=5;break}return e.next=4,cast.framework.CastContext.getInstance().requestSession();case 4:t=cast.framework.CastContext.getInstance().getCurrentSession();case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}((Sd||Ld||Ad||Cd)&&kd||(document.write("Missing videoID (v) or libID (l)"),0))&&(window.player_configs=(Qc(yu={controls:["play-large","play","progress","current-time","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],captionsBackgroundColor:"#000",primaryColor:"#4874F1",captionsColor:"#FFF",menuColor:"#4a5464",initDisabledControls:!1,controlsColor:"#FFF",pandaBranding:!0,refCode:"",fbPixel:[],customPixels:[],mutedIndicatorIcon:!1,mutedIndicatorTextTop:"",mutedIndicatorTextBottom:"",mutedIndicatorSize:"small",mutedIndicatorOpacity:.8,muted:!1,autoplay:!1,disablePause:!1,initQuality:0,alternativeProgress:!1,alternativeProgress2xLimit:20,alternativeProgressDefaultVelocity:!1,mutedIndicatorClickRestart:!0,alternativeProgressVelocity:5,alternativeProgressHeight:0,liveColor:"#fc2d2d",bookMarks:[]},"customPixels",[]),Qc(yu,"bookmarksLabel","index"),Qc(yu,"ctas",[]),Qc(yu,"availableSpeeds",[.5,.75,1,1.25,1.5,2]),Qc(yu,"defaultSpeed",1),Qc(yu,"smartSearch",!1),Qc(yu,"saveProgress",!0),Qc(yu,"saveProgressScreen",!1),Qc(yu,"saveProgressTitle","Você já começou a assistir esse vídeo"),Qc(yu,"saveProgressBackgroundOpacity",1),Qc(yu,"saveProgressButton1Title","Continuar assistindo"),Qc(yu,"saveProgressButton2Title","Voltar ao início"),Qc(yu,"hideControlsOnStart",!1),Qc(yu,"defaultSubtitle",null),Qc(yu,"startsWithSubtitle",!1),Qc(yu,"restartAfterEnd",!1),Qc(yu,"onlyLoopMuted",!1),Qc(yu,"realtimeAnalytics",!1),Qc(yu,"troubleshootDialog",!0),Qc(yu,"disableForward",!1),Qc(yu,"playOpensFullscreen",!1),Qc(yu,"playOpensFullscreenNative",!1),Qc(yu,"gtagIds",[]),Qc(yu,"showPreviewThumbs",!0),Qc(yu,"smartAutoplay",!1),Qc(yu,"disableSeeking",!1),Qc(yu,"mutedIndicatorAnimation","default"),Qc(yu,"mutedIndicatorLoop",!1),Qc(yu,"mutedIndicatorLoopDuration",5),Qc(yu,"mutedIndicatorFontSize",22),Qc(yu,"captionsFontSize",20),Qc(yu,"smallMutedIcon",!0),Qc(yu,"bigPlayButtonSize",55),Qc(yu,"bigPlayButtonIconSize",18),Qc(yu,"mutedIndicatorBackgroundColor",""),Qc(yu,"mutedIndicatorTextColor",""),Qc(yu,"mutedIndicatorBorderSize",2),Qc(yu,"customMutedIndicatorData",""),Qc(yu,"customMutedIndicatorId",""),Qc(yu,"pauseThumbnail",""),Qc(yu,"endThumbnail",""),Qc(yu,"defaultLanguage",""),Qc(yu,"trialWarning",!1),Qc(yu,"iosFakeFullscreen",!1),Qc(yu,"ai",!1),yu),window.pandatag=function(e,t){if(window.pandaLoad[e]=t,pandaLoad=window.pandaLoad,pandaLoad.videoHtmlLoaded&&pandaLoad.configLibraryLoaded&&pandaLoad.configVideoLoaded&&pandaLoad.configProfileLoaded&&pandaLoad.configMutedIndicatorLoaded&&pandaLoad.playerLoaded&&!eu){fh(),window.player_configs.controls.includes("cast")&&"online"!==Wd&&(m=10,g=setInterval((function(){try{chrome.cast.isAvailable&&!Hd&&(clearInterval(g),cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED}),function(){var e='<svg viewBox="100 -900 800 800"><path d="M481-480Zm340 320H601q0-15-1-30t-3-30h224v-520H141v60q-15-2-30-3t-30-1v-56q0-24.75 17.625-42.375T141-800h680q24.75 0 42.375 17.625T881-740v520q0 24.75-17.625 42.375T821-160Zm-740 0v-104q41.667 0 70.833 30.333Q181-203.333 181-160H81Zm200 0q0-84.66-58-144.33Q165-364 81-364v-60q108.643 0 184.321 77.5Q341-269 341-160h-60Zm160 0q0-75-28-141.5t-77-116q-49-49.5-114.5-78T81-524v-60q87 0 163.5 33.5t133.5 91q57 57.5 90 135T501-160h-60Z" fill="'.concat(player_configs.controlsColor,'" /></svg>'),t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("class","plyr__controls__item plyr__control chromecast-btn"),e=e.replace(/white/gm,"var(--plyr-video-control-color)"),t.innerHTML=e,Ru(t,1),t.onclick=td(Jc().mark((function e(){return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oh){e.next=4;break}hh(),e.next=6;break;case 4:return e.next=6,lh();case 6:case"end":return e.stop()}}),e)})));var n=new cast.framework.RemotePlayer;new cast.framework.RemotePlayerController(n).addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,(function(e){if(e.value){oh=!0;var t=document.getElementsByClassName("chromecast-btn");t&&(t[0].innerHTML='<svg viewBox="100 -900 800 800"><path d="M741-300H582q-5-16-10-32.5T562-360h119v-240H364q-29-19-60.874-33.909Q271.252-648.818 237-660h504v360ZM480-480ZM81-160v-104q41.667 0 70.833 30.333Q181-203.333 181-160H81Zm200 0q0-84.66-58-144.33Q165-364 81-364v-60q108.643 0 184.321 77.5Q341-269 341-160h-60Zm160 0q0-75-28-141.5t-77-116q-49-49.5-114.5-78T81-524v-60q87 0 163.5 33.5t133.5 91q57 57.5 90 135T501-160h-60Zm380 0H601q0-15-1-30t-3-30h224v-520H141v60q-15-2-30-3t-30-1v-56q0-24.75 17.625-42.375T141-800h680q24.75 0 42.375 17.625T881-740v520q0 24.75-17.625 42.375T821-160Z" fill="'.concat(player_configs.controlsColor,'" /></svg>')),dh()}}))}())}catch(e){}m||clearInterval(g),m--}),1e3));var n=null;try{n=localStorage.getItem("panda_video:"+Sd)}catch(e){}player_configs.mutedIndicatorClickRestart&&player_configs.saveProgress&&!player_configs.saveProgressScreen&&n&&(player_configs.mutedIndicatorClickRestart=!1),pandaLoad.applyColors(),pandaLoad.setupControls(),pandaLoad.setupThumb(),window.player_configs.defaultLanguage&&(au=window.player_configs.defaultLanguage,fu.i18n=lu[au]);var i=player_configs.default_speed;fu.speed={selected:player_configs.defaultSpeed,options:player_configs.availableSpeeds.map((function(e){return parseFloat(e)})),turbo:i},player_configs.autoplay&&(player_configs.muted=!0,fu.muted=!0,fu.autoplay=!0),player_configs.disableForward&&(fu.keyboard.global=!1,fu.keyboard.focused=!1),pandaLoad.setupPlayer(fu),Fd?Md||(ph(),navigator.sendBeacon(iu+"/icon.gif?type=view&v="+Sd+"&u="+vu+"&p="+kd+"&referrer="+encodeURIComponent(document.referrer)+"&visibily="+!document[sd])):document.addEventListener(ad,(function(){Fd||Id||wh(),zd||Md||(ph(),navigator.sendBeacon(iu+"/icon.gif?type=view&v="+Sd+"&u="+vu+"&p="+kd+"&referrer="+encodeURIComponent(document.referrer)+"&visibily="+!document[sd]),zd=!0)}),!1),ku(document),function(){if(player_configs.controls.includes("rewind")){var e=document.querySelectorAll('[data-plyr="rewind"]')[0];e&&(e.innerHTML='\n              <svg style="width:24px;height:24px" viewBox="0 0 50 50">\n                  <path fill="currentColor" d="M 7.984375 1.9863281 A 1.0001 1.0001 0 0 0 7 3 L 7 13 L 17 13 A 1.0001 1.0001 0 1 0 17 11 L 10.761719 11 C 14.363419 7.3233218 19.405802 5.0234375 25 5.0234375 C 36.109434 5.0234375 45 13.914004 45 25.023438 C 45 36.13287 36.109434 45.023438 25 45.023438 C 13.890566 45.023438 5 36.13287 5 25.023438 A 1.0001 1.0001 0 1 0 3 25.023438 C 3 37.204003 12.819434 47.023438 25 47.023438 C 37.180566 47.023438 47 37.204003 47 25.023438 C 47 12.842871 37.180566 3.0234375 25 3.0234375 C 18.685898 3.0234375 12.985264 5.693158 9 9.9414062 L 9 3 A 1.0001 1.0001 0 0 0 7.984375 1.9863281 z M 29.5 17 C 24.5 17 24.300781 21.7 24.300781 25 C 24.300781 27.5 24.1 33 29.5 33 C 34.4 33 34.699219 28.2 34.699219 25 C 34.699219 21.7 34.4 17 29.5 17 z M 19.5 17.099609 C 19.1 19.499609 17.4 19.999609 15 20.099609 L 15 21.599609 L 19.099609 21.599609 L 19.099609 32.900391 L 21 32.900391 L 21 17.099609 L 19.5 17.099609 z M 29.5 18.800781 C 33.4 18.800781 32.800781 24.699609 32.800781 25.099609 C 32.800781 28.399609 32.2 31.400391 29.5 31.400391 C 25.8 31.400391 26.199219 25.599609 26.199219 25.099609 C 26.199219 24.799609 25.6 18.800781 29.5 18.800781 z"/>\n              </svg>')}if(player_configs.controls.includes("fast-forward")){var t=document.querySelectorAll('[data-plyr="fast-forward"]')[0];t&&(t.innerHTML='<svg style="width:24px;height:24px" viewBox="0 0 50 50">\n              <path fill="currentColor" d="M 41.984375 1.9863281 A 1.0001 1.0001 0 0 0 41 3 L 41 9.9414062 C 37.014556 5.692295 31.313104 3.0234375 25 3.0234375 C 12.819434 3.0234375 3 12.842871 3 25.023438 C 3 37.204003 12.819434 47.023438 25 47.023438 C 37.180566 47.023438 47 37.204003 47 25.023438 A 1.0001 1.0001 0 1 0 45 25.023438 C 45 36.13287 36.109434 45.023438 25 45.023438 C 13.890566 45.023438 5 36.13287 5 25.023438 C 5 13.914003 13.890566 5.0234375 25 5.0234375 C 30.593333 5.0234375 35.63652 7.322796 39.238281 11 L 33 11 A 1.0001 1.0001 0 1 0 33 13 L 43 13 L 43 3 A 1.0001 1.0001 0 0 0 41.984375 1.9863281 z M 29.5 17 C 24.5 17 24.300781 21.7 24.300781 25 C 24.300781 27.5 24.1 33 29.5 33 C 34.4 33 34.699219 28.2 34.699219 25 C 34.699219 21.7 34.4 17 29.5 17 z M 19.5 17.099609 C 19.1 19.499609 17.4 19.999609 15 20.099609 L 15 21.599609 L 19.099609 21.599609 L 19.099609 32.900391 L 21 32.900391 L 21 17.099609 L 19.5 17.099609 z M 29.5 18.800781 C 33.4 18.800781 32.800781 24.699609 32.800781 25.099609 C 32.800781 28.399609 32.2 31.400391 29.5 31.400391 C 25.8 31.400391 26.199219 25.599609 26.199219 25.099609 C 26.199219 24.799609 25.6 18.800781 29.5 18.800781 z"/>\n          </svg>')}}(),function(){var e=document.querySelector(".plyr__menu__container > div");e&&(e.style="max-height: calc(100vh - 50px);");var t=document.querySelector("video");window.innerWidth<400&&(t.onclick=function(){window.postMessage({type:"play_toggle"},"*")})}(),function(){if(!player_configs.controls.includes("progress")){var e=document.querySelector(".plyr__controls");e&&$h(e,"no-progress")}}(),player_configs.trialWarning&&(p=document.getElementsByClassName("plyr--full-ui")[0],(f=document.createElement("div")).id="trial-warning",f.innerHTML=lu[au].trialWarning,p.appendChild(f)),!player_configs.disableForward&&ru?function(){var e=document.querySelector(".plyr__video-wrapper"),t=document.createElement("div");t.classList.add("panda-forward-wrapper");var n=document.createElement("div");n.id="forward_touch";var i=function(e){"forward_touch"!==e.target.id&&"backward_touch"!==e.target.id||window.player.toggleControls(!0)};n.ondblclick=function(){window.player.forward()};var r=document.createElement("div");r.id="backward_touch",r.ondblclick=function(){window.player.rewind()},window.player_configs.controls.includes("play")?(n.onclick=i,r.onclick=i):(n.onclick=function(){window.player.togglePlay()},r.onclick=function(){window.player.togglePlay()}),t.appendChild(r),t.appendChild(n),e.appendChild(t)}():ru&&(player_configs.controls.includes("play")||(document.querySelector("video").onclick=function(){window.player.togglePlay()})),(h=document.querySelector(".plyr__poster"))&&(h.onclick=function(){window.postMessage({type:"play",parameter:1},"*")}),player_configs.controls.includes("play-large")&&function(){var e=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');if(e){e.style.width="".concat(player_configs.bigPlayButtonSize,"px"),e.style.height="".concat(player_configs.bigPlayButtonSize,"px"),e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center";var t=e.querySelector("svg");t&&(t.style.width="".concat(player_configs.bigPlayButtonIconSize,"px"),t.style.height="".concat(player_configs.bigPlayButtonIconSize,"px"),t.style.display="flex",player_configs.bigPlayButtonIconSize>50&&(t.style.paddingLeft="3px"),t.style.alignItems="center")}}(),Bd&&!player_configs.muted||!player_configs.mutedIndicatorIcon||player_configs.saveProgress?player_configs.initDisabledControls||!player_configs.muted||player_configs.mutedIndicatorIcon||player_configs.saveProgressScreen||!player_configs.smallMutedIcon||function(){if(0!==document.getElementsByClassName("plyr--full-ui").length){var e=document.getElementsByClassName("plyr--full-ui")[0],t=document.createElement("button"),n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="7.999 9.062 46.75 32.563" enable-background="new 7.999 9.062 46.75 32.563" xml:space="preserve"> <style>@keyframes BLINK{0%{opacity: 0;}33%{opacity: 1;}66%{opacity: 1;}100%{opacity: 0;}}.blink_1{animation: BLINK 2s infinite; opacity: 0;}.blink_2{animation: BLINK 2s infinite .3s; opacity: 0;}.blink_3{animation: BLINK 2s infinite .6s; opacity: 0;}</style><style class="darkreader darkreader--sync" media="screen"></style> <g class="adjustable fg" style="fill: rgb(255, 255, 255); --darkreader-inline-fill:#ffffff;" data-darkreader-inline-fill=""> <path d="M53.249,39.616c-0.186,0-0.371-0.051-0.537-0.157l-43.5-27.75c-0.466-0.297-0.603-0.916-0.306-1.381c0.298-0.466,0.917-0.601,1.381-0.306l43.5,27.75c0.467,0.297,0.604,0.916,0.307,1.381C53.901,39.453,53.579,39.616,53.249,39.616z"></path> <path class="blink_3" d="M48.896,33.467l1.699,1.085c3.497-7.791,2.073-17.271-4.313-23.659c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414C50.581,18.019,51.913,26.463,48.896,33.467z"></path> <path class="blink_3" d="M46.926,36.956c-0.612,0.863-1.286,1.695-2.059,2.469c-0.392,0.391-0.392,1.023,0,1.414c0.194,0.195,0.45,0.293,0.707,0.293c0.256,0,0.512-0.098,0.706-0.293c0.878-0.878,1.642-1.824,2.333-2.807L46.926,36.956z"></path> <path class="blink_2" d="M42.543,29.415l1.777,1.135c1.545-5.315,0.229-11.293-3.953-15.476c-0.392-0.391-1.023-0.391-1.414,0c-0.392,0.391-0.392,1.023,0,1.414C42.454,19.987,43.639,24.925,42.543,29.415z"></path> <path class="blink_2" d="M41,33.174c-0.563,0.94-1.235,1.837-2.047,2.646c-0.391,0.392-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293s0.512-0.098,0.707-0.293c0.916-0.914,1.676-1.924,2.317-2.984L41,33.174z"></path> <path class="blink_1" d="M35.771,25.094l2.003,1.277c0.012-0.203,0.029-0.404,0.029-0.609c0-3.079-1.2-5.974-3.381-8.153c-0.391-0.391-1.022-0.391-1.414,0c-0.391,0.391-0.391,1.023,0,1.414C34.652,20.666,35.613,22.802,35.771,25.094z"></path> <path class="blink_1" d="M35.084,29.401c-0.474,1.145-1.172,2.197-2.076,3.1c-0.391,0.391-0.391,1.023,0,1.414c0.195,0.195,0.451,0.293,0.707,0.293c0.257,0,0.513-0.098,0.707-0.293c1.008-1.006,1.795-2.17,2.361-3.43L35.084,29.401z"></path> <polygon points="28.124,20.215 28.124,14.991 24.635,17.99 "></polygon> <path d="M20.921,20.366h-6.423c-0.553,0-1,0.508-1,1.135v8.229c0,0.627,0.447,1.135,1,1.135h7.375l6.25,5.875V24.96L20.921,20.366z"></path> </g> </svg>';n=n+"<span>"+lu[au].activateSound+"</span>",t.innerHTML=n,t.onclick=function(){window.postMessage({type:"increaseVolume",parameter:1},"*"),window.postMessage({type:"play",parameter:1},"*"),Iu(),nu=!0,Fh({mutedIndicator:!0})};var i=document.querySelector(".plyr__controls");i&&(i.onclick=function(){nu||(window.postMessage({type:"increaseVolume",parameter:1},"*"),window.postMessage({type:"play",parameter:1},"*"),Fh({mutedIndicator:!0}),nu=!0),Iu()}),$h(t,"small-muted-icon"),e.appendChild(t),nu=!1}}():Nu(),player_configs.mutedIndicatorFontSize&&function(){var e,t=document.querySelectorAll("button.panda-muted-indicator-item span");if(t.length){var n=(e=player_configs.mutedIndicatorFontSize)<=21?"small-text":e>=22&&e<=27?"normal-text":e>=28?"large-text":void 0,i={"small-text":[4,4],"normal-text":[6,4],"large-text":[6,8]},r="\n    button.panda-muted-indicator-item span.".concat(n," {\n        font-size: ").concat(player_configs.mutedIndicatorFontSize,"px;\n    }");player_configs.mutedIndicatorFontSize>18&&(r+="\n        @media(max-width: 680px) {\n            button.panda-muted-indicator-item span.".concat(n," {\n                font-size: ").concat(player_configs.mutedIndicatorFontSize-i[n][0],"px;\n            }\n        }\n        @media(max-width: 380px) {\n            button.panda-muted-indicator-item span.").concat(n," {\n                font-size: ").concat(player_configs.mutedIndicatorFontSize-i[n][0]-i[n][1],"px;\n            }\n        }\n        "));var s=document.createElement("style");s.innerText=r,document.head.appendChild(s),t.forEach((function(e){e.classList.add(n)}))}}();var r=player_configs.controls.filter((function(e){return"play"!==e&&"play-large"!==e}));Od&&(c=Od,d=document.createElement("div"),(u=document.createElement("p")).innerText=c,d.setAttribute("class","panda-title-wrapper"),d.appendChild(u),Ru(d)),(!r||r&&!r.length)&&(document.querySelector(".plyr__controls").style.background="none"),player_configs.alternativeProgress?function(){var e=document.createElement("div");e.id="wrapper-progress",$h(e,"alternative-progress-wrapper");var t=document.createElement("div");$h(t,"alternative-progress"),e.appendChild(t);var n=document.querySelector(".plyr__controls");n&&(n.style="padding-bottom: "+(player_configs.alternativeProgressHeight+5)+"px");var i=document.getElementsByClassName("plyr--html5")[0];player_configs.mutedIndicatorIcon&&$h(e,"disabled"),i.appendChild(e)}():player_configs.controls.includes("progress")&&function(){var e=null,t=document.querySelector(".plyr__progress__container input"),n=document.querySelector(".plyr__progress__container progress"),i=document.querySelector(".plyr__progress");t.style.top="-5px",n.style.top="4px",n.style.opacity="0.01";var r=document.createElement("div");r.className="plyr__pb",i.insertBefore(r,i.firstChild);var s=new w(".plyr__pb",".plyr__progress__container input",{keyColor:"#ff7755",videoLength:105,chapters:[],moments:[],onScrubbingChange:function(e,t){var n=document.querySelector(".plyr__preview-thumb").offsetWidth,i=document.querySelector(".plyr__controls").offsetWidth,r=Math.max(n/2,t);r=Math.min(i-n+n/4,r),document.querySelector(".plyr__preview-thumb").style.left=r-5.5+"px"}});!function(t){!e&&t&&t.thumbnails&&(e=t.thumbnails.showImage,t.thumbnails.showImage=function(n,i,r,s,a){var o;n.width>0&&n.height>0&&(t.config.thumbnail.height=(o=n.width/n.height,Math.floor(thumbnail_width/o))),e.call(t.thumbnails,n,i,r,s,a)})}(window.player),window.player.on("loadedmetadata",(function(){s.SetDuration(window.player.duration)})),setInterval((function(){s.SetCurrentProgress(window.player.currentTime),s.SetBufferProgress(window.player.duration*window.player.buffered)}),16),window.pb=s}(),function(){if(window.player_configs.controls.includes("fast-forward")){var e=document.querySelector("button[data-plyr='fast-forward']");e&&(e.style.marginRight="auto")}else if(window.player_configs.controls.includes("play")){var t=document.querySelector("button[data-plyr='play']");t&&(t.style.marginRight="auto")}else if(window.player_configs.controls.includes("rewind")){var n=document.querySelector("button[data-plyr='rewind']");n&&(n.style.marginRight="auto")}if(player_configs.initDisabledControls){var i=document.querySelector('[data-plyr="play"].plyr__control--overlaid');i&&(i.style.display="none");var r=document.querySelector(".plyr__controls");r&&$h(r,"disabled");var s=document.getElementById("wrapper-progress");s&&$h(s,"disabled")}}(),function(){if(window.player_configs.iosFakeFullscreen&&Gd){var e=document.querySelector('button[data-plyr="fullscreen"]'),t=!1;if(e){var n=e.cloneNode(!0);e.replaceWith(n),n.onclick=function(){if(t){window.parent.postMessage({message:"panda_close_window_fullscreen",video:Sd},"*");var e=n.querySelector("svg.icon--pressed"),i=n.querySelector("svg.icon--not-pressed");e.style.display="none",i.style.display="block",t=!1}else{window.parent.postMessage({message:"panda_open_window_fullscreen",video:Sd},"*");var r=n.querySelector("svg.icon--pressed"),s=n.querySelector("svg.icon--not-pressed");r.style.display="block",s.style.display="none",t=!0}}}}}(),player_configs.smartSearch&&player_configs.subtitles&&Qu(),player_configs.ai&&Object.keys(player_configs.ai).length&&function(e){var t,n=Object.keys(e).filter((function(t){if(e[t]&&!t.match(/_data/))return t}));if(n&&(!n||n.length)){var i,r='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="white" d="M176 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64c-35.3 0-64 28.7-64 64H24c-13.3 0-24 10.7-24 24s10.7 24 24 24H64v56H24c-13.3 0-24 10.7-24 24s10.7 24 24 24H64v56H24c-13.3 0-24 10.7-24 24s10.7 24 24 24H64c0 35.3 28.7 64 64 64v40c0 13.3 10.7 24 24 24s24-10.7 24-24V448h56v40c0 13.3 10.7 24 24 24s24-10.7 24-24V448h56v40c0 13.3 10.7 24 24 24s24-10.7 24-24V448c35.3 0 64-28.7 64-64h40c13.3 0 24-10.7 24-24s-10.7-24-24-24H448V280h40c13.3 0 24-10.7 24-24s-10.7-24-24-24H448V176h40c13.3 0 24-10.7 24-24s-10.7-24-24-24H448c0-35.3-28.7-64-64-64V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H280V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H176V24zm32 152c6.4 0 12.1 3.8 14.7 9.6l42 96 14 32c3.5 8.1-.1 17.5-8.2 21.1s-17.5-.2-21.1-8.2L239.5 304H176.5l-9.8 22.4c-3.5 8.1-13 11.8-21.1 8.2s-11.8-13-8.2-21.1l14-32 42-96c2.5-5.8 8.3-9.6 14.7-9.6zm17.5 96L208 231.9 190.5 272h35.1zM336 176c8.8 0 16 7.2 16 16V320c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16z"/></svg>',s=document.createElement("button");s.setAttribute("class","panda-ai-link plyr__control plyr__controls__item"),s.setAttribute("type","button"),s.onclick=function(e){var t=document.getElementById("context-menu-ai"),n=document.getElementsByClassName("plyr__controls")[0];n.classList.contains("plyr-controls-fix-index")?n.classList.remove("plyr-controls-fix-index"):n.classList.add("plyr-controls-fix-index"),t.classList.contains("active")?t.classList.remove("active"):t.classList.add("active"),e.stopPropagation()},r=r.replace(/white/gm,"var(--plyr-video-control-color)"),s.innerHTML="\n        ".concat(r,'\n        <div id="context-menu-ai" class="plyr__menu__container"><div><div role="menu">\n            ').concat(Object.keys(e).filter((function(e){return"pdf_generated"!==e})).map((function(t){if(e[t]&&!t.match(/_data/))return'<button type="button" data-ai="'.concat(t,'" class="plyr__control ai_button plyr__control--forward"><span>').concat(lu[au][t],"</span></button>")})).join(""),"\n        </div></div></div>\n    "),Ru(s,1),(t=document.querySelectorAll(".plyr__control.ai_button"))&&t.forEach((function(e){e.addEventListener("click",nh)})),document.addEventListener("click",(function(e){document.getElementById("context-menu-ai").classList.remove("active")})),(i=document.createElement("script")).src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js",i.onload=function(){window.mermaid.initialize({startOnLoad:!1})},document.head.appendChild(i),function(){var e=document.createElement("script");e.src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js",document.head.appendChild(e)}(),function(){var e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",document.head.appendChild(e)}()}}(player_configs.ai),player_configs.bookMarks&&player_configs.bookMarks.length>0&&zu(),player_configs.ctas&&player_configs.ctas.length>0&&($u(),Gu()),!player_configs.pandaBranding||player_configs.alternativeProgress||player_configs.mutedIndicatorIcon||(o='<svg width="100" height="20" viewBox="0 0 523 116" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.84 106.728V50.664C3.84 49.192 3.872 48.104 3.936 47.4C4.064 46.696 4.352 45.896 4.8 45C5.696 43.272 7.84 42.408 11.232 42.408C14.624 42.408 16.896 42.856 18.048 43.752C19.264 44.584 19.968 45.832 20.16 47.496C22.592 44.168 26.4 42.504 31.584 42.504C36.832 42.504 41.792 44.968 46.464 49.896C51.136 54.824 53.472 60.552 53.472 67.08C53.472 73.608 51.136 79.336 46.464 84.264C41.856 89.192 36.928 91.656 31.68 91.656C26.432 91.656 22.624 90.184 20.256 87.24V106.632C20.256 108.104 20.192 109.192 20.064 109.896C20 110.6 19.712 111.4 19.2 112.296C18.752 113.256 17.952 113.928 16.8 114.312C15.648 114.696 14.08 114.888 12.096 114.888C10.112 114.888 8.512 114.696 7.296 114.312C6.144 113.928 5.312 113.288 4.8 112.392C4.352 111.496 4.064 110.696 3.936 109.992C3.872 109.288 3.84 108.2 3.84 106.728ZM22.848 61.512C21.376 63.24 20.64 65.128 20.64 67.176C20.64 69.224 21.376 71.112 22.848 72.84C24.384 74.504 26.304 75.336 28.608 75.336C30.976 75.336 32.96 74.504 34.56 72.84C36.224 71.176 37.056 69.288 37.056 67.176C37.056 65.064 36.288 63.176 34.752 61.512C33.216 59.784 31.2 58.92 28.704 58.92C26.272 58.92 24.32 59.784 22.848 61.512ZM88.227 47.784C88.611 44.2 91.139 42.408 95.811 42.408C98.307 42.408 100.163 42.6 101.379 42.984C102.595 43.368 103.427 44.04 103.875 45C104.387 45.96 104.675 46.824 104.739 47.592C104.867 48.296 104.931 49.384 104.931 50.856V84.456C104.931 85.928 104.867 87.048 104.739 87.816C104.675 88.52 104.419 89.352 103.971 90.312C103.075 91.976 100.867 92.808 97.347 92.808C93.891 92.808 91.555 92.392 90.339 91.56C89.187 90.664 88.515 89.384 88.323 87.72C85.955 91.112 81.987 92.808 76.419 92.808C70.915 92.808 65.795 90.28 61.059 85.224C56.323 80.168 53.955 74.312 53.955 67.656C53.955 60.936 56.323 55.08 61.059 50.088C65.859 45.032 71.107 42.504 76.803 42.504C78.979 42.504 80.963 42.888 82.755 43.656C84.547 44.424 85.795 45.16 86.499 45.864C87.203 46.504 87.779 47.144 88.227 47.784ZM70.755 67.752C70.755 69.864 71.587 71.784 73.251 73.512C74.915 75.176 76.931 76.008 79.299 76.008C81.667 76.008 83.619 75.144 85.155 73.416C86.755 71.688 87.555 69.8 87.555 67.752C87.555 65.64 86.787 63.688 85.251 61.896C83.779 60.104 81.763 59.208 79.203 59.208C76.707 59.208 74.659 60.104 73.059 61.896C71.523 63.688 70.755 65.64 70.755 67.752ZM136.391 42.408C142.791 42.408 148.103 44.872 152.327 49.8C156.615 54.664 158.759 60.616 158.759 67.656V84.552C158.759 86.024 158.695 87.144 158.567 87.912C158.503 88.616 158.247 89.416 157.799 90.312C156.903 92.04 154.407 92.904 150.311 92.904C145.767 92.904 143.143 91.72 142.439 89.352C142.055 88.264 141.863 86.632 141.863 84.456V67.56C141.863 64.936 141.095 62.888 139.559 61.416C138.087 59.944 136.071 59.208 133.511 59.208C131.015 59.208 128.967 59.976 127.367 61.512C125.831 63.048 125.063 65.064 125.063 67.56V84.552C125.063 86.024 124.999 87.144 124.871 87.912C124.807 88.616 124.519 89.416 124.007 90.312C123.175 92.04 120.711 92.904 116.615 92.904C112.583 92.904 110.119 92.04 109.223 90.312C108.775 89.352 108.487 88.52 108.359 87.816C108.295 87.048 108.263 85.928 108.263 84.456V50.472C108.263 49.064 108.295 48.008 108.359 47.304C108.487 46.536 108.807 45.704 109.319 44.808C110.215 43.208 112.679 42.408 116.711 42.408C120.615 42.408 123.015 43.144 123.911 44.616C124.551 45.704 124.871 47.016 124.871 48.552C125.127 48.104 125.703 47.464 126.599 46.632C127.495 45.8 128.359 45.128 129.191 44.616C131.367 43.144 133.767 42.408 136.391 42.408ZM196.049 21.384C196.561 20.424 197.425 19.752 198.641 19.368C199.857 18.984 201.457 18.792 203.441 18.792C205.489 18.792 207.121 18.984 208.337 19.368C209.553 19.752 210.385 20.424 210.833 21.384C211.345 22.344 211.633 23.208 211.697 23.976C211.825 24.68 211.889 25.768 211.889 27.24V84.552C211.889 86.024 211.825 87.144 211.697 87.912C211.633 88.616 211.345 89.416 210.833 90.312C209.873 92.04 207.153 92.904 202.673 92.904C198.257 92.904 195.793 91.336 195.281 88.2C192.593 91.272 188.849 92.808 184.049 92.808C178.289 92.808 173.041 90.312 168.305 85.32C163.569 80.264 161.201 74.408 161.201 67.752C161.201 61.032 163.569 55.144 168.305 50.088C173.105 45.032 178.353 42.504 184.049 42.504C188.785 42.504 192.465 44.104 195.089 47.304V27.144C195.089 25.672 195.121 24.584 195.185 23.88C195.313 23.112 195.601 22.28 196.049 21.384ZM180.497 73.512C182.161 75.24 184.177 76.104 186.545 76.104C188.913 76.104 190.865 75.24 192.401 73.512C194.001 71.784 194.801 69.896 194.801 67.848C194.801 65.736 194.033 63.784 192.497 61.992C191.025 60.2 189.009 59.304 186.449 59.304C183.889 59.304 181.841 60.2 180.305 61.992C178.769 63.72 178.001 65.64 178.001 67.752C178.001 69.864 178.833 71.784 180.497 73.512ZM248.048 47.784C248.432 44.2 250.96 42.408 255.632 42.408C258.128 42.408 259.984 42.6 261.2 42.984C262.416 43.368 263.248 44.04 263.696 45C264.208 45.96 264.496 46.824 264.56 47.592C264.688 48.296 264.752 49.384 264.752 50.856V84.456C264.752 85.928 264.688 87.048 264.56 87.816C264.496 88.52 264.24 89.352 263.792 90.312C262.896 91.976 260.688 92.808 257.168 92.808C253.712 92.808 251.376 92.392 250.16 91.56C249.008 90.664 248.336 89.384 248.144 87.72C245.776 91.112 241.808 92.808 236.24 92.808C230.736 92.808 225.616 90.28 220.88 85.224C216.144 80.168 213.776 74.312 213.776 67.656C213.776 60.936 216.144 55.08 220.88 50.088C225.68 45.032 230.928 42.504 236.624 42.504C238.8 42.504 240.784 42.888 242.576 43.656C244.368 44.424 245.616 45.16 246.32 45.864C247.024 46.504 247.6 47.144 248.048 47.784ZM230.576 67.752C230.576 69.864 231.408 71.784 233.072 73.512C234.736 75.176 236.752 76.008 239.12 76.008C241.488 76.008 243.44 75.144 244.976 73.416C246.576 71.688 247.376 69.8 247.376 67.752C247.376 65.64 246.608 63.688 245.072 61.896C243.6 60.104 241.584 59.208 239.024 59.208C236.528 59.208 234.48 60.104 232.88 61.896C231.344 63.688 230.576 65.64 230.576 67.752ZM339.021 43.56C342.349 45.544 344.013 47.656 344.013 49.896C344.013 51.176 343.373 52.936 342.093 55.176L322.221 89.256C321.581 90.344 320.557 91.336 319.149 92.232C317.741 93.064 316.333 93.48 314.925 93.48C313.581 93.48 312.269 93.16 310.989 92.52C309.773 91.816 308.909 91.112 308.397 90.408L307.533 89.352L287.565 55.176C286.285 53.064 285.645 51.336 285.645 49.992C285.645 47.688 287.309 45.544 290.637 43.56C293.069 42.152 294.989 41.448 296.397 41.448C297.805 41.448 298.893 41.896 299.661 42.792C300.493 43.624 301.357 44.904 302.253 46.632L314.829 70.824L327.405 46.632C328.109 45.416 328.621 44.552 328.941 44.04C329.325 43.464 329.901 42.92 330.669 42.408C331.437 41.832 332.461 41.544 333.741 41.544C335.021 41.544 336.781 42.216 339.021 43.56ZM344.944 50.856C344.944 49.384 344.976 48.296 345.04 47.592C345.168 46.824 345.456 45.96 345.904 45C346.8 43.336 349.296 42.504 353.392 42.504C356.464 42.504 358.64 43.048 359.92 44.136C361.008 45.032 361.584 46.408 361.648 48.264C361.712 48.904 361.744 49.832 361.744 51.048V84.648C361.744 86.12 361.68 87.24 361.552 88.008C361.488 88.712 361.2 89.544 360.688 90.504C359.856 92.168 357.392 93 353.296 93C349.264 93 346.8 92.136 345.904 90.408C345.456 89.448 345.168 88.616 345.04 87.912C344.976 87.208 344.944 86.088 344.944 84.552V50.856ZM360.688 33.096C360.24 33.992 359.408 34.632 358.192 35.016C356.976 35.4 355.344 35.592 353.296 35.592C351.312 35.592 349.712 35.4 348.496 35.016C347.28 34.632 346.416 33.96 345.904 33C345.456 32.04 345.168 31.208 345.04 30.504C344.976 29.736 344.944 28.616 344.944 27.144C344.944 25.672 344.976 24.584 345.04 23.88C345.168 23.112 345.456 22.28 345.904 21.384C346.8 19.656 349.296 18.792 353.392 18.792C357.424 18.792 359.856 19.656 360.688 21.384C361.2 22.344 361.488 23.208 361.552 23.976C361.68 24.68 361.744 25.768 361.744 27.24C361.744 28.712 361.68 29.832 361.552 30.6C361.488 31.304 361.2 32.136 360.688 33.096ZM398.981 21.384C399.493 20.424 400.357 19.752 401.573 19.368C402.789 18.984 404.389 18.792 406.373 18.792C408.421 18.792 410.053 18.984 411.269 19.368C412.485 19.752 413.317 20.424 413.765 21.384C414.277 22.344 414.565 23.208 414.629 23.976C414.757 24.68 414.821 25.768 414.821 27.24V84.552C414.821 86.024 414.757 87.144 414.629 87.912C414.565 88.616 414.277 89.416 413.765 90.312C412.805 92.04 410.085 92.904 405.605 92.904C401.189 92.904 398.725 91.336 398.213 88.2C395.525 91.272 391.781 92.808 386.981 92.808C381.221 92.808 375.973 90.312 371.237 85.32C366.501 80.264 364.133 74.408 364.133 67.752C364.133 61.032 366.501 55.144 371.237 50.088C376.037 45.032 381.285 42.504 386.981 42.504C391.717 42.504 395.397 44.104 398.021 47.304V27.144C398.021 25.672 398.053 24.584 398.117 23.88C398.245 23.112 398.533 22.28 398.981 21.384ZM383.429 73.512C385.093 75.24 387.109 76.104 389.477 76.104C391.845 76.104 393.797 75.24 395.333 73.512C396.933 71.784 397.733 69.896 397.733 67.848C397.733 65.736 396.965 63.784 395.429 61.992C393.957 60.2 391.941 59.304 389.381 59.304C386.821 59.304 384.773 60.2 383.237 61.992C381.701 63.72 380.933 65.64 380.933 67.752C380.933 69.864 381.765 71.784 383.429 73.512ZM466.915 61.704C466.915 65.608 465.923 68.52 463.939 70.44C462.019 72.296 459.875 73.224 457.507 73.224H434.755C434.755 75.016 435.811 76.52 437.923 77.736C440.035 78.952 442.147 79.56 444.259 79.56C447.971 79.56 450.883 79.176 452.995 78.408L454.051 78.024C455.587 77.32 456.867 76.968 457.891 76.968C459.939 76.968 461.699 78.408 463.171 81.288C464.003 83.016 464.419 84.488 464.419 85.704C464.419 91.4 457.603 94.248 443.971 94.248C439.235 94.248 435.011 93.448 431.299 91.848C427.651 90.184 424.803 88.008 422.755 85.32C418.723 80.136 416.707 74.344 416.707 67.944C416.707 59.88 419.299 53.448 424.483 48.648C429.731 43.784 436.259 41.352 444.067 41.352C452.963 41.352 459.491 44.488 463.651 50.76C465.827 54.088 466.915 57.736 466.915 61.704ZM446.659 64.488C449.091 64.488 450.307 63.464 450.307 61.416C450.307 59.944 449.731 58.76 448.579 57.864C447.491 56.968 445.891 56.52 443.779 56.52C441.731 56.52 439.683 57.384 437.635 59.112C435.587 60.776 434.563 62.568 434.563 64.488H446.659ZM467.419 67.752C467.419 60.072 470.107 53.736 475.483 48.744C480.859 43.752 487.003 41.256 493.915 41.256C500.827 41.256 506.939 43.752 512.251 48.744C517.563 53.672 520.219 59.976 520.219 67.656C520.219 72.968 518.843 77.704 516.091 81.864C513.339 85.96 509.979 89 506.011 90.984C502.107 92.904 498.043 93.864 493.819 93.864C489.595 93.864 485.499 92.84 481.531 90.792C477.563 88.68 474.203 85.608 471.451 81.576C468.763 77.48 467.419 72.872 467.419 67.752ZM487.483 74.664C489.531 76.2 491.611 76.968 493.723 76.968C495.835 76.968 497.947 76.168 500.059 74.568C502.171 72.968 503.227 70.6 503.227 67.464C503.227 64.328 502.235 61.992 500.251 60.456C498.267 58.92 496.123 58.152 493.819 58.152C491.515 58.152 489.371 58.952 487.387 60.552C485.403 62.152 484.411 64.52 484.411 67.656C484.411 70.728 485.435 73.064 487.483 74.664Z" fill="white"/></svg>',(l=document.createElement("a")).setAttribute("target","_blank"),l.setAttribute("class","panda-branding-link"),player_configs.refCode&&""!==player_configs.refCode?l.setAttribute("href","https://pandavideo.com.br/?ref="+player_configs.refCode):l.setAttribute("href","https://pandavideo.com.br/"),o=o.replace(/white/gm,"var(--plyr-video-control-color)"),l.innerHTML=o,Ru(l),xd=!0),"online"===Wd&&(s=document.getElementsByClassName("plyr__controls")[0],(a=document.createElement("button")).setAttribute("id","live-time-indicator"),a.onclick=function(){window.postMessage({type:"currentTime",parameter:-1},"*")},a.innerHTML="<div></div> LIVE",s.insertBefore(a,s.childNodes[1])),eu=!0,window.liveAttempts=0}var s,a,o,l,c,d,u,h,p,f,m,g},Rd?Bu():Fu(),document.getElementsByTagName("head")[0],document.createElement("script").type="text/javascript");var oh=!1;function lh(){return ch.apply(this,arguments)}function ch(){return(ch=td(Jc().mark((function e(){var t,n,i,r,s,a;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,sh();case 3:return t=e.sent,n=document.querySelector("video"),i=n.getElementsByTagName("source")[0].src,wd&&i.includes("token=")&&(r=i.split("token=")[1].split("&")[0],i=i.replace(r,Lh())),window.player.pause(),(s=new chrome.cast.media.MediaInfo(i)).contentType="application/x-mpegurl",a=new chrome.cast.media.LoadRequest(s),e.next=13,t.loadMedia(a);case 13:uh(window.player.currentTime),dh(),e.next=19;break;case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function dh(){var e=new cast.framework.RemotePlayer,t=new cast.framework.RemotePlayerController(e);t.addEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,(function(e){"PLAYING"==e.value&&window.player.play(),"PAUSED"==e.value&&window.player.pause(),"currentTime"==e.field&&Math.abs(e.value-window.player.currentTime)>=5&&(window.player.currentTime=e.value),"isConnected"!=e.field||e.value||hh()})),window.player.on("play",(function(){e.isPaused&&t.playOrPause()})),window.player.on("pause",(function(){!1===e.isPaused&&t.playOrPause()})),window.player.on("seeked",(function(){var t=window.player.currentTime;Math.abs(t-e.currentTime)>=5&&uh(t)}))}function uh(e){var t=new cast.framework.RemotePlayer,n=new cast.framework.RemotePlayerController(t);t.currentTime=e,n.seek()}function hh(){var e=cast.framework.CastContext.getInstance().getCurrentSession();e&&e.endSession(!0);var t=document.getElementsByClassName("chromecast-btn");t&&(t[0].innerHTML='<svg viewBox="100 -900 800 800"><path d="M481-480Zm340 320H601q0-15-1-30t-3-30h224v-520H141v60q-15-2-30-3t-30-1v-56q0-24.75 17.625-42.375T141-800h680q24.75 0 42.375 17.625T881-740v520q0 24.75-17.625 42.375T821-160Zm-740 0v-104q41.667 0 70.833 30.333Q181-203.333 181-160H81Zm200 0q0-84.66-58-144.33Q165-364 81-364v-60q108.643 0 184.321 77.5Q341-269 341-160h-60Zm160 0q0-75-28-141.5t-77-116q-49-49.5-114.5-78T81-524v-60q87 0 163.5 33.5t133.5 91q57 57.5 90 135T501-160h-60Z" fill="'.concat(player_configs.controlsColor,'" /></svg>')),oh=!1,wd&&window.location.reload()}function ph(){if(player_configs.fbPixel&&player_configs.fbPixel.length){try{player_configs.fbPixel,"undefined"==typeof fbq&&function(e,t,n,i,r,s,a){e.fbq||(r=e.fbq=function(){r.callMethod?r.callMethod.apply(r,arguments):r.queue.push(arguments)},e._fbq||(e._fbq=r),r.push=r,r.loaded=!0,r.version="2.0",r.queue=[],(s=t.createElement(n)).async=!0,s.src="https://connect.facebook.net/en_US/fbevents.js",(a=t.getElementsByTagName(n)[0]).parentNode.insertBefore(s,a))}(window,document,"script")}catch(e){console.log("Error in fbp init",e)}var e,t=nd(player_configs.fbPixel);try{for(t.s();!(e=t.n()).done;){var n=e.value;try{n&&(fbq("init","".concat(n)),fbq("track","PageView"))}catch(e){}}}catch(e){t.e(e)}finally{t.f()}}if(player_configs.gtagIds&&player_configs.gtagIds.length)try{!function(){if(!document.getElementById("gtag-script")){var e=document.createElement("script");e.id="gtag-script",e.src="https://www.googletagmanager.com/gtag/js?id="+player_configs.gtagIds[0],e.async=!0,document.head.appendChild(e)}window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date);var t,n=nd(player_configs.gtagIds);try{for(n.s();!(t=n.n()).done;){var i=t.value;gtag("config",i)}}catch(e){n.e(e)}finally{n.f()}gtag("event","page_view",{video_id:Sd,library_id:"b-"+kd})}()}catch(e){console.log("Error in gtag init",e)}var i,r=player_configs.customPixels.filter((function(e){return"view"===e.conditionType})),s=nd(r);try{for(s.s();!(i=s.n()).done;){var a=i.value,o=new Function(a.script);try{o()}catch(e){}}}catch(e){s.e(e)}finally{s.f()}}function fh(){for(var e=0,t=Object.keys(player_configs);e<t.length;e++){var n=t[e],i=cd.searchParams.get(n);if(i){if("trialWarning"===n)continue;if("controls"===n){player_configs[n]=i.split(",");var r=player_configs.controls.findIndex((function(e){return"volume"===e}));-1!==r&&player_configs.controls.splice(r,0,"mute");var s=player_configs.controls.findIndex((function(e){return"current-time"===e}));-1!==s&&player_configs.controls.splice(s+1,0,"duration")}else"boolean"==typeof player_configs[n]?"true"!==i&&"false"!==i||(player_configs[n]="true"===i):"number"==typeof player_configs[n]?player_configs[n]=parseFloat(i):Array.isArray(player_configs[n])?player_configs[n]=i.split(","):player_configs[n]=i}}}var mh=function(){var e=Gd?"ios":"hlsjs",t=document.querySelector("video");if("hlsjs"===e)return window.hls.audioTracks;if("ios"===e){for(var n=[],i=0;i<t.audioTracks.length;i++)n.push({name:t.audioTracks[i].label,id:t.audioTracks[i].id,lang:t.audioTracks[i].language});return n}},gh=function(){var e=Gd?"ios":"hlsjs",t=document.querySelector("video");if("hlsjs"===e)return-1===window.hls.audioTrack?window.hls.audioTracks[0]:window.hls.audioTracks[window.hls.audioTrack];if("ios"===e)for(var n=0;n<t.audioTracks.length;n++)if(t.audioTracks[n].enabled)return{name:t.audioTracks[n].label,id:t.audioTracks[n].id,lang:t.audioTracks[n].language}},yh=function(e){var t=Gd?"ios":"hlsjs",n=document.querySelector("video");if("hlsjs"===t)window.hls.audioTrack=e;else if("ios"===t)for(var i=0;i<n.audioTracks.length;i++)n.audioTracks[i].id===e?n.audioTracks[i].enabled=!0:n.audioTracks[i].enabled=!1;window.player&&(window.isPlaying=window.player.playing,window.player.pause(),_h(!0));try{localStorage.setItem("panda_video_audio_lang",gh().lang)}catch(e){}};function vh(){var e=document.querySelector(".plyr__menu__container > div > div > div");if(e&&!(mh().length<2)){var t=gh(),n=document.createElement("button");n.setAttribute("data-plyr","settings"),n.setAttribute("type","button"),n.setAttribute("class","plyr__control plyr__control--forward"),n.setAttribute("role","menuitem"),n.setAttribute("aria-haspopup","true"),n.innerHTML='<span>Áudio<span class="plyr__menu__value">'.concat(t.name,"</span></span>"),n.onclick=function(){var e,t=nd(document.querySelector(".plyr__menu__container > div ").childNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.id.includes("audio")?n.removeAttribute("hidden"):n.setAttribute("hidden","")}}catch(e){t.e(e)}finally{t.f()}},e.insertBefore(n,e.childNodes[0]);var i=document.querySelector(".plyr__menu__container > div"),r=document.createElement("div");r.setAttribute("id","plyr-settings-audio"),r.setAttribute("hidden","");var s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("class","plyr__control plyr__control--back"),s.innerHTML='<span aria-hidden="true">Áudio</span><span class="plyr__sr-only">Voltar ao menu anterior</span>',s.onclick=function(){var e,t=nd(document.querySelector(".plyr__menu__container > div ").childNodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.id.includes("home")?n.removeAttribute("hidden"):n.setAttribute("hidden","")}}catch(e){t.e(e)}finally{t.f()}};var a=document.createElement("div");a.setAttribute("role","menu");var o,l=nd(mh());try{var c=function(){var e=o.value,i=document.createElement("button");i.setAttribute("data-plyr","language"),i.setAttribute("type","button"),i.setAttribute("role","menuitemradio"),i.setAttribute("class","plyr__control"),i.setAttribute("aria-checked",t.id===e.id),i.setAttribute("value",e.id),i.innerHTML="<span>".concat(e.name).concat("default"!==e.lang?'<span class="plyr__menu__value"><span class="plyr__badge">'.concat(e.lang.toUpperCase(),"</span></span>"):"","</span>"),i.onclick=function(){yh(e.id),n.innerHTML='<span>Áudio<span class="plyr__menu__value">'.concat(e.name,"</span></span>");var t,r=nd(document.querySelector("#plyr-settings-audio").querySelectorAll('button[data-plyr="language"]'));try{for(r.s();!(t=r.n()).done;)t.value.setAttribute("aria-checked",!1)}catch(e){r.e(e)}finally{r.f()}i.setAttribute("aria-checked",!0),s.click(),document.querySelector("button[data-plyr='settings']").click()},a.appendChild(i)};for(l.s();!(o=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}r.appendChild(s),r.appendChild(a),i.appendChild(r)}}function bh(e){try{if(0===e)window.hls.currentLevel=-1;else{if("online"===Wd){var t=Zd.reverse().indexOf(e);t>=0&&(window.hls.currentLevel=t)}window.hls.levels.forEach((function(t,n){t.height===e&&(window.hls.currentLevel=n)}))}}catch(e){}_d&&!Gd&&window.player&&(Yd=!0,window.player.pause(),_h(!0))}function _h(e){if(e){var t=document.querySelector(".loading-icon");t.style.opacity=.8;var n=document.querySelector(".plyr__control--overlaid");n&&$h(n,"disabled"),Gh(t,"disabled")}else{var i=document.querySelector(".loading-icon"),r=document.querySelector(".plyr__control--overlaid");r&&Gh(r,"disabled"),$h(i,"disabled")}}var Th=0;function Eh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{recoverFromError:!1};t.recoverFromError&&window.hls&&window.hls.destroy();var n=new Ls(e),i=document.querySelector("video"),r=i.getElementsByTagName("source")[0].src;if(r.includes("token=")){var s=r.split("token=")[1].split("&")[0];r=r.replace(s,Lh())}i.getElementsByTagName("source")[0].src=r,n.loadSource(r),n.attachMedia(i),Rd&&n.on(Ls.Events.LEVEL_UPDATED,(function(e,t){"online"===Wd&&!1===t.details.live&&(console.log("The live stream has ended!"),window.location.reload())})),n.on(Ls.Events.AUDIO_TRACKS_UPDATED,(function(){try{vh()}catch(e){console.log("Error adding audio controls",e)}})),n.on(Ls.Events.SUBTITLE_TRACKS_UPDATED,(function(e,t){t.subtitleTracks&&t.subtitleTracks.length&&(player_configs.defaultSubtitle&&(window.player.language=player_configs.defaultSubtitle),player_configs.startsWithSubtitle&&(window.player.captions.active=!0))})),n.on(Ls.Events.MANIFEST_PARSED,(function(){try{bh(JSON.parse(localStorage.getItem("plyr")).quality)}catch(e){}t.recoverFromError?(t.isPlaying&&i.play(),i.currentTime=t.currentTime,i.speed=t.speed,i.volume=t.volume):Bd||player_configs.autoplay&&(player_configs.smartAutoplay?(i.volume=1,i.play()):(i.volume=0,i.play()))})),n.on(Ls.Events.BUFFER_FLUSHED,(function(e,t){_h(!0)})),n.on(Ls.Events.BUFFER_APPENDED,(function(e,t){Yd||_h(!1),"audio"===t.type&&window.isPlaying&&window.player.play()})),n.on(Ls.Events.LEVEL_SWITCHED,(function(e,t){var i=document.querySelector(".plyr__controls [data-plyr='quality'][value='0'] span");if(null!=i)if(n.autoLevelEnabled){var r=n.levels[t.level].height;i.innerHTML="Auto ("+r+"p)"}else i.innerHTML="Auto";var s,a=nd(document.querySelectorAll(".plyr__controls [role='menuitem'] span.plyr__menu__value"));try{for(a.s();!(s=a.n()).done;){var o=s.value;if(o.innerHTML.includes("Auto")||"0p"===o.innerHTML)if(n.autoLevelEnabled){var l=n.levels[t.level].height;o.innerHTML="Auto ("+l+"p)"}else o.innerHTML="Auto"}}catch(e){a.e(e)}finally{a.f()}}));var a=function(){try{var e=n.streamController.levels.map((function(e){return e.height})),t=n.streamController.levels[n.streamController.level].height,i=e.sort((function(e,t){return t-e})).find((function(e){return e!==t}));bh(i),console.log("Changing video quality to the next higher one",i),window.player.quality=i}catch(e){}},o=function(){try{var e=n.streamController.levels.map((function(e){return e.height})),t=n.streamController.levels[n.streamController.level].height,i=e.sort((function(e,t){return t-e})).find((function(e){return e<t}));if(!i)return;console.log("Changing video quality to a lower one",i),bh(i),window.player.quality=i}catch(e){}},l=0;n.on(Ls.Events.LEVEL_SWITCHING,(function(e,t){var i,r=nd(n.levels);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(s&&s.uri&&s.uri.includes("token=")){var a=s.uri.split("token=")[1].split("&")[0],o=Lh();s.url=[s.uri.replace(a,o)]}}}catch(e){r.e(e)}finally{r.f()}})),n.on(Ls.Events.ERROR,(function(t,s){if("hlsFragParsingMetadata"!=="".concat(s.event)||"internalException"!=="".concat(s.details))if(console.log("=> PANDA HLS ERROR DELECTED\nPRELOAD="+Bd+"\n",t,s),Th++,"bufferStalledError"==="".concat(s.details)&&_h(!0),Rd&&"levelLoadTimeout"==="".concat(s.details))Eh(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:i.volume,isPlaying:!i.paused});else if(s.response&&404===s.response.code)Rd?Eh(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:i.volume,isPlaying:!i.paused}):_d||a();else if(s.response&&403===s.response.code&&l<3){if(3==++l)a(),l=0;else if(wd&&r.includes("token=")){var c=r.split("token=")[1].split("&")[0],d=r.replace(c,Lh());i.getElementsByTagName("source")[0].src=d}}else if(s.fatal)setTimeout((function(){if(wd&&r.includes("token=")){var t=r.split("token=")[1].split("&")[0],n=r.replace(t,Lh());i.getElementsByTagName("source")[0].src=n}Eh(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:i.volume,isPlaying:!i.paused})}),1e3);else if("online"!==Wd)if(!_d&&Ch(n)&&vd.includes("".concat(s.details)))kh(n);else{if(_d&&[Ls.ErrorDetails.BUFFER_STALLED_ERROR,Ls.ErrorDetails.BUFFER_NUDGE_ON_STALL].includes(s.details))return void o();[Ls.ErrorDetails.BUFFER_APPEND_ERROR,Ls.ErrorDetails.BUFFER_STALLED_ERROR,Ls.ErrorDetails.BUFFER_NUDGE_ON_STALL,Ls.ErrorDetails.BUFFER_FULL_ERROR].includes(s.details)?n.startLoad():[Ls.ErrorDetails.FRAG_LOAD_ERROR,Ls.ErrorDetails.FRAG_LOAD_TIMEOUT].includes(s.details)?o():(console.log("Recovering media error"),Eh(e,{recoverFromError:!0,currentTime:window.player.currentTime,speed:window.player.currentTime,volume:window.player.volume,isPlaying:!i.paused}))}})),window.hls=n,-1==window.hls.currentLevel&&"online"!==Wd&&"finished"!==Wd&&"NOT_LIVE"!==Wd&&(window.hls.currentLevel=2)}function wh(){gd&&Eh({abrEwmaDefaultEstimate:5e6,maxBufferLength:20,autoStartLoad:!0,fragLoadingMaxRetry:9999,fragLoadingTimeOut:15e3}),Id=!0}function Sh(){return xh.apply(this,arguments)}function xh(){return(xh=td(Jc().mark((function e(){var t,n,i,r;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=window.hls.levels[window.hls.currentLevel].height,n=window.player.currentTime,i=window.hls.bandwidthEstimate/1e3,r="".concat("https://hit-realtime.pandavideo.com/icon.gif","?quality=").concat(t,"&time=").concat(n.toFixed(2),"&bandwidth=").concat(i.toFixed(2),"&v=").concat(Sd,"&u=").concat(vu,"&p=").concat(kd,"&referrer=").concat(encodeURIComponent(document.referrer),"&visibily=").concat(!document[sd],"&errors=").concat(Th),Th=0,fetch(r)}catch(e){console.log("Error sending live beacon",e)}console.log("Live beacon sent");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kh(e){var t=e.abrController.fragCurrent.url;bd=yd.find((function(e){return!t.includes(e)}));var n,i=nd(e.streamController.levels);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.details&&r.details.fragments){var s,a=nd(r.details.fragments);try{var o=function(){var e=s.value,t=e.url,n=yd.find((function(e){return t.includes(e)})),i=t.replace(n,bd);e.url=i};for(a.s();!(s=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}}}}catch(e){i.e(e)}finally{i.f()}console.log("Recovering to",yd.findIndex((function(e){return e===bd})))}function Ch(e){try{var t,n=e.abrController.fragCurrent.url,i=yd.find((function(e){return n.includes(e)})),r=nd(e.streamController.levels);try{for(r.s();!(t=r.n()).done;){var s=t.value;if(s.details&&s.details.fragments){var a,o=nd(s.details.fragments);try{for(o.s();!(a=o.n()).done;)if(!a.value.url.includes(i))return!0}catch(e){o.e(e)}finally{o.f()}}}}catch(e){r.e(e)}finally{r.f()}}catch(e){}return!1}function Lh(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<64;n++){var i=Math.floor(Math.random()*e.length);t+=e.charAt(i)}return t}function Ah(){return Ah=td(Jc().mark((function e(t){var n,i,r,s,a,o,l,c,d,u,h,p;return Jc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,i=[],r=!1,s=!1,e.prev=4,a=-1===t.indexOf("?")?"?":"&",t+="".concat(a,"get_qualities=1"),e.next=9,fetch("".concat(t));case 9:if(401!==(o=e.sent).status){e.next=15;break}return l=o.headers.get("drm-group-id"),jd&&(l=jd),ih(l),e.abrupt("return",!1);case 15:return e.next=17,o.text();case 17:c=e.sent,d=c.split("\n");try{u=d.filter((function(e){return e.startsWith("#EXTINF")})).map((function(e){return e.split(",")[1]})),h=u[0].split("|").reduce((function(e,t){var n=Kc(t.split(":"),2),i=n[0],r=n[1];return e[i]=r,e}),{}),h.drm&&(r="true"===h.drm,(_d=r)&&(Rh(),Yd=!0)),h.block_download&&(s="true"===h.block_download),h.duration&&(n=parseInt(h.duration)),h.percent_ts&&0==(Td=100*parseFloat(h.percent_ts))&&(_d=!1,Yd=!1)}catch(e){}p="",d.forEach((function(e){var n=e.match(/#EXT-X-STREAM-INF:.*RESOLUTION=\d+x(\d+)/);n&&n[1]?i.push(parseInt(n[1],10)):e.endsWith(".m3u8")&&!p&&(p=e.startsWith("http")?e:t.split("/").slice(0,-1).join("/")+"/"+e)})),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(4),console.error("Error getting m3u8:",e.t0);case 27:return e.abrupt("return",{block_download:s,drm:r,duration:n,m3u8Qualities:i});case 28:case"end":return e.stop()}}),e,null,[[4,24]])}))),Ah.apply(this,arguments)}function Rh(){var e=document.getElementById("video-container"),t=Math.floor(e.offsetWidth/14);t>96&&(t=96),t<24&&(t=24);var n=Math.floor(e.offsetWidth/54);n>24&&(n=24),n<16&&(n=16);var i='\n    <svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 24 24">\n        <g fill="none" fill-rule="evenodd">\n            <path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z" />\n            <path fill="currentColor" d="M6 8a6 6 0 1 1 12 0h1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2zm6-4a4 4 0 0 1 4 4H8a4 4 0 0 1 4-4m2 10a2 2 0 0 1-1 1.732V17a1 1 0 1 1-2 0v-1.268A2 2 0 0 1 12 12a2 2 0 0 1 2 2" />\n        </g>\n    </svg>\n    '),r='\n      <div id="drm-loader" class="drm-loader">\n        <div id="drm-loader-content" class="drm-loader-content">\n          <div class="drm-loader-icon">'.concat(i,'</div>\n          <div class="drm-loader-text">').concat(lu[au].drmPreload,'</div>\n          <div class="drm-loader-bar">\n            <div class="drm-loader-progress" style="width: 0%;"></div>\n          </div>\n        </div>\n      </div>\n    '),s="\n    .drm-loader {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(63, 85, 238, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      \n      .drm-loader-content {\n        display: flex;\n        flex-direction: column;\n        text-align: center;\n        align-items: center;\n        color: #fff;\n      }\n      \n      .drm-loader-icon {\n        opacity: 1;\n      }\n      \n      .drm-loader-text {\n        margin-top: 20px;\n        font-size: ".concat(n,"px;\n        font-weight: 400;\n        color: #ffffff;\n        line-height: 14.22px;\n        font-family: 'Rubik', sans-serif;\n      }\n      \n      .drm-loader-bar {\n        width: 50%;\n        height: 12px;\n        background: #fff;\n        margin-top: 20px;\n        position: relative;\n        overflow: hidden;\n        border-radius: 8px;\n        border: 1px solid #FFFFFF;\n        display: grid;\n        justify-self: center;\n      }\n\n      .drm-loader-progress {\n        background-color: #007bff; /* Cor de preenchimento da barra */\n        height: 100%;\n        width: 0%; /* Largura inicial */\n        border-radius: 8px;\n        transition: width 0.5s ease-out;\n      }\n    ");document.body.insertAdjacentHTML("beforeend",r);var a=document.createElement("link");a.href="https://fonts.googleapis.com/css2?family=Rubik:wght@300..900&display=swap",a.rel="stylesheet",document.head.appendChild(a);var o=document.createElement("style");o.type="text/css",o.innerText=s,document.head.appendChild(o),Dh()}function Ih(){document.getElementById("drm-loader")&&!Kd&&(document.getElementById("drm-loader").style.display="flex",_h(!1),Kd=!0)}function Dh(){document.getElementById("drm-loader")&&(document.getElementById("drm-loader").style.display="none"),Ph(0)}function Ph(e){document.querySelector(".drm-loader-progress").style.width=e+"%"}var Mh=0;function Oh(){var e=document.querySelector("video"),t=null,n=e.getElementsByTagName("source")[0].src;function i(n){if(n){var i=0;gd||(i=n.includes(720)?720:Math.min.apply(Math,Wc(n)),n.shift()),fu.quality={default:i,options:n,forced:!0,onChange:function(e){bh(e)}}}else fu.quality={default:480,options:[360,480,720],forced:!0,onChange:function(e){bh(e)}};pandatag("setupPlayer",(function(n){var i;player_configs.disableSeeking?n.listeners={seek:function(e){return e.preventDefault(),!1}}:_d&&!Gd&&(n.listeners={seek:function(e){return Yd=!0,window.player.pause(),_h(!0),!0}}),t=new(Rs())(e,n),(!player_configs.controls.includes("fullscreen")||player_configs.iosFakeFullscreen&&Gd)&&t.eventListeners.forEach((function(e){"dblclick"===e.type&&e.element.removeEventListener(e.type,e.callback,e.options)})),"online"!==fd.status&&"active"!==fd.status||((i=document.createElement("button")).setAttribute("class","panda-live-chat plyr__control plyr__controls__item"),i.setAttribute("type","button"),i.addEventListener("click",(function(){var e=window.innerWidth<830?2:1,t=document.querySelector(".live-chat-container");if(t)t.classList.contains("disabled")?(t.classList.remove("disabled"),eh("remove"),Ju(e),th("hide")):(t.style.height="0px",t.classList.add("disabled"),th("show"));else{var n=document.createElement("div");n.classList.add("live-chat-container"),n.innerHTML=bu(),document.body.appendChild(n),Ju(e),th("hide")}})),i.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 18V21.766L6.515 20.857L11.277 18H16C17.103 18 18 17.103 18 16V8C18 6.897 17.103 6 16 6H4C2.897 6 2 6.897 2 8V16C2 17.103 2.897 18 4 18H5ZM4 8H16V16H10.723L7 18.234V16H4V8Z" fill="white"/><path d="M20 2H8C6.897 2 6 2.897 6 4H18C19.103 4 20 4.897 20 6V14C21.103 14 22 13.103 22 12V4C22 2.897 21.103 2 20 2Z" fill="white"/></svg>',Ru(i,1),window.addEventListener("message",(function(e){var t=e.data;if("panda_newLiveChatMessage"===t||"panda_closeLiveChat"===t){var n=document.querySelector(".live-chat-container");"panda_newLiveChatMessage"===t?n.classList.contains("disabled")&&eh("add"):"panda_closeLiveChat"===t&&(n.style.height="0px",n.classList.add("disabled"),th("show"))}}))),$h(document.getElementsByClassName("loading-icon")[0],"disabled"),window.player=t,function(){try{var n=document.getElementsByTagName("video")[0];n.addEventListener("webkitbeginfullscreen",(function(){$h(document.querySelector("div.plyr"),"fullscreen")}),!1),n.addEventListener("webkitendfullscreen",(function(){Gh(document.querySelector("div.plyr"),"fullscreen")}),!1)}catch(e){}var i=["progress","ready","play","pause","timeupdate","seeking","seeked","ended","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","canplay","error"],r={};i.forEach((function(e){t.on(e,(function(){var n=(new Date).getTime();(!r[e]||n-r[e]>30)&&(r[e]=n,window.parent.postMessage({message:"panda_"+e,video:Sd,currentTime:t.currentTime,isMutedIndicator:!(!player_configs.mutedIndicatorIcon||nu)},"*"))}))})),Ad&&window.parent.postMessage({message:"panda_ready_comparison",video:Ad,video_external_id:Sd},"*");var s=0;_d&&!Gd&&(Ih(),setInterval((function(){window.hls.mainForwardBufferInfo&&window.hls.mainForwardBufferInfo.len!==s&&(s=window.hls.mainForwardBufferInfo.len);var e=t.duration-t.currentTime,n=3;if(Td){var i=Math.floor(Td/10);(n=i>n?i:n)>8&&(n=8);var r=e<4*n&&t.duration>0;!function(e,t){if(e>=20||t)return clearInterval(Vd),Vd=null,Ph(100),void setTimeout(Dh,200);Ih(),Ph(Math.floor(e)/20*100)}(s,r)}(s>20||e<4*n&&t.duration>0)&&Yd&&(nu&&t.play(),Yd=!1,_h(!1))}),500)),_d&&!Gd&&t.on("play",(function(){Yd&&(t.pause(),_h(!0))})),t.on("languagechange",(function(){var e,n,i=null===(e=t)||void 0===e||null===(n=e.captions)||void 0===n?void 0:n.language;if(i)if(Ls.isSupported()){var r=window.hls.subtitleTracks.find((function(e){return e.lang===i}));r&&(window.hls.subtitleTrack=r.id)}else for(var s=document.getElementsByTagName("video")[0],a=0;a<s.textTracks.length;a++)s.textTracks[a].language===i?s.textTracks[a].mode="showing":s.textTracks[a].mode="hidden"})),(player_configs.playOpensFullscreen||player_configs.playOpensFullscreenNative)&&(t.on("play",(function(){player_configs.mutedIndicatorIcon&&!nu||(player_configs.playOpensFullscreenNative?t.fullscreen.enter():window.parent.postMessage({message:"panda_open_window_fullscreen",video:Sd},"*"))})),t.on("pause",(function(){player_configs.playOpensFullscreenNative?t.fullscreen.exit():window.parent.postMessage({message:"panda_close_window_fullscreen",video:Sd},"*")}))),player_configs.disablePause&&t.on("pause",(function(){t.duration!==t.currentTime&&t.play().catch((function(){}))}));var a=t.speed,o=t.config.speed.turbo;function l(e){t.currentTime=e}function c(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).reload,n=void 0!==e&&e;if(!player_configs.mutedIndicatorIcon||nu){var i=parseInt(t.currentTime.toFixed(0)),r=player_configs.ctas.find((function(e){var t=document.getElementById(e.id);if(t){if(!n)return!1;t.remove()}return e.time<=i&&e.time+e.duration>=i&&"video"===e.type}));if(r){var s,a,o=document.getElementsByClassName("plyr--html5")[0],l=(document.getElementsByClassName("plyr__controls"),document.createElement("div"));l.onmouseenter=function(){var e=document.getElementsByClassName("plyr--hide-controls");e&&e[0]&&Gh(e[0],"plyr--hide-controls")},l.id=r.id,$h(l,"cta-overlay"),$h(l,"cta-element");var c=document.createElement("iframe");if(null!=r&&null!==(s=r.metadata)&&void 0!==s&&s.isMiniTrigger&&(l.style.opacity=0,l.style.transition="opacity ".concat(r.metadata.fadeConfigs.fadeInMs,"ms")),null!=r&&null!==(a=r.metadata)&&void 0!==a&&a.selectedButtonSize&&(l.style.zIndex=3,md&&r.metadata.link&&!r.metadata.wereQueryParamsMerged)){var d=jc(r.metadata.link,md);r.script=r.script.replace(d.targetContent,d.newContent),r.metadata.wereQueryParamsMerged=!0}if(r.height&&r.width){var u=function(){var e=window.innerWidth,t=window.innerHeight,n={topLeft:function(){c.style.top="30px",c.style.left="30px"},topCenter:function(){var t=parseInt(c.style.width.replace("px",""),10);c.style.top="30px",c.style.left=e/2-t/2+"px"},topRight:function(){c.style.top="30px",c.style.right="30px"},midLeft:function(){var e=parseInt(c.style.height.replace("px",""),10);c.style.top=t/2-e/2+"px",c.style.left="30px"},midCenter:function(){var n=parseInt(c.style.height.replace("px",""),10),i=parseInt(c.style.width.replace("px",""),10);c.style.top=t/2-n/2+"px",c.style.left=e/2-i/2+"px"},midRight:function(){var e=parseInt(c.style.height.replace("px",""),10);c.style.top=t/2-e/2+"px",c.style.right="30px"},bottomLeft:function(){c.style.bottom="70px",c.style.left="30px"},bottomCenter:function(){c.style.bottom="70px";var t=parseInt(c.style.width.replace("px",""),10);c.style.left=e/2-t/2+"px"},bottomRight:function(){c.style.bottom="70px",c.style.right="30px"}};e>=450&&(c.style.height=r.height.large+"px",c.style.width=r.width.large+"px"),e<450&&e>300&&(c.style.height=r.height.medium+"px",c.style.width=r.width.medium+"px"),e<=300&&(c.style.height=r.height.small+"px",c.style.width=r.width.small+"px"),r.position&&n[r.position]()};c.style.position="absolute",c.style.zIndex=999,u(),window.onresize=u}if(c.id="".concat(r.id,"_iframe"),c.onload=function(){ku(c.contentWindow.document.body);var e=document.getElementById("".concat(r.id,"_iframe")),t=/<script>(.|\n)*?<\/script>/gm,n=r.script.match(t),i=r.script.replace(t,"");if(n&&n.length){var s=n[0].replace("<script>","").replace("<\/script>",""),a=document.createElement("script");a.type="text/javascript",a.innerHTML=s,e.contentWindow.document.body.innerHTML="".concat(i),e.contentWindow.document.body.appendChild(a)}else e.contentWindow.document.body.innerHTML="".concat(i);e.contentWindow.document.body.style="padding:0;margin:0"},l.appendChild(c),r.skipButton){var h=document.createElement("button");h.innerHTML="Continuar assistindo",$h(h,"cta-skip-button"),h.onclick=function(){window.postMessage({type:"play"},"*")},l.appendChild(h)}o.appendChild(l),l.style.opacity=1}var p=player_configs.ctas.find((function(e){return!!document.getElementById(e.id)&&(e.time+e.duration<i||e.time>i)}));if(p){var f,m=document.getElementById(p.id);m&&(null!=p&&null!==(f=p.metadata)&&void 0!==f&&f.isMiniTrigger?(m.style.transition="opacity ".concat(p.metadata.fadeConfigs.fadeOutMs,"ms"),m.style.opacity=0,setTimeout((function(){m.remove()}),p.metadata.fadeConfigs.fadeOutMs)):m.remove())}}}function d(){"http"===player_configs.endThumbnail.substr(0,4)&&(player_configs.ctas=player_configs.ctas.filter((function(e){return"end"!==e.type})),player_configs.ctas.push({type:"end",id:"endThumb",script:"<img src='".concat(player_configs.endThumbnail,"' style='object-fit:cover; width:100%; height:100%;'><script>document.querySelector('img').onclick=function() { window.parent.postMessage({type: 'cta_play',}, '*') }</scr")+"ipt>"})),"http"===player_configs.pauseThumbnail.substr(0,4)&&(player_configs.ctas||(player_configs.ctas=[]),player_configs.ctas=player_configs.ctas.filter((function(e){return"pause"!==e.type})),player_configs.ctas.push({type:"pause",id:"pauseThumb",script:"<img src='".concat(player_configs.pauseThumbnail,"' style='object-fit:cover; width:100%; height:100%;'><script>document.querySelector('img').onclick=function() { window.parent.postMessage({type: 'cta_play',}, '*') }</scri")+"pt>"})),player_configs.ctas&&player_configs.ctas.length>0&&(t.on("play",(function(){var e=document.getElementById("end-cta");e&&$h(e,"disabled");var t,n=nd(document.getElementsByClassName("pause-cta"));try{for(n.s();!(t=n.n()).done;)$h(t.value,"disabled")}catch(e){n.e(e)}finally{n.f()}})),t.on("pause",(function(){var e=parseInt(t.currentTime,10),n=parseInt(t.duration,10);if(!t.seeking&&e!==n){var i=player_configs.ctas.find((function(t){return"pause"===t.type&&(void 0===t.startTime||void 0===t.endTime||t.startTime<e&&t.endTime>e)}));if(!i)return;var r=document.getElementById(i.id);r&&Gh(r,"disabled")}})),t.on("ended",(function(){window.onEnd&&window.onEnd()})),t.on("timeupdate",c))}function u(){var e=parseInt(t.currentTime.toFixed(0),10);if(parseInt(t.duration.toFixed(0),10)-e>30){var n=document.getElementById("live-time-indicator");n&&$h(n,"not-realtime"),p=!1}else{p=!0;var i=document.querySelector(".plyr__progress input");i&&($h(i,"hide-slyder-badge"),i.style="--value: 100%;"),Gh(document.getElementById("live-time-indicator"),"not-realtime")}if(!p){var r=document.querySelector(".plyr__progress input");r&&Gh(r,"hide-slyder-badge")}}if(setInterval((function(){t.speed!==a&&(function(e){document.querySelectorAll('[data-plyr="speed"]').forEach((function(t){t.getAttribute("value")===String(e)?t.setAttribute("aria-checked","true"):t.setAttribute("aria-checked","false")}))}(a=t.speed),t.speed!==o&&localStorage.setItem("user-plyr-speed-config",t.speed),b(),window.parent.postMessage({message:"panda_speed_update",video:Sd,speed:t.speed},"*"))}),50),t.on("timeupdate",(function(e){var n=parseInt(t.currentTime,10);n%5==Ed%5&&Ed!==n&&Nh({}),t.currentTime>0&&su.length&&(su.forEach((function(e){"currentTime"===e.type&&t.playing&&(t.currentTime=e.value)})),su=[])})),t.on("play",(function(){su.length&&(su.forEach((function(e){"currentTime"===e.type&&t.playing&&(t.currentTime=e.value)})),su=[])})),player_configs.restartAfterEnd&&(player_configs.onlyLoopMuted?t.muted&&t.on("ended",(function(){l(0),t.play().catch((function(){}))})):t.on("ended",(function(){l(0),t.play().catch((function(){}))}))),d(),player_configs.alternativeProgress&&t.on("timeupdate",(function(){var e,n=parseFloat(t.currentTime.toFixed(3),10),i=parseFloat(t.duration.toFixed(3),10),r=document.querySelector(".alternative-progress");if(player_configs.alternativeProgressDefaultVelocity){var s=n/i;e=100*Math.sqrt(1-(s-=1)*s)}else{var a=player_configs.alternativeProgress2xLimit,o=player_configs.alternativeProgressVelocity,l=a/100/o;e=n<i*l?(e=100*n/i*o).toFixed(2):a+(n-i*l)*(100-a)/(i*(1-l))}r&&e&&(r.style="--value-progress: "+e+"%;"),player_configs.alternativeProgressHeight&&r&&(r.style="--value-progress: "+e+"%;height: "+player_configs.alternativeProgressHeight+"px;")})),"boolean"==typeof player_configs.hideControlsOnStart&&player_configs.hideControlsOnStart||"string"==typeof player_configs.hideControlsOnStart&&"true"==player_configs.hideControlsOnStart.toLowerCase()){var h=document.querySelector(".plyr__controls");h&&$h(h,"disabled"),t.on("play",(function(e){var t=document.querySelector(".plyr__controls");t&&Gh(t,"disabled")}))}Rd&&"online"===Wd&&(t.on("timeupdate",u),t.on("seeking",(function(){Gh(document.querySelector(".plyr__progress input"),"hide-slyder-badge"),u()})),t.on("seeked",(function(){var e=parseInt(t.currentTime.toFixed(0),10),n=parseInt(t.duration.toFixed(0),10);n-e>10&&n-e<30&&window.postMessage({type:"currentTime",parameter:-1},"*")}))),player_configs.saveProgress&&t.on("timeupdate",(function(){var e=parseInt(t.currentTime.toFixed(0),10),n=parseInt(t.duration.toFixed(0),10);if(0!=e&&nu)if(100*e/n>90)try{localStorage.removeItem("panda_video:"+Sd)}catch(e){}else try{localStorage.setItem("panda_video:"+Sd,e)}catch(e){}}));var p=!0,f=0,m=[],g=[];function y(n){if(player_configs.saveProgressScreen){var i=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');player_configs.autoplay?(t.muted=!0,t.play()):(t.pause(),$h(i,"disabled")),e.style.visibility="hidden";var r=document.querySelector(".container"),s=document.createElement("div");$h(s,"panda-resume-screen-wrapper"),s.style="opacity: "+player_configs.saveProgressBackgroundOpacity+";";var a=document.createElement("p");a.innerText=player_configs.saveProgressTitle;var o=document.createElement("div");$h(o,"panda-resume-screen-buttons");var l=document.createElement("button");l.innerHTML='<svg viewBox="0 0 24 24">\n                                  <path fill="var(--plyr-video-control-color)" d="M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M10,16.5L16,12L10,7.5V16.5Z" />\n                              </svg><span>'+player_configs.saveProgressButton1Title+"</span>",l.onclick=function(){Bd?(t.currentTime=n-1,d()):(window.onLoadVideoWithoutPreload||(window.onLoadVideoWithoutPreload=[]),window.onLoadVideoWithoutPreload.push((function(){t.currentTime=n,d()})),window.onLoadVideoWithoutPreload.forEach((function(e){return e()}))),Fh({})};var c=document.createElement("button");c.innerHTML='<svg viewBox="0 0 24 24">\n                                  <path fill="var(--plyr-video-control-color)" d="M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.6L7,5.6L12,0.6V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z" />\n                              </svg><span>'+player_configs.saveProgressButton2Title+"<span>",c.onclick=function(){t.currentTime=0,d()},o.appendChild(l),o.appendChild(c),s.appendChild(a),s.appendChild(o),r.appendChild(s)}function d(){var n;setTimeout((function(){try{try{t.play().catch((function(){})),nu=!0}catch(e){}}catch(e){}}),0),Gh(i,"disabled"),(n=document.getElementById("wrapper-progress"))&&Gh(n,"disabled"),$h(s,"disabled"),e.style.visibility="visible",t.volume=1,Fh({})}}t.on("timeupdate",(function(){var e=parseInt(t.currentTime.toFixed(0),10),n=parseInt(t.duration.toFixed(0),10);if("online"===Wd&&Xd&&!p&&window.pb.updateLengthForLiveStream(n),0!==e&&!1===t.muted){var i=parseInt(100*e/n,10);if(!m.includes(i)){var r,s=player_configs.customPixels.filter((function(e){return"percentage"===e.conditionType&&e.conditionValue===i})),a=nd(s);try{for(a.s();!(r=a.n()).done;){var o=r.value,l=new Function(o.script);try{l()}catch(e){}}}catch(e){a.e(e)}finally{a.f()}m.push(i)}if(!g.includes(e)){var c,d=player_configs.customPixels.filter((function(t){return"absolute"===t.conditionType&&t.conditionValue===e})),u=nd(d);try{for(u.s();!(c=u.n()).done;){var h=c.value,y=new Function(h.script);try{y()}catch(e){}}}catch(e){u.e(e)}finally{u.f()}g.push(e)}if(i%10!=0||i===f)return;if(f=i,player_configs.fbPixel.length>0)try{nu&&fbq("track","pandavideo_watchtime",{percent:i,video_id:Sd,library_id:"b-"+kd,duration:n,current_time:e})}catch(e){}if(player_configs.gtagIds.length>0)try{nu&&gtag("event","pandavideo_watchtime",{percent:i,video_id:Sd,library_id:"b-"+kd,duration:n,current_time:e})}catch(e){}}})),t.once("play",(function(e){if(!player_configs.autoplay){try{player_configs.controls.includes("volume")||(t.volume=1),Fh({})}catch(e){}nu=!0}var n=document.querySelector('button[data-plyr="play"].plyr__control--overlaid');if(n&&Gh(n,"disabled"),$h(document.getElementsByClassName("loading-icon")[0],"disabled"),$h(document.querySelector("div.plyr__poster"),"disabled"),player_configs.initSubtitle){var i=document.querySelector(".plyr__controls");i&&Gh(i,"disabled")}Bd||Id||wh()})),t.once("canplay",(function(){var n,i=document.querySelector(".plyr__poster");i&&Gh(i,"thumbnail-blur"),Gd&&vh(),function(){var e=null;try{e=localStorage.getItem("panda_video_audio_lang")}catch(e){}if(e){var t,n=nd(mh());try{var i=function(){var n=t.value;if(n.lang===e)return setTimeout((function(){yh(n.id)}),100),"break"};for(n.s();!(t=n.n()).done&&"break"!==i(););}catch(e){n.e(e)}finally{n.f()}}}();try{n=localStorage.getItem("panda_video:"+Sd)}catch(e){}var r=player_configs.default_speed,s=localStorage.getItem("user-plyr-speed-config");t.speed=s||r||player_configs.defaultSpeed,n&&player_configs.saveProgressScreen||!player_configs.autoplay||nu?(t.volume<.5||t.muted)&&(t.muted=!1,t.volume=1):player_configs.smartAutoplay?(t.muted=!1,t.volume=1,t.play().then((function(){Du(),Iu()})).catch((function(e){"NotAllowedError"===e.name&&(t.muted=!0,t.play())})),e.autoplay=""):(t.muted=!0,t.play()),player_configs.saveProgressScreen&&n&&player_configs.autoplay?(t.muted=!0,t.play()):player_configs.saveProgressScreen&&n&&!player_configs.autoplay?t.pause():n&&player_configs.saveProgress&&l(parseInt(n)),cd.searchParams.get("startTime")&&l(parseInt(cd.searchParams.get("startTime"),10)),Bd||window.onLoadVideoWithoutPreload&&window.onLoadVideoWithoutPreload.forEach((function(e){return e()}))})),t.on("ready",(function(n){if(function(){!function(){try{var e=document.getElementById("copy-paste");e&&e.remove()}catch(e){}}();try{var e=document.createElement("div");e.id="report-problem-dialog",e.innerHTML='<div id="copy-paste" class="disabled"><header> <p class="report-problem-text">'.concat(lu[au].reportModalTitle,'</p></header> <div id="report-first-step"> <section id="radio-section"> <div> <input type="radio" id="report-not-loading" name="issue-reported" value="report-not-loading" checked> <label for="report-not-loading">').concat(lu[au].reportModalOption1,'</label><br></div><div> <input type="radio" id="report-unmatch-description" name="issue-reported" value="report-unmatch-description"> <label for="report-unmatch-description">').concat(lu[au].reportModalOption2,'</label> </div><div> <input type="radio" id="report-low-quality" name="issue-reported" value="report-low-quality"> <label for="report-low-quality">').concat(lu[au].reportModalOption3,'</label> </div><div> <input type="radio" id="report-other" name="issue-reported" value="report-other"> <label for="report-other">').concat(lu[au].reportModalOption4,'</label><br></div><div class="report-textfield-card"> <div id="other-input-wrapper" class="disabled"> <input class="other-input" type="text" id="other-input" name="other" placeholder="').concat(lu[au].reportModalField,'"> </div></div></section> <footer> <button id="report-second-step-btn" class="report-problem-dialog-button">').concat(lu[au].reportModalAction1,'</button> <button id="report-close-dialog-btn" class="report-problem-dialog-button">').concat(lu[au].reportModalAction2,'</button> </footer> </div><div id="report-second-step" class="disabled"> <div id="loading-div"> <svg viewBox="0 0 100 100" enable-background="new 0 0 0 0" xml:space="preserve"> <path fill="#4874F1" d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="360 50 50" repeatCount="indefinite"/> </path> </svg> </div><p id="second-step-text">').concat(lu[au].reportModalText1," <br/> ").concat(lu[au].reportModalText2,'</p></div><div id="report-third-step" class="disabled ').concat(xd?"":"alone",'"> <header> ').concat(xd?'<img id="panda-last-step-img" src="./icons/pandacheck.svg"/>':"",' </header> <p class="report-problem-text">').concat(lu[au].reportModalText3,'</p><footer> <button id="report-ok-btn" class="report-problem-dialog-button">OK</button> </footer> </div></div>'),document.getElementById("video-container").insertAdjacentElement("afterbegin",e)}catch(e){}!function(){try{var e=document.getElementsByClassName("plyr__control plyr__control--forward")[0].parentElement,t=document.createElement("button"),n=window.getComputedStyle(document.body,null).getPropertyValue("--plyr-color-main");t.textContent=lu[au].reportModalTitle,t.classList.add("customSettingsBtn"),t.id="custom-plyr-btn",t.setAttribute("data-plyr","settings"),t.setAttribute("type","button"),t.setAttribute("role","menuitem"),t.setAttribute("aria-haspopup","true"),e.appendChild(t),document.getElementById("custom-plyr-btn").addEventListener("click",(function(){_u(),document.getElementsByClassName("plyr__controls__item plyr__menu")[0].click()})),t.onmouseover=function(){t.style.backgroundColor=n},t.onmouseleave=function(){t.style.removeProperty("background-color")};var i=document.querySelector(".plyr__menu button");i&&(i.onclick=function(){var e=document.getElementsByClassName("plyr__controls")[0];if(e){"true"===i.getAttribute("aria-expanded")?$h(e,"plyr-controls-fix-index"):Gh(e,"plyr-controls-fix-index");var t=document.getElementById("context-menu-ai");t&&t.classList.contains("active")&&t.classList.remove("active")}})}catch(e){}}()}(),t.media.load(),player_configs.ctas.length>0&&c(),player_configs.saveProgress){var i;try{i=localStorage.getItem("panda_video:"+Sd)}catch(e){}player_configs.saveProgressScreen&&i?"online"!==Wd&&y(parseInt(i,10)):player_configs.mutedIndicatorIcon&&Nu()}var r,s,a;player_configs.captionsFontSize&&(r=Number(player_configs.captionsFontSize),s="\n        .plyr__captions {\n            font-size: ".concat(r,"px;\n        }\n\n        @media (min-width: 480px) {\n            .plyr__captions {\n                font-size: ").concat(r>34?r-8:r,"px;\n            }\n        }\n\n        @media (max-width: 480px) {\n            .plyr__captions {\n                font-size: ").concat(r>=26?r-12:r,"px;\n            }\n        }\n\n        @media (max-width: 460px) {\n            .plyr__captions {\n                font-size: 14px;\n            }\n        }\n\n        @media (min-width: 768px) {\n            .plyr__captions {\n                font-size: ").concat(r+3,"px;\n            }\n        }\n\n        @media (min-width: 1024px) {\n            .plyr:-webkit-full-screen .plyr__captions, .plyr:fullscreen .plyr__captions, .plyr__captions {\n                font-size: ").concat(r+6,"px;\n            }\n        }\n    "),(a=document.createElement("style")).innerText=s,document.head.appendChild(a)),e.style.visibility="visible",Bd&&gd&&Eh({abrEwmaDefaultEstimate:5e6,maxBufferLength:20,autoStartLoad:!0,fragLoadingMaxRetry:9999,fragLoadingTimeOut:15e3}),Rd&&"online"===Wd&&setInterval(Sh,15e3)}));var v=!1;function b(){var e;try{e=localStorage.getItem("panda_video:"+Sd)}catch(e){}var n=t.currentTime;e&&0===n&&(n=parseFloat(e));var i=Qd.style.getPropertyValue("--plyr-color-main"),r=Qd.style.getPropertyValue("--plyr-captions-text-color"),s=Qd.style.getPropertyValue("--plyr-captions-background"),a=Qd.style.getPropertyValue("--plyr-video-control-color"),o=Qd.style.getPropertyValue("--plyr-menu-color"),l=v?t.duration:0,c={paused:t.paused,hasAudio:t.hasAudio,muted:t.muted,pip:t.pip,volume:t.volume,speed:t.config.speed,captions:t.captions,currentTime:n,duration:l,fullscreen:t.fullscreen.active,colors:{primaryColor:i,captionsColor:r,captionsBackgroundColor:s,controlsColor:a,menuColor:o}};window.parent.postMessage({message:"panda_allData",video:cd.searchParams.get("v"),playerData:JSON.parse(JSON.stringify(c))},"*")}t.on("loadedmetadata",(function(e){v=!0})),i.forEach((function(e){t.on(e,b)})),window.onmessage=function(e){var n=e.data,i=document.querySelector(":root");if("setParentWindowUrl"===n.type&&(md=n.parameter,c({reload:!0})),"currentTime"!==n.type){if("muted_indicator_play"===n.type&&Du(),"cta_play"===n.type&&t.play().catch((function(){})),"volume"===n.type)return t.volume=n.parameter,void(!nu&&n.parameter>0&&Fh({}));if("speed"!==n.type)if("play_toggle"!==n.type){if("colors"===n.type){var r=n.parameter.colors;return r.primaryColor&&i.style.setProperty("--plyr-color-main",r.primaryColor),r.captionsColor&&i.style.setProperty("--plyr-captions-text-color",r.captionsColor),r.captionsBackgroundColor&&i.style.setProperty("--plyr-captions-background",r.captionsBackgroundColor),r.controlsColor&&(i.style.setProperty("--plyr-video-control-color",r.controlsColor),i.style.setProperty("--plyr-video-control-color-hover",r.controlsColor)),r.menuColor&&i.style.setProperty("--plyr-menu-color",r.menuColor),r.mutedIndicatorBackgroundColor&&i.style.setProperty("--muted-indicator-background",r.mutedIndicatorBackgroundColor),void(r.mutedIndicatorTextColor&&i.style.setProperty("--muted-indicator-text",r.mutedIndicatorTextColor))}if("ctas"===n.type){var s=n.parameter.ctas;return Uu(),0===player_configs.ctas.length?(player_configs.ctas=s,$u(),Gu(),d()):(player_configs.ctas=s,Gu(),$u()),void c()}if("remove_cta"===n.type){var a=n.parameter,o=document.getElementById(a);player_configs.ctas=player_configs.ctas.filter((function(e){return e.id!==a})),o&&o.remove()}if("custom_muted_indicator"===n.type&&(player_configs.customMutedIndicatorData=n.parameter,player_configs.mutedIndicatorAnimation="custom",Ou()),"disable_control"===n.type){var u=n.parameter;("play"===u?document.querySelector('[data-plyr="play"]:not(.plyr__control--overlaid'):"play-large"===u?document.querySelector('[data-plyr="play"].plyr__control--overlaid'):document.querySelector('[data-plyr="'.concat(u,'"]'))).style.display="none"}if("enable_control"===n.type){var h=n.parameter;"play"===h?document.querySelector('[data-plyr="play"]:not(.plyr__control--overlaid').style.display="":"play-large"===h?document.querySelector('[data-plyr="play"].plyr__control--overlaid').style.display="flex":document.querySelector('[data-plyr="'.concat(h,'"]')).style.display=""}if("enable_all_controls"===n.type){var p=document.querySelector('[data-plyr="play"].plyr__control--overlaid');p&&(p.style.display="flex");var f=document.querySelector(".plyr__controls");f&&Gh(f,"disabled");var m=document.getElementById("wrapper-progress");m&&Gh(m,"disabled")}if("disable_all_controls"===n.type){var g=document.querySelector('[data-plyr="play"].plyr__control--overlaid');g&&(g.style.display="none");var y=document.querySelector(".plyr__controls");y&&$h(y,"disabled")}if("bookMarks"===n.type){var v=n.parameter.bookMarks;return player_configs.bookMarks=v,void zu()}"fullscreen.toggle"!==n.type?"fullscreen.exit"!==n.type?null!=n.parameter?t[n.type]&&t[n.type](n.parameter):t[n.type]&&t[n.type]():t.fullscreen.exit():t.fullscreen.toggle()}else t.paused?t.play().catch((function(){})):t.pause();else t.speed=n.parameter}else-1===n.parameter?l(t.duration-2):l(n.parameter)}}()})),pandatag("playerLoaded",!0)}(function(e){return Ah.apply(this,arguments)})(n).then((function(e){if(e){var t=Math.ceil(e.duration/2);e.block_download&&gd&&(wd=!0,document.querySelector("video").getElementsByTagName("source")[0].src+=n.includes("?")?"&":"?token="+Lh());for(var r=[],s=0;s<t;s+=36)r.push("https://b-"+kd+".tv.pandavideo.com.br/"+Sd+"/seek/_"+r.length+".jpg");window.player_configs.showPreviewThumbs&&!Rd&&(fu.thumbnail={enabled:!0,pic_num:t,width:300,height:168,col:6,row:6,offsetX:0,offsetY:0,urls:r}),e.m3u8Qualities.length>1?i([0].concat(Wc(e.m3u8Qualities.sort((function(e,t){return t-e}))))):i(e.m3u8Qualities)}})).catch((function(e){console.error("Error:",e),++Mh<=3?setTimeout((function(){Oh()}),100):i()}))}function Nh(e){var t=e.force,n=e.time,i=parseInt(player.currentTime,10);void 0!==n&&(i=n),(t||!player.muted&&nu&&!player.paused&&!Md&&"online"!==Wd)&&(navigator.sendBeacon(iu+"/icon.gif?type=check&v="+Sd+"&u="+vu+"&p="+kd+"&current_time="+i+"&referrer="+encodeURIComponent(document.referrer)+"&visibily="+!document[sd]),Ed=i)}function Fh(e){var t=e.mutedIndicator;if(!Md&&!Dd){try{navigator.sendBeacon(iu+"/icon.gif?type=play&v="+Sd+"&u="+vu+"&p="+kd+"&referrer="+encodeURIComponent(document.referrer)+"&visibily="+!document[sd])}catch(e){}try{gtag("event","play",{video_id:Sd,library_id:"b-"+kd})}catch(e){}try{fbq("track","play",{video_id:Sd,library_id:"b-"+kd})}catch(e){}var n,i=player_configs.customPixels.filter((function(e){return"play"===e.conditionType})),r=nd(i);try{for(r.s();!(n=r.n()).done;){var s=n.value,a=new Function(s.script);try{a()}catch(e){}}}catch(e){r.e(e)}finally{r.f()}Nh({force:!0,time:t?0:void 0}),Dd=!0}}function Bh(){var e=document.getElementById("body"),t=document.getElementById("video-container"),n=t.offsetHeight,i=e.offsetHeight;t.style.marginTop=(i-n)/2+"px";var r=document.querySelector(".live-chat-container");r&&!r.classList.contains("disabled")&&(window.innerWidth<830?th("hide"):(th("show"),Ju()))}function Uh(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function $h(e,t){e&&(Uh(e,t)||(e.className+=" "+t))}function Gh(e,t){if(e&&Uh(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}Bh(),window.addEventListener("resize",Bh),document.onkeydown=function(e){27==(e=e||window.event).keyCode&&(player_configs.playOpensFullscreen?window.parent.postMessage({message:"panda_close_window_fullscreen",video:Sd},"*"):player_configs.playOpensFullscreenNative&&window.postMessage({type:"fullscreen.exit"},"*"))}})()})();</script></body>